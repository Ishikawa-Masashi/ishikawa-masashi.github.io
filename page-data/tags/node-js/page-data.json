{"componentChunkName":"component---src-templates-tags-template-tsx","path":"/tags/node-js/","result":{"pageContext":{"nodes":[{"html":"<h2 id=\"ãªã«ã“ã‚Œ\" style=\"position:relative;\"><a href=\"#%E3%81%AA%E3%81%AB%E3%81%93%E3%82%8C\" aria-label=\"ãªã«ã“ã‚Œ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ãªã«ã“ã‚Œ</h2>\n<p>Gatsbyè£½ã®ã‚µã‚¤ãƒˆã§Connpassã®ã‚¤ãƒ™ãƒ³ãƒˆã‚’è¡¨ç¤ºã—ãªã‘ã‚Œã°ãªã‚‰ãšã€<a href=\"https://connpass.com/about/api/\">Conpass API</a>ã‚’ä½¿ã£ãŸã®ã§ã™ãŒã€ã“ã¡ã‚‰ã®APIã§ã¯ã‚µãƒ ãƒã‚¤ãƒ«ç”»åƒãŒå–å¾—ã§ãã¾ã›ã‚“ã€‚ãã®ãŸã‚ã‚µãƒ ãƒã‚¤ãƒ«ã¯ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ã§å–å¾—ã™ã‚‹ã‚ˆã†ã«ã—ã¾ã—ãŸã€‚å–å¾—è‡ªä½“ã¯å˜ç´”ãªNode.jsã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆãªã®ã§å‰²ã¨ä½¿ã„ã¾ã‚ã—ãŒåŠ¹ãã¨æ€ã„ã¾ã™ã€‚ä»Šå›ã¯ãã®å‚™å¿˜éŒ²ã§ã™ã€‚ã¤ã„ã§ã«Gatsbyã®ãƒ­ãƒ¼ã‚«ãƒ«ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã«ã™ã‚‹æ–¹æ³•ã‚‚ã”ç´¹ä»‹ã—ã¾ã™ã€‚</p>\n<h2 id=\"connpass-apiæ‰€æ„Ÿ\" style=\"position:relative;\"><a href=\"#connpass-api%E6%89%80%E6%84%9F\" aria-label=\"connpass apiæ‰€æ„Ÿ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Connpass APIæ‰€æ„Ÿ</h2>\n<p>å°‘ã—ã ã‘ä½¿ã„ã¥ã‚‰ã„ã§ã™ã€‚<br/>\nä»Šå›ã€ã‚°ãƒ«ãƒ¼ãƒ—ã«ç´ã¥ãã‚¤ãƒ™ãƒ³ãƒˆã‚’å–å¾—ã—ãŸã‹ã£ãŸã®ã§<code class=\"language-text\">series_id</code>ã‚’æŒ‡å®šã—ã¾ã—ãŸãŒã€Connpassã®ã‚°ãƒ«ãƒ¼ãƒ—ã®ç”»é¢ã‹ã‚‰ã¯<code class=\"language-text\">series_id</code>ãŒã‚ã‹ã‚‰ãšã€ã‚°ãƒ«ãƒ¼ãƒ—ã«ç´ã¥ãã‚¤ãƒ™ãƒ³ãƒˆã‚’Connpass APIã§å©ã„ã¦ã€ãã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®<code class=\"language-text\">series_id</code>ã‚’ç¢ºèªã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã—ãŸã€‚<br/>\næ—¥ä»˜ã®ç¯„å›²æŒ‡å®šãŒç‹¬ç‰¹ã§ã€From Toã§ã¯ãªãã€å¹´æœˆã¾ãŸã¯å¹´æœˆæ—¥ã‚’æ•´æ•°ã§è¤‡æ•°æŒ‡å®šã—ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚\n2020å¹´1æœˆã‹ã‚‰3æœˆã¾ã§ã®ã‚¤ãƒ™ãƒ³ãƒˆã‚’å–å¾—ã™ã‚‹å ´åˆã¯<code class=\"language-text\">ym=202001, 202001, 202003</code>ã®ã‚ˆã†ãªæ„Ÿã˜ã§ã™ã€‚<br/>\nãªãŠå–å¾—ä»¶æ•°ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯10ä»¶ãªã®ã§ã€ãŸãã•ã‚“ã‚¤ãƒ™ãƒ³ãƒˆã‚’å–å¾—ã™ã‚‹å ´åˆã¯100ä»¶ã‚’æŒ‡å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</p>\n<p>ãã—ã¦ã‚µãƒ ãƒã‚¤ãƒ«ç”»åƒã®æƒ…å ±ãŒãƒ¬ã‚¹ãƒãƒ³ã‚¹ã§è¿”ã£ã¦ãã¾ã›ã‚“ã€‚\nè¿”ã£ã¦ãã¦ã‚‚è‰¯ã•ãã†ã§ã™ãŒã€<a href=\"https://connpass.com/about/api/\">Connpass APIã®ãƒšãƒ¼ã‚¸</a>ã§ç´¹ä»‹ã•ã‚Œã¦ã„ã‚‹APIã‚’ä½¿ã£ã¦ã„ã‚‹ã‚µãƒ¼ãƒ“ã‚¹ã‚’è¦‹ã¦ã‚‚ã€ã‚µãƒ ãƒã‚¤ãƒ«ç”»åƒã‚’è¡¨ç¤ºã—ã¦ã„ã‚‹ã‚µãƒ¼ãƒ“ã‚¹ã¯ãªã‹ã£ãŸã§ã€ãŠãã‚‰ãAPIã§ã¯å–å¾—ã§ããªã„ã®ã§ã—ã‚‡ã†ã€‚</p>\n<h2 id=\"ç¾åœ¨æœˆå‰å¾Œã®ã‚¤ãƒ™ãƒ³ãƒˆã‚’å–å¾—ã™ã‚‹ãŸã‚ã®æ¤œç´¢æ¡ä»¶\" style=\"position:relative;\"><a href=\"#%E7%8F%BE%E5%9C%A8%E6%9C%88%E5%89%8D%E5%BE%8C%E3%81%AE%E3%82%A4%E3%83%99%E3%83%B3%E3%83%88%E3%82%92%E5%8F%96%E5%BE%97%E3%81%99%E3%82%8B%E3%81%9F%E3%82%81%E3%81%AE%E6%A4%9C%E7%B4%A2%E6%9D%A1%E4%BB%B6\" aria-label=\"ç¾åœ¨æœˆå‰å¾Œã®ã‚¤ãƒ™ãƒ³ãƒˆã‚’å–å¾—ã™ã‚‹ãŸã‚ã®æ¤œç´¢æ¡ä»¶ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ç¾åœ¨æœˆå‰å¾Œã®ã‚¤ãƒ™ãƒ³ãƒˆã‚’å–å¾—ã™ã‚‹ãŸã‚ã®æ¤œç´¢æ¡ä»¶</h2>\n<p>å…ˆã«è¿°ã¹ãŸé€šã‚Šæ—¥ä»˜ã®æ¤œç´¢æ¡ä»¶ãŒç‹¬ç‰¹ã§ã€\nã“ã“ã§ã¯ã€ç¾åœ¨æœˆã‹ã‚‰éå»Xãƒ¶æœˆã€æœªæ¥Yãƒ¶æœˆã®ç¯„å›²ã‚’æŒ‡å®šã™ã‚‹æ–¹æ³•ã‚’ç¤ºã—ã¾ã™ã€‚\nå¿µã®ç‚ºã€ã©ã‚“ãªãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã‚‚æ­£ã—ãå‹•ãã‚ˆã†ã«<a href=\"https://date-fns.org/\">date-fns</a>ã¨ã„ã†æ—¥æ™‚ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã£ã¦ã„ã¾ã™ã€‚</p>\n<div class=\"gatsby-code-title\">param-of-month-range.js(Connpass</div>\n<div class=\"gatsby-highlight\" data-language=\"jsapiã®å¹´æœˆã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ç”Ÿæˆã™ã‚‹å‡¦ç†)\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-jsapiã®å¹´æœˆã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ç”Ÿæˆã™ã‚‹å‡¦ç†) line-numbers\"><code class=\"language-jsapiã®å¹´æœˆã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ç”Ÿæˆã™ã‚‹å‡¦ç†)\">// æ™‚é–“è¨ˆç®—ãªã©ã®å‡¦ç†ã¯æ—¥æœ¬ã®ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ã§è¡Œã†\nconst TIME_ZONE_FOR_CONNPASS_API = &#39;Asia/Tokyo&#39;;\nconst YEAR_MONTH_FORMAT_FOR_CONNPASS_API = &#39;YYYYMM&#39;;\nconst { startOfMonth, addMonths, format } = require(&#39;date-fns&#39;);\nconst { convertToTimeZone } = require(&#39;date-fns-timezone&#39;);\n\n// Connpass APIã®ä»•æ§˜(https://connpass.com/about/api/)ã«å¾“ã£ã¦\n// æœ€è¿‘é–‹å‚¬ã•ã‚ŒãŸ/ã•ã‚Œã‚‹ã‚¤ãƒ™ãƒ³ãƒˆã«çµã‚Šè¾¼ã‚€ãŸã‚ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã‚’ç”Ÿæˆã™ã‚‹\n// çµæœã¯ `202001,202002,202003` ã®ã‚ˆã†ãªæ–‡å­—åˆ—\nfunction paramOfMonthRange(monthRangePast, monthRangeFuture) {\n  const targetYearAndMonths = [];\n  const startOfCurrentMonth = startOfMonth(convertToTimeZone(new Date(), { timeZone: TIME_ZONE_FOR_CONNPASS_API }));\n\n  for(let i = - monthRangePast; i &lt; monthRangeFuture; i++) {\n    const target = addMonths(startOfCurrentMonth, i);\n    const targetStr = format(target, YEAR_MONTH_FORMAT_FOR_CONNPASS_API);\n    targetYearAndMonths.push(targetStr);\n  }\n\n  return targetYearAndMonths.join(&#39;,&#39;);\n}\n\n\nexports.paramOfMonthRange = paramOfMonthRange;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<br/>\n<h2 id=\"ã‚µãƒ ãƒã‚¤ãƒ«ã®ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°\" style=\"position:relative;\"><a href=\"#%E3%82%B5%E3%83%A0%E3%83%8D%E3%82%A4%E3%83%AB%E3%81%AE%E3%82%B9%E3%82%AF%E3%83%AC%E3%82%A4%E3%83%94%E3%83%B3%E3%82%B0\" aria-label=\"ã‚µãƒ ãƒã‚¤ãƒ«ã®ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚° permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ã‚µãƒ ãƒã‚¤ãƒ«ã®ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°</h2>\n<p>ã¾ãšã¯Connpass APIã§ã‚¤ãƒ™ãƒ³ãƒˆæƒ…å ±ã‚’å–å¾—ã—ã¦ã€\nå–å¾—æƒ…å ±ã®ä¸­ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒšãƒ¼ã‚¸ã®URLã‚’å…ƒã«ã€<a href=\"https://github.com/cheeriojs/cheerio\">cheerio</a>ã‚’ä½¿ã£ã¦ã‚¤ãƒ™ãƒ³ãƒˆãƒšãƒ¼ã‚¸HTMLã®headã‚¿ã‚°ã®metaæƒ…å ±ã‹ã‚‰OGPç”»åƒã®URLã‚’å–å¾—ã—ã¾ã™ã€‚\nã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ã§503ã‚¨ãƒ©ãƒ¼ã«ãªã‚‰ãªã„ã‚ˆã†Promise.allã§ä¸¦åˆ—å‡¦ç†ã§ä¸€æ°—ã«æŠ•ã’ã‚‹ã“ã¨ã¯ã›ãšã€foræ–‡ã§1ã¤ã¥ã¤é †ç•ªã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ã‚‹ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚</p>\n<div class=\"gatsby-code-title\">fetch-connpass-events-with-thumbnails.js</div>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">const</span> axios <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'axios'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> cheerio <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'cheerio'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> paramOfMonthRange <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./param-of-month-range.js'</span><span class=\"token punctuation\">)</span>\n\n\n<span class=\"token keyword\">const</span> <span class=\"token constant\">BASE_URL</span> <span class=\"token operator\">=</span> <span class=\"token string\">'https://connpass.com/api/v1/event/'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">DEFAULT_MIN_FETCH_COUNT</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">DEFAULT_MAX_FETCH_COUNT</span> <span class=\"token operator\">=</span> <span class=\"token number\">100</span><span class=\"token punctuation\">;</span>\n\n\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">fetchConnpassEventsWithThumbnails</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span>\n  eventSeriesIds<span class=\"token punctuation\">,</span>\n  defaultThumbnailUrl<span class=\"token punctuation\">,</span>\n  maxFetchCount<span class=\"token punctuation\">,</span>\n  monthRangePast<span class=\"token punctuation\">,</span>\n  monthRangeFuture<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// å¼•æ•°ãƒã‚§ãƒƒã‚¯ã¯çœç•¥</span>\n\n  <span class=\"token keyword\">const</span> eventsList <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> Promise<span class=\"token punctuation\">.</span><span class=\"token function\">all</span><span class=\"token punctuation\">(</span>eventSeriesIds<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">async</span> <span class=\"token parameter\">series_id</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> response <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> axios<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token constant\">BASE_URL</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">params</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        series_id<span class=\"token punctuation\">,</span>\n        <span class=\"token literal-property property\">ym</span><span class=\"token operator\">:</span> <span class=\"token function\">paramOfMonthRange</span><span class=\"token punctuation\">(</span>monthRangePast<span class=\"token punctuation\">,</span> monthRangeFuture<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token literal-property property\">count</span><span class=\"token operator\">:</span> maxFetchCount<span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token function\">attachThumbnailUrl</span><span class=\"token punctuation\">(</span>response<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>events<span class=\"token punctuation\">,</span> defaultThumbnailUrl<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> eventsList<span class=\"token punctuation\">.</span><span class=\"token function\">flat</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">attachThumbnailUrl</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">events<span class=\"token punctuation\">,</span> defaultThumbnailUrl</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> eventUrls <span class=\"token operator\">=</span> events<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span> <span class=\"token operator\">=></span> event<span class=\"token punctuation\">.</span>event_url<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> thumbnailUrls <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetchThumbnailUrls</span><span class=\"token punctuation\">(</span>eventUrls<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// å–å¾—ã—ãŸOGPç”»åƒã®URLã‚’ã‚¤ãƒ™ãƒ³ãƒˆæƒ…å ±ã«ãƒãƒ¼ã‚¸</span>\n  <span class=\"token keyword\">return</span> events<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span>  thumbnail_url <span class=\"token operator\">=</span> thumbnailUrls<span class=\"token punctuation\">[</span>event<span class=\"token punctuation\">.</span>event_url<span class=\"token punctuation\">]</span> <span class=\"token operator\">||</span> defaultThumbnailUrl<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> Object<span class=\"token punctuation\">.</span><span class=\"token function\">assign</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> event<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> thumbnail_url <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n\n<span class=\"token comment\">// ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ã§HTMLã®headã®metaæƒ…å ±ã‹ã‚‰OGPç”»åƒã®URLã‚’å–å¾—ã™ã‚‹</span>\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">fetchThumbnailUrls</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">eventUrls</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> result <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// 503ã‚¨ãƒ©ãƒ¼(ãƒªã‚¯ã‚¨ã‚¹ãƒˆéå¤š)ã«ãªã‚‰ãªã„ã‚ˆã†Promise.allã§ä¸¦åˆ—å‡¦ç†ã¯ã›ãšã€foræ–‡ã§ç›´åˆ—ã§å‡¦ç†ã™ã‚‹</span>\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> url <span class=\"token keyword\">of</span> eventUrls<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">data</span><span class=\"token operator\">:</span> html <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">axios</span><span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">const</span> $ <span class=\"token operator\">=</span> cheerio<span class=\"token punctuation\">.</span><span class=\"token function\">load</span><span class=\"token punctuation\">(</span>html<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">const</span> thumbnailUrl <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">'meta[property=\"og:image\"]'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'content'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>thumbnailUrl<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        result<span class=\"token punctuation\">[</span>url<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> thumbnailUrl<span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n        console<span class=\"token punctuation\">.</span><span class=\"token function\">warn</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">OGP image cloud not found in the url(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>url<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">).</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">warn</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Fetching(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>url<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">) for getting thumbnail url failed.</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> result<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\nexports<span class=\"token punctuation\">.</span>fetchConnpassEventsWithThumbnails <span class=\"token operator\">=</span> fetchConnpassEventsWithThumbnails<span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<br/>\n<h2 id=\"gatsbyãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã«ã™ã‚‹å ´åˆ\" style=\"position:relative;\"><a href=\"#gatsby%E3%83%97%E3%83%A9%E3%82%B0%E3%82%A4%E3%83%B3%E3%81%AB%E3%81%99%E3%82%8B%E5%A0%B4%E5%90%88\" aria-label=\"gatsbyãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã«ã™ã‚‹å ´åˆ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Gatsbyãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã«ã™ã‚‹å ´åˆ</h2>\n<p>Gatsbyã®ãƒ“ãƒ«ãƒ‰æ™‚ã«Connpassã®ã‚¤ãƒ™ãƒ³ãƒˆæƒ…å ±ã‚’å–å¾—ã—ã¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®GraphQLã®ã‚¯ã‚¨ãƒªã§å–å¾—ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ãŸã‚ã«ã¯ä»¥ä¸‹ã‚’å®Ÿæ–½ã—ã¾ã™ã€‚</p>\n<ul>\n<li>è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«å®šç¾©</li>\n<li>gatsby-config.jsã§ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ç™»éŒ²</li>\n<li>Gatsbyãƒ­ãƒ¼ã‚«ãƒ«ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ä½œæˆã€ã“ã®ä¸­ã§å…ˆç¨‹ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆ<code class=\"language-text\">fetch-connpass-events-with-thumbnails.js</code>ã‚’ä½¿ã†</li>\n</ul>\n<br/>\n<p>ã¾ãšã¯ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã«æ¸¡ã™å¼•æ•°ã‚’è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã§å®šç¾©ã—ã¾ã™ã€‚</p>\n<div class=\"gatsby-code-title\">config/connpass-events.js</div>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\">module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// è‡ªåˆ†ãŒå–å¾—ã—ãŸã„ã‚°ãƒ«ãƒ¼ãƒ—IDã®SeriesIDã‚’è¨˜è¼‰ã™ã‚‹</span>\n  <span class=\"token literal-property property\">eventSeriesIds</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span> <span class=\"token string\">'1234'</span><span class=\"token punctuation\">,</span>  <span class=\"token string\">'5678'</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">// ã‚µãƒ ãƒã‚¤ãƒ«ãŒãªã„ã‚’è€ƒæ…®ã—ã¦ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ã‚µãƒ ãƒã‚¤ãƒ«ç”»åƒã®URLã‚’æŒ‡å®šã™ã‚‹</span>\n  <span class=\"token literal-property property\">defaultThumbnailUrl</span><span class=\"token operator\">:</span> <span class=\"token string\">'https://hogehoge.com/default-thumbnaile-url.png'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">maxFetchCount</span><span class=\"token operator\">:</span> <span class=\"token number\">100</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">monthRangePast</span><span class=\"token operator\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">monthRangeFuture</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<br/>\n<p>æ¬¡ã«<code class=\"language-text\">gatsby-config.js</code>ã§ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ç™»éŒ²ã—ã¾ã™ã€‚ã“ã®æ™‚ã€è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®å€¤ã‚’ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¨ã—ã¦æŒ‡å®šã—ã¾ã™ã€‚</p>\n<div class=\"gatsby-code-title\">gatsby-config.js</div>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">const</span> connpassEvents <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./config/conpass-events'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token literal-property property\">plugins</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token comment\">// ä¸­ç•¥</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">resolve</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">gatsby-source-connpass</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n<span class=\"gatsby-highlight-code-line\">      <span class=\"token literal-property property\">options</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">        <span class=\"token literal-property property\">eventSeriesIds</span><span class=\"token operator\">:</span> connpassEvents<span class=\"token punctuation\">.</span>eventSeriesIds<span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\">        <span class=\"token literal-property property\">defaultThumbnailUrl</span><span class=\"token operator\">:</span> connpassEvents<span class=\"token punctuation\">.</span>defaultThumbnailUrl<span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\">        <span class=\"token literal-property property\">maxFetchCount</span><span class=\"token operator\">:</span> connpassEvents<span class=\"token punctuation\">.</span>maxFetchCount<span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\">        <span class=\"token literal-property property\">monthRangePast</span><span class=\"token operator\">:</span> connpassEvents<span class=\"token punctuation\">.</span>monthRangePast<span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\">        <span class=\"token literal-property property\">monthRangeFuture</span><span class=\"token operator\">:</span> connpassEvents<span class=\"token punctuation\">.</span>monthRangeFuture<span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></span>    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// ä¸­ç•¥</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<br/>\n<p>ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’å®šç¾©ã—ã¾ã™ã€‚ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¯<code class=\"language-text\">plugins/ãƒ—ãƒ©ã‚°ã‚¤ãƒ³å</code>ã®ãƒ•ã‚©ãƒ«ãƒ€é…ä¸‹ã«å®šç¾©ã—ã¾ã™ã€‚\nNode.jsãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãªã®ã§ã€ã“ã‚Œã®ä»–ã«ã‚‚package.jsonãªã©ã®å®šç¾©ãŒå¿…è¦ã§ã™ã€‚</p>\n<div class=\"gatsby-code-title\">plugins/gatsby-source-connpass/gatsby-node.js</div>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">const</span> crypto <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"crypto\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> fetchConnpassEventsWithThumbnails <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fetch-connpass-events-with-thumbnails.js'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token constant\">INTERNAL_TYPE</span> <span class=\"token operator\">=</span> <span class=\"token string\">'connpassEvent'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">DEFAULT_MAX_FETCH_COUNT</span> <span class=\"token operator\">=</span> <span class=\"token number\">100</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">DEFAULT_MIN_FETCH_COUNT</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n\n\n<span class=\"token comment\">// æŒ‡å®šã—ãŸã‚¤ãƒ™ãƒ³ãƒˆã‚°ãƒ«ãƒ¼ãƒ—(eventSeriesIds)ã®ã‚¤ãƒ™ãƒ³ãƒˆã‚’ã‚µãƒ ãƒã‚¤ãƒ«ä»˜ãã§å–å¾—ã™ã‚‹</span>\nexports<span class=\"token punctuation\">.</span>sourceNodes <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span>\n  <span class=\"token punctuation\">{</span> actions<span class=\"token punctuation\">,</span> createNodeId <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">// Plugin options</span>\n  <span class=\"token punctuation\">{</span> \n    eventSeriesIds<span class=\"token punctuation\">,</span>\n    defaultThumbnailUrl<span class=\"token punctuation\">,</span>\n    maxFetchCount<span class=\"token punctuation\">,</span>\n    monthRangePast<span class=\"token punctuation\">,</span>\n    monthRangeFuture<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token comment\">// å¼•æ•°ãƒã‚§ãƒƒã‚¯ã¯çœç•¥</span>\n\n  <span class=\"token keyword\">const</span> events <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetchConnpassEventsWithThumbnails</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    eventSeriesIds<span class=\"token punctuation\">,</span>\n    defaultThumbnailUrl<span class=\"token punctuation\">,</span>\n    maxFetchCount<span class=\"token punctuation\">,</span>\n    monthRangePast<span class=\"token punctuation\">,</span>\n    monthRangeFuture<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n\n  <span class=\"token comment\">// Connpassã‚¤ãƒ™ãƒ³ãƒˆæƒ…å ±ã‚’Nodeã«è¿½åŠ ã—ã¦ã€</span>\n  <span class=\"token comment\">// ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‹ã‚‰GraphQLã®ã‚¯ã‚¨ãƒªã§å–å¾—ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹</span>\n  events<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> contentDigest <span class=\"token operator\">=</span>\n      crypto<span class=\"token punctuation\">.</span><span class=\"token function\">createHash</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">md5</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">digest</span><span class=\"token punctuation\">(</span><span class=\"token string\">'hex'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    actions<span class=\"token punctuation\">.</span><span class=\"token function\">createNode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      <span class=\"token operator\">...</span>event<span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">thumbnail_url</span><span class=\"token operator\">:</span> event<span class=\"token punctuation\">.</span>thumbnail_url<span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">id</span><span class=\"token operator\">:</span> <span class=\"token function\">createNodeId</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">INTERNAL_TYPE</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>event<span class=\"token punctuation\">.</span>event_id<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">children</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">parent</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">__SOURCE__</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">internal</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token literal-property property\">type</span><span class=\"token operator\">:</span> <span class=\"token constant\">INTERNAL_TYPE</span><span class=\"token punctuation\">,</span>\n        contentDigest<span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<br/>\n<p>ã“ã‚Œã«ã‚ˆã‚Šã€Gatsbyã§ãƒ“ãƒ«ãƒ‰ã™ã‚‹æ™‚ã«ã€Connpassã‚¤ãƒ™ãƒ³ãƒˆãŒã‚µãƒ ãƒã‚¤ãƒ«ç”»åƒã®URLä»˜ãã§Nodeã«ç™»éŒ²ã•ã‚Œã¦ã€ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®GraphQLã®ã‚¯ã‚¨ãƒªã§Connpassã‚¤ãƒ™ãƒ³ãƒˆãŒå–å¾—ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚</p>\n<h2 id=\"ã¾ã¨ã‚\" style=\"position:relative;\"><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\" aria-label=\"ã¾ã¨ã‚ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ã¾ã¨ã‚</h2>\n<p>æ‰€æ„Ÿã«ã‚‚æ›¸ã„ãŸé€šã‚Šã€Connpass APIã¯ä½¿ã„ã‚„ã™ã„ã¨ã¯è¨€ãˆã¾ã›ã‚“ã€‚\næ¨™æº–ã§ã‚µãƒ ãƒã‚¤ãƒ«ç”»åƒã®URLã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ãã‚ŒãŸã‚‰ã„ã„ã®ã§ã™ãŒã€æ®‹å¿µãªãŒã‚‰ãã†ã§ã¯ãªã„ã®ã§ã€ä»Šå›ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’æ›¸ãã«è‡³ã‚Šã¾ã—ãŸã€‚ä»Šå¾Œã‚‚ã©ã“ã‹ã®å ´é¢ã§ã“ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’æµç”¨ã—ãã†ã§ã™ã€‚ãŸã ã€Reactã‚¢ãƒ—ãƒªã§Connpassã®ã‚¤ãƒ™ãƒ³ãƒˆã‚’æ¤œç´¢ã—ãŸã„å ´åˆãªã©ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ€§ãŒæ±‚ã‚ã‚‰ã‚Œã‚‹ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã§ã¯ã€ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ã«æ™‚é–“ãŒã‹ã‹ã‚‹ã®ã§ã€ã‚µãƒ ãƒã‚¤ãƒ«ã ã‘LazyLoadã™ã‚‹ã‚ˆã†ãªä»•çµ„ã¿ãŒå¿…è¦ã‹ã¨æ€ã„ã¾ã™ğŸ…</p>\n<h2 id=\"å‚è€ƒ\" style=\"position:relative;\"><a href=\"#%E5%8F%82%E8%80%83\" aria-label=\"å‚è€ƒ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>å‚è€ƒ</h2>\n<ul>\n<li><a href=\"https://connpass.com/about/api/\">APIãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ - connpass</a></li>\n</ul>","excerpt":"ãªã«ã“ã‚Œ Gatsbyè£½ã®ã‚µã‚¤ãƒˆã§Connpassã®ã‚¤ãƒ™ãƒ³ãƒˆã‚’è¡¨ç¤ºã—ãªã‘ã‚Œã°ãªã‚‰ãšã€Conpass APIã‚’ä½¿ã£ãŸã®ã§ã™ãŒã€ã“ã¡ã‚‰ã®APIã§ã¯ã‚µãƒ ãƒã‚¤ãƒ«ç”»åƒãŒå–å¾—ã§ãã¾ã›ã‚“ã€‚ãã®ãŸã‚ã‚µãƒ ãƒã‚¤ãƒ«ã¯ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ã§å–å¾—ã™ã‚‹ã‚ˆã†ã«ã—ã¾ã—ãŸã€‚å–å¾—è‡ªä½“ã¯å˜ç´”ãªNode.jsâ€¦","frontmatter":{"slug":"/how-to-fetch-connpass-events-with-thumbnails","title":"Connpass APIã§ã‚µãƒ ãƒã‚¤ãƒ«ä»˜ãã®ã‚¤ãƒ™ãƒ³ãƒˆæƒ…å ±ã‚’å–å¾—ã™ã‚‹æ–¹æ³•","date":"2020-06-22T08:00:00.000+09:00","tags":["Connpass","Node.js"],"keywords":["Connpass"],"thumbnail":"thumbnail/2020/06/how-to-fetch-connpass-events-with-thumbnails.png","category":null}},{"html":"<h2 id=\"ãªã«ã“ã‚Œ\" style=\"position:relative;\"><a href=\"#%E3%81%AA%E3%81%AB%E3%81%93%E3%82%8C\" aria-label=\"ãªã«ã“ã‚Œ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ãªã«ã“ã‚Œ</h2>\n<p><a href=\"/wordcloud-with-kuromoji-d3cloud-react\">å‰å›è¨˜äº‹</a>ã§ã¯Reactã§WordCloudã‚’å‡ºåŠ›ã—ã¾ã—ãŸã€‚ã—ã‹ã—å®Ÿéš›ã¯ã€éå»å¤§é‡ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰å‡ºåŠ›ã™ã‚‹ã‚ˆã†ãªãƒ„ãƒ¼ãƒ«ã¨ã—ã¦ä½¿ãˆãŸã»ã†ãŒä¾¿åˆ©ã§ã™ã€‚\nãã“ã§<a href=\"https://github.com/Takumon/playbox2019/blob/master/react-kuromoji-sample/src/App.js\">å‰å›ã®ã‚µãƒ³ãƒ—ãƒ«</a>ã‚’ãƒ™ãƒ¼ã‚¹ã«Node.jsã§WordCloudã®SVGãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‡ºåŠ›ã™ã‚‹ã‚µãƒ³ãƒ—ãƒ«ã‚’ä½œæˆã—ã¾ã—ãŸã€‚\nä»Šå›ã¯ã‚µãƒ³ãƒ—ãƒ«ã®å®Ÿè£…æ–¹æ³•ã‚’ãƒã‚¤ãƒ³ãƒˆã¨åˆã‚ã›ã¦ã”ç´¹ä»‹ã—ã¾ã™ã€‚</p>\n<p>â€»ã‚µãƒ³ãƒ—ãƒ«ã¯ä»¥ä¸‹ã«ç½®ã„ã¦ãŠã‚Šã¾ã™ã€‚\n<a href=\"https://github.com/Takumon/playbox2019/blob/master/node-kuromoji-d3cloud-sample/index.js\">https://github.com/Takumon/playbox2019/blob/master/node-kuromoji-d3cloud-sample/index.js</a></p>\n<p>ã“ã®è¨˜äº‹ã¯ã€<a href=\"https://gw-advent.9wick.com/calendars/9\">challenge-every-monthå…¨å“¡ã§ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆèŠ¸äºº Advent Calendar</a> 9æ—¥ç›®ã®è¨˜äº‹ã§ã™ã€‚å‰æ—¥ã®è¨˜äº‹ã¯ã€<a href=\"https://twitter.com/kojirock5260\">@kojirock5260</a>ã•ã‚“ã®è¨˜äº‹ã§ã—ãŸã€‚</p>\n<iframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fkojirooooocks.hatenablog.com%2Fentry%2F2019%2F05%2F04%2F163742\" style=\"border: 0; width: 100%; height: 190px;\" allowfullscreen scrolling=\"no\" allow=\"autoplay; encrypted-media\"></iframe>\n<h2 id=\"å‡¦ç†æ‰‹é †\" style=\"position:relative;\"><a href=\"#%E5%87%A6%E7%90%86%E6%89%8B%E9%A0%86\" aria-label=\"å‡¦ç†æ‰‹é † permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>å‡¦ç†æ‰‹é †</h2>\n<p>ä»¥ä¸‹4ã‚¹ãƒ†ãƒƒãƒ—ã§ã™ã€‚</p>\n<ol>\n<li>kuromoji.jsã§æ–‡ç« ã‚’è§£æã—ã¦å˜èªå‡ºç¾å›æ•°ã‚’ãƒ‡ãƒ¼ã‚¿åŒ–</li>\n<li>D3-Cloudã§ä¸Šè¨˜ãƒ‡ãƒ¼ã‚¿ã«ä»¥ä¸‹æƒ…å ±è¿½åŠ \n<ol>\n<li>ãƒ•ã‚©ãƒ³ãƒˆã®å¤§ãã•</li>\n<li>ãƒ•ã‚©ãƒ³ãƒˆã®å›è»¢ä½ç½®</li>\n<li>ãƒ•ã‚©ãƒ³ãƒˆã®ç¨®é¡</li>\n<li>è¡¨ç¤ºä½ç½®</li>\n</ol>\n</li>\n<li>d3.jsã§é…è‰²ã‚’æ±ºå®šã—SVGã‚’<strong>ä»®æƒ³DOM</strong>ã«æç”»</li>\n<li>SVGã‚’ãƒ•ã‚¡ã‚¤ãƒ«å‡ºåŠ›</li>\n</ol>\n<h2 id=\"å®Ÿè£…ã®ãƒã‚¤ãƒ³ãƒˆ\" style=\"position:relative;\"><a href=\"#%E5%AE%9F%E8%A3%85%E3%81%AE%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88\" aria-label=\"å®Ÿè£…ã®ãƒã‚¤ãƒ³ãƒˆ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>å®Ÿè£…ã®ãƒã‚¤ãƒ³ãƒˆ</h2>\n<h3 id=\"1-d3-cloud--canvasã ã‘ã§ã¯ä¸ååˆ†ãªã®ã§d3jsã‚’ä½¿ã†\" style=\"position:relative;\"><a href=\"#1-d3-cloud--canvas%E3%81%A0%E3%81%91%E3%81%A7%E3%81%AF%E4%B8%8D%E5%8D%81%E5%88%86%E3%81%AA%E3%81%AE%E3%81%A7d3js%E3%82%92%E4%BD%BF%E3%81%86\" aria-label=\"1 d3 cloud  canvasã ã‘ã§ã¯ä¸ååˆ†ãªã®ã§d3jsã‚’ä½¿ã† permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. D3-Cloud + Canvasã ã‘ã§ã¯ä¸ååˆ†ãªã®ã§d3.jsã‚’ä½¿ã†</h3>\n<p>æœ€åˆã¯ã€D3-Cloudã§Canvasã‚’ä½¿ãˆã‚‹ã®ã§ã€<a href=\"https://github.com/Automattic/node-canvas\">node-canvas</a>ã‚’ä½¿ãˆã°Node.jsã§ã‚‚ç”»åƒã‚’ç”Ÿæˆã§ãã‚‹ã®ã§ã¯ï¼Ÿã¨è€ƒãˆãŸã®ã§ã™ãŒã€ã‚„ã£ã¦ã¿ã‚‹ã¨ã†ã¾ãã„ãã¾ã›ã‚“ã€‚ä»¥ä¸‹ã®ã‚ˆã†ãªç”»åƒãŒå‡ºåŠ›ã•ã‚Œã¾ã™ã€‚</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/4538ff67e1815ab50581a395af5a3b88/5a3c9/wordcloud-by-canvas.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 68.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAABcRAAAXEQHKJvM/AAACWUlEQVR42k1STU/bQBD1//8DVVWp4siNA1GtVM2BA+IAAQJyQrCTTZzYcbJe25sQgnGWV73dumBpvLPz8ebNzHqi3/9enJ721knySw6Hvry48GWS+PLkxJfdri+XS19mmS/nc1/e3fny7MyXk4kvN5v/duYWj49/xkHw09OLRYCrK6AsDfZ7QAigroF+H8gy4HgE8hy4vgYOB2C9BpoGeH9352YDvLwY9HpQURR6VZ4/AoAxpjH7vTHHo7EfTa20H/XDwZi6NqYoXGyWGZMkDZZL5Gk69vTlZYDBgNUNhkNWA7QGlIK9SwnMZsDTEzAew8bSdnPjYpZL+mx3SuvQ01oHZIjj0Vg+/NLUtb5YAFHkgJnI1tsYlwPsdrZB/pRSoaejKLDz0NrYGTGhZUidjDmrsnSAjKWvqoDt1s2buR8fUEURelqIwFbabg3e3lxgkrjhM5ktTqfuTjYuFnh9dWAEl/ILw+EwsM6qMigKx46gPJlIIRgZUufmWZg6R0M7c+saKklCT9/fO4arlcFk4gZPRpzZfP7ZWgsQhq71tm0+td3OAUoZeno0cjOMY2NBCErhUuLYtcmTgO1WuSxunoV5JonBagU1Gv1jyMf5/GxsAFkxyQWSuQMkCKX100edPpIpS6jxOPS2Qgws9TStIWWDNG2wWPChNuCDpWRZY3153qAonE6bUg2qqkFZ1uxAxfHI03HsWuam2BIXQ2ER3lsbh09pZ9fenW5fiJrNQi++vf32IsTvMorOq8mkUwnRqabTT+GddspXW3vO551SiPPdbNYVDw8//gJnIRX3lkjjHwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/4538ff67e1815ab50581a395af5a3b88/ba381/wordcloud-by-canvas.webp 200w,\n/static/4538ff67e1815ab50581a395af5a3b88/7f61c/wordcloud-by-canvas.webp 400w,\n/static/4538ff67e1815ab50581a395af5a3b88/d00b9/wordcloud-by-canvas.webp 800w,\n/static/4538ff67e1815ab50581a395af5a3b88/e28de/wordcloud-by-canvas.webp 1169w\"\n              sizes=\"(max-width: 800px) 100vw, 800px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/4538ff67e1815ab50581a395af5a3b88/772e8/wordcloud-by-canvas.png 200w,\n/static/4538ff67e1815ab50581a395af5a3b88/e17e5/wordcloud-by-canvas.png 400w,\n/static/4538ff67e1815ab50581a395af5a3b88/5a190/wordcloud-by-canvas.png 800w,\n/static/4538ff67e1815ab50581a395af5a3b88/5a3c9/wordcloud-by-canvas.png 1169w\"\n            sizes=\"(max-width: 800px) 100vw, 800px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/4538ff67e1815ab50581a395af5a3b88/5a190/wordcloud-by-canvas.png\"\n            alt=\"wordcloud by canvas\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>ãã®ãŸã‚D3-Cloud + Canvasã ã‘ã®çµ„ã¿åˆã‚ã›ã¯ã‚ãã‚‰ã‚ã¦ã€\n<a href=\"https://github.com/Yoctol/react-d3-cloud\">react-d3-cloud</a>ã®å†…éƒ¨å®Ÿè£…ã¨åŒã˜ã‚ˆã†ã«d3.jsã‚’ä½¿ã£ã¦SVGã‚’æç”»ã—ã¦ã€ãã“ã‹ã‚‰ãƒ•ã‚¡ã‚¤ãƒ«å‡ºåŠ›å‡¦ç†ã™ã‚‹ã‚ˆã†ã«ã—ã¾ã—ãŸã€‚</p>\n<h3 id=\"2-domã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆç”¨ã«node-canvasã¨jsdomã‚’ä½¿ã†\" style=\"position:relative;\"><a href=\"#2-dom%E3%82%A8%E3%83%9F%E3%83%A5%E3%83%AC%E3%83%BC%E3%83%88%E7%94%A8%E3%81%ABnode-canvas%E3%81%A8jsdom%E3%82%92%E4%BD%BF%E3%81%86\" aria-label=\"2 domã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆç”¨ã«node canvasã¨jsdomã‚’ä½¿ã† permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. DOMã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆç”¨ã«node-canvasã¨jsdomã‚’ä½¿ã†</h3>\n<p><a href=\"https://github.com/d3/d3\">d3.js</a>ã¯ã€ãƒ–ãƒ©ã‚¦ã‚¶ä¸Šã§ã®å‹•ä½œã‚’å‰æã¨ã—ã¦ã„ã‚‹ãŸã‚DOMãŒå¿…è¦ã§ã™ã€‚Node.jsã§DOMã‚’ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆã™ã‚‹ãŸã‚ã«<a href=\"https://github.com/jsdom/jsdom\">jsdom</a>ã‚’ä½¿ã„ã¾ã—ãŸã€‚<br/>\n<a href=\"https://github.com/jasondavies/d3-cloud\">D3-Cloud</a>ã‚‚åŒæ§˜ã«Canvasã®æŒ‡å®šãŒå¿…é ˆã§ã™ã€‚\nãã®ãŸã‚Canvasã‚’ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆã™ã‚‹<a href=\"https://github.com/Automattic/node-canvas\">node-canvas</a>ã‚’ä½¿ã„ã¾ã—ãŸã€‚</p>\n<h2 id=\"å®Ÿè£…\" style=\"position:relative;\"><a href=\"#%E5%AE%9F%E8%A3%85\" aria-label=\"å®Ÿè£… permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>å®Ÿè£…</h2>\n<p>ãƒã‚¤ãƒ³ãƒˆã‚’è¸ã¾ãˆãŸã†ãˆã§4ã‚¹ãƒ†ãƒƒãƒ—ã”ã¨ã«å®Ÿè£…æ–¹æ³•ã‚’èª¬æ˜ã—ã¾ã™ã€‚</p>\n<h3 id=\"1-kuromojijsã§æ–‡ç« ã‚’è§£æã—ã¦å˜èªå‡ºç¾å›æ•°ã‚’ãƒ‡ãƒ¼ã‚¿åŒ–\" style=\"position:relative;\"><a href=\"#1-kuromojijs%E3%81%A7%E6%96%87%E7%AB%A0%E3%82%92%E8%A7%A3%E6%9E%90%E3%81%97%E3%81%A6%E5%8D%98%E8%AA%9E%E5%87%BA%E7%8F%BE%E5%9B%9E%E6%95%B0%E3%82%92%E3%83%87%E3%83%BC%E3%82%BF%E5%8C%96\" aria-label=\"1 kuromojijsã§æ–‡ç« ã‚’è§£æã—ã¦å˜èªå‡ºç¾å›æ•°ã‚’ãƒ‡ãƒ¼ã‚¿åŒ– permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. kuromoji.jsã§æ–‡ç« ã‚’è§£æã—ã¦å˜èªå‡ºç¾å›æ•°ã‚’ãƒ‡ãƒ¼ã‚¿åŒ–</h3>\n<p>kuromoji.jsã«ã‚ˆã‚‹ãƒ‡ãƒ¼ã‚¿åŠ å·¥ã«ã¤ã„ã¦ã¯<a href=\"/wordcloud-with-kuromoji-d3cloud-react#1-%E6%96%87%E7%AB%A0%E3%82%92%E8%A7%A3%E6%9E%90%E3%81%97%E3%81%A6%E5%8D%98%E8%AA%9E%E5%87%BA%E7%8F%BE%E5%9B%9E%E6%95%B0%E3%82%92%E3%83%87%E3%83%BC%E3%82%BF%E5%8C%96-1\">å‰å›è¨˜äº‹ã®Reactã‚¢ãƒ—ãƒª</a>ã¨åŒæ§˜ã§ã™ã€‚\nä»Šå›ã¯ãƒ–ãƒ©ã‚¦ã‚¶ã§ã¯ãªãNode.jsã§å‹•ã‹ã™ã®ã§kuromoji.jsã®è¾æ›¸ã¯node_modulesé…ä¸‹ã‹ã‚‰ç§»å‹•ã™ã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</p>\n<div class=\"gatsby-code-title\">kuromoji.jsã«ã‚ˆã‚‹è§£æå‡¦ç†</div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> kuromoji <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'kuromoji'</span><span class=\"token punctuation\">)</span>\n\n\n<span class=\"token comment\">// ã‚¤ãƒ³ãƒ—ãƒƒãƒˆã¨ãªã‚‹æ–‡ç« (é•·æ–‡ã«ã¤ãä¸€éƒ¨çœç•¥)</span>\n<span class=\"token keyword\">const</span> text <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\nãã“ã‚‚å ´åˆã‚‚ã†ãã®ç—…æ°—ã‚‰ã«å¯¾ã—ã¦æ—¨ã®æ™‚ãŒã—ã‚“ã¾ã›ã€‚\nå˜ã«äº‹å®Ÿã«ä½¿ç”¨æ–¹ã¯ã©ã†ã‹ãã®å¿œç”¨ãŸãªã„ã§ã‚‚ãŒæ€ã„ã¦ãªã‚‰ãªã„ãŒã‚‚ç™ºå±•æ€ã„ã†ã¹ãã¦ã€\nã‚ã„ã«ãã«ã‚‚ãªã‚‹ã ãªã§ã™ãŸã€‚\nãƒ»ãƒ»ãƒ»\n</span><span class=\"token template-punctuation string\">`</span></span>\n\n<span class=\"token comment\">// kuromoji.jsã«ãƒãƒ³ãƒ‰ãƒ«ã•ã‚Œã¦ã„ã‚‹è¾æ›¸ã®ãƒ•ã‚©ãƒ«ãƒ€ãƒ‘ã‚¹</span>\n<span class=\"token comment\">// kuromoji.jsã¯å½¢æ…‹ç´ è§£æç”¨é–¢æ•°ã‚’ç”Ÿæˆã™ã‚‹éš›ã«è¾æ›¸ã‚’èª­ã¿è¾¼ã‚€</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">DIC_URL</span> <span class=\"token operator\">=</span> <span class=\"token string\">'node_modules/kuromoji/dict'</span>\n\n<span class=\"token comment\">// WordCloudã®æƒ…å ±ã¨ã—ã¦æŠ½å‡ºã™ã‚‹å“è©ï¼ˆåŠ©è©ã€åŠ©å‹•è©ãªã©ã¯æ„å‘³ãŒãªã„ã®ã§æ‹¾ã‚ãªã„ï¼‰</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">TARGET_POS</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'åè©'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'å‹•è©'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'å½¢å®¹è©'</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token comment\">// kuromoji.jsã®è§£æçµæœã®å€¤ã§ç‰¹ã«å€¤ãŒãªã„å ´åˆã¯ä»¥ä¸‹ã®æ–‡å­—ãŒè¨­å®šã•ã‚Œã‚‹</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">NO_CONTENT</span> <span class=\"token operator\">=</span> <span class=\"token string\">'*'</span>\n\n\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token comment\">// kuromoji.jsã«ã‚ˆã‚‹è§£æå‡¦ç†</span>\n  <span class=\"token keyword\">const</span> words <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resolve<span class=\"token punctuation\">,</span> reject</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// è¾æ›¸ã‚’èª­ã¿æ··ã‚“ã§ãƒˆãƒ¼ã‚¯ãƒŠã‚¤ã‚¶ãƒ¼ï¼ˆå½¢æ…‹ç´ è§£æã™ã‚‹ãŸã‚ã®é–¢æ•°ï¼‰ã‚’ç”Ÿæˆ</span>\n    kuromoji<span class=\"token punctuation\">.</span><span class=\"token function\">builder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">dicPath</span><span class=\"token operator\">:</span> <span class=\"token constant\">DIC_URL</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">err<span class=\"token punctuation\">,</span> tokenizer</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token function\">reject</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span>\n\n      <span class=\"token comment\">// ãƒ†ã‚­ã‚¹ãƒˆã‚’å¼•æ•°ã«ã—ã¦å½¢æ…‹ç´ è§£æ</span>\n      <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>tokenizer<span class=\"token punctuation\">.</span><span class=\"token function\">tokenize</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">)</span>\n        <span class=\"token comment\">// posï¼ˆå“è©ï¼‰ã‚’å‚ç…§ã—ã€'åè©', 'å‹•è©', 'å½¢å®¹è©'ã®ã¿ã‚’æŠ½å‡º</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">t</span> <span class=\"token operator\">=></span> <span class=\"token constant\">TARGET_POS</span><span class=\"token punctuation\">.</span><span class=\"token function\">includes</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">.</span>pos<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token comment\">// å˜èªã‚’æŠ½å‡º(basic_formã‹surface_formã«å˜èªãŒå­˜åœ¨ã™ã‚‹)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">t</span> <span class=\"token operator\">=></span> t<span class=\"token punctuation\">.</span>basic_form <span class=\"token operator\">===</span> <span class=\"token constant\">NO_CONTENT</span> <span class=\"token operator\">?</span> t<span class=\"token punctuation\">.</span>surface_form <span class=\"token operator\">:</span> t<span class=\"token punctuation\">.</span>basic_form<span class=\"token punctuation\">)</span>\n        <span class=\"token comment\">// [{text: å˜èª, size: å‡ºç¾å›æ•°}]ã®å½¢ã«Reduce</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">reduce</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">data<span class=\"token punctuation\">,</span> text</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n          <span class=\"token keyword\">const</span> target <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">c</span> <span class=\"token operator\">=></span> c<span class=\"token punctuation\">.</span>text <span class=\"token operator\">===</span> text<span class=\"token punctuation\">)</span>\n\n          <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>target<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            target<span class=\"token punctuation\">.</span>size <span class=\"token operator\">=</span> target<span class=\"token punctuation\">.</span>size <span class=\"token operator\">+</span> <span class=\"token number\">1</span>\n          <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n            data<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n              text<span class=\"token punctuation\">,</span>\n              <span class=\"token literal-property property\">size</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">}</span>\n          <span class=\"token keyword\">return</span> data\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n\n  <span class=\"token comment\">// D3-Cloudã«ã‚ˆã‚‹è§£æå‡¦ç†</span>\n  <span class=\"token comment\">// (ç•¥)</span>\n\n  <span class=\"token comment\">// d3.jsã«ã‚ˆã‚‹æç”»å‡¦ç†</span>\n  <span class=\"token comment\">// (ç•¥)</span>\n\n  <span class=\"token comment\">// SVGãƒ•ã‚¡ã‚¤ãƒ«å‡ºåŠ›å‡¦ç†</span>\n  <span class=\"token comment\">// (ç•¥)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<br/>\n<p>ã“ã‚Œã§ä»¥ä¸‹ã®ã‚ˆã†ãªæƒ…å ±ãŒå¾—ã‚‰ã‚Œã¾ã™ã€‚</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token punctuation\">[</span> \n  <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">text</span><span class=\"token operator\">:</span> <span class=\"token string\">'ç›¸é•'</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// å˜èª</span>\n    <span class=\"token literal-property property\">size</span><span class=\"token operator\">:</span> <span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// å‡ºç¾å›æ•°</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<br/>\n<h3 id=\"2-d3-cloudã§ä¸Šè¨˜ãƒ‡ãƒ¼ã‚¿ã«ä»¥ä¸‹æƒ…å ±è¿½åŠ \" style=\"position:relative;\"><a href=\"#2-d3-cloud%E3%81%A7%E4%B8%8A%E8%A8%98%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AB%E4%BB%A5%E4%B8%8B%E6%83%85%E5%A0%B1%E8%BF%BD%E5%8A%A0\" aria-label=\"2 d3 cloudã§ä¸Šè¨˜ãƒ‡ãƒ¼ã‚¿ã«ä»¥ä¸‹æƒ…å ±è¿½åŠ  permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. D3-Cloudã§ä¸Šè¨˜ãƒ‡ãƒ¼ã‚¿ã«ä»¥ä¸‹æƒ…å ±è¿½åŠ </h3>\n<p>D3-Cloudã§ã¯è§£ææƒ…å ±ã«ä»¥ä¸‹ã‚’è¿½åŠ ã™ã‚‹ã ã‘ã§ã™ã€‚</p>\n<ul>\n<li>ãƒ•ã‚©ãƒ³ãƒˆã®å›è»¢ä½ç½® â˜šè‡ªåˆ†ã§å®šç¾©</li>\n<li>ãƒ•ã‚©ãƒ³ãƒˆã®é‡ã¿ â˜šè‡ªåˆ†ã§å®šç¾©</li>\n<li>ãƒ•ã‚©ãƒ³ãƒˆã®å¤§ãã• â˜šè‡ªåˆ†ã§å®šç¾©</li>\n<li>ãƒ•ã‚©ãƒ³ãƒˆã®ç¨®é¡ â˜šè‡ªåˆ†ã§å®šç¾©</li>\n<li>è¡¨ç¤ºä½ç½® â˜šD3-CloudãŒå®šç¾©ã—ã¦ãã‚Œã‚‹</li>\n</ul>\n<p>ãªãŠD3-Cloudã¯bodyã‚¿ã‚°ã‹CanvasãŒå¿…é ˆãªã®ã§ã€ä»Šå›ã¯<a href=\"https://github.com/Automattic/node-canvas\">node-canvas</a>ã‚’ä½¿ã„ã¾ã™ã€‚</p>\n<div class=\"gatsby-code-title\">D3-Cloudã«ã‚ˆã‚‹è§£æå‡¦ç†</div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> cloud <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'d3-cloud'</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">// Node.jsã§Canvasã‚’ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆã™ã‚‹ãŸã‚node-canvasã‚’ä½¿ã†</span>\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> createCanvas <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'canvas'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// Canvasã®å¹…(px)</span>\n<span class=\"token keyword\">const</span> w <span class=\"token operator\">=</span> <span class=\"token number\">1600</span>\n\n<span class=\"token comment\">// Canvasã®é«˜ã•(px)</span>\n<span class=\"token keyword\">const</span> h <span class=\"token operator\">=</span> <span class=\"token number\">1000</span>\n\n\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token comment\">// kuromoji.jsã«ã‚ˆã‚‹è§£æå‡¦ç†</span>\n  <span class=\"token comment\">// (ç•¥)</span>\n\n  <span class=\"token comment\">// D3-Cloudã«ã‚ˆã‚‹è§£æå‡¦ç†</span>\n  <span class=\"token comment\">// D3-Cloudã®è§£æã«ã‚ˆã£ã¦wordsForCloudã«ã¯</span>\n  <span class=\"token comment\">// å‡ºç¾å›æ•°ã®ä»–ã«ãƒ•ã‚©ãƒ³ãƒˆã®å›è»¢ä½ç½®ã€å¤§ãã•ã€é‡ã¿ã€ç¨®é¡ãŒè¿½åŠ ã•ã‚ŒãŸçŠ¶æ…‹ã«ãªã‚‹</span>\n  <span class=\"token keyword\">const</span> wordsForCloud <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resolve</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">cloud</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>w<span class=\"token punctuation\">,</span> h<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// node-canvasã‚’æŒ‡å®šã™ã‚‹(ã‚¨ãƒ©ãƒ¼ã‚’é˜²ããŸã‚)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">canvas</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">createCanvas</span><span class=\"token punctuation\">(</span>w<span class=\"token punctuation\">,</span> h<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// kuromoji.jsã®è§£æçµæœã‚’æŒ‡å®š</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">words</span><span class=\"token punctuation\">(</span>words<span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// ãƒ•ã‚©ãƒ³ãƒˆã®å›è»¢ä½ç½®ã‚’æŒ‡å®š</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">rotate</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">word</span> <span class=\"token operator\">=></span> word<span class=\"token punctuation\">.</span>size <span class=\"token operator\">%</span> <span class=\"token number\">2</span> <span class=\"token operator\">===</span> <span class=\"token number\">1</span> <span class=\"token operator\">?</span> <span class=\"token number\">0</span> <span class=\"token operator\">:</span> <span class=\"token number\">90</span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// ãƒ•ã‚©ãƒ³ãƒˆã®é‡ã¿ã‚’æŒ‡å®š</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">fontWeight</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">word</span> <span class=\"token operator\">=></span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">pow</span><span class=\"token punctuation\">(</span>word<span class=\"token punctuation\">.</span>size<span class=\"token punctuation\">,</span> <span class=\"token number\">1.3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// ãƒ•ã‚©ãƒ³ãƒˆã®å¤§ãã•ã‚’æŒ‡å®š</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">fontSize</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">word</span> <span class=\"token operator\">=></span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">pow</span><span class=\"token punctuation\">(</span>word<span class=\"token punctuation\">.</span>size<span class=\"token punctuation\">,</span> <span class=\"token number\">1.3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// ãƒ•ã‚©ãƒ³ãƒˆã®ç¨®é¡ã‚’æŒ‡å®š</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">font</span><span class=\"token punctuation\">(</span><span class=\"token string\">'meiryo'</span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// åŠ å·¥çµ‚äº†æ™‚ã®ã‚¤ãƒ™ãƒ³ãƒˆç™»éŒ²ã€è§£æçµæœã‚’d3.jsã§ã®æç”»ã«å¼•ãç¶™ã</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'end'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">words</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>words<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// è§£æé–‹å§‹</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token comment\">// d3.jsã«ã‚ˆã‚‹æç”»å‡¦ç†</span>\n  <span class=\"token comment\">// (ç•¥)</span>\n\n  <span class=\"token comment\">// SVGãƒ•ã‚¡ã‚¤ãƒ«å‡ºåŠ›å‡¦ç†</span>\n  <span class=\"token comment\">// (ç•¥)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<br/>\n<p>ã“ã‚Œã§ä»¥ä¸‹ã®ã‚ˆã†ãªæƒ…å ±ãŒå¾—ã‚‰ã‚Œã¾ã™ã€‚</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">{</span> \n    <span class=\"token literal-property property\">text</span><span class=\"token operator\">:</span> <span class=\"token string\">'ç›¸é•'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">size</span><span class=\"token operator\">:</span> <span class=\"token number\">19</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// D3-Cloudã«ã‚ˆã£ã¦è¿½åŠ ã•ã‚ŒãŸæƒ…å ±</span>\n    <span class=\"token literal-property property\">font</span><span class=\"token operator\">:</span> <span class=\"token string\">'meiryo'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">style</span><span class=\"token operator\">:</span> <span class=\"token string\">'normal'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">weight</span><span class=\"token operator\">:</span> <span class=\"token number\">19.952623149688797</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">rotate</span><span class=\"token operator\">:</span> <span class=\"token number\">90</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">padding</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">width</span><span class=\"token operator\">:</span> <span class=\"token number\">64</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">height</span><span class=\"token operator\">:</span> <span class=\"token number\">59</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">xoff</span><span class=\"token operator\">:</span> <span class=\"token number\">192</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">yoff</span><span class=\"token operator\">:</span> <span class=\"token number\">957</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">x1</span><span class=\"token operator\">:</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">y1</span><span class=\"token operator\">:</span> <span class=\"token number\">28</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">x0</span><span class=\"token operator\">:</span> <span class=\"token operator\">-</span><span class=\"token number\">32</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">y0</span><span class=\"token operator\">:</span> <span class=\"token operator\">-</span><span class=\"token number\">22</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">hasText</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">x</span><span class=\"token operator\">:</span> <span class=\"token operator\">-</span><span class=\"token number\">199</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">y</span><span class=\"token operator\">:</span> <span class=\"token number\">294</span> \n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<br/>\n<h3 id=\"3-d3jsã§é…è‰²ã‚’æ±ºå®šã—svgã‚’ä»®æƒ³domã«æç”»\" style=\"position:relative;\"><a href=\"#3-d3js%E3%81%A7%E9%85%8D%E8%89%B2%E3%82%92%E6%B1%BA%E5%AE%9A%E3%81%97svg%E3%82%92%E4%BB%AE%E6%83%B3dom%E3%81%AB%E6%8F%8F%E7%94%BB\" aria-label=\"3 d3jsã§é…è‰²ã‚’æ±ºå®šã—svgã‚’ä»®æƒ³domã«æç”» permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. d3.jsã§é…è‰²ã‚’æ±ºå®šã—SVGã‚’<strong>ä»®æƒ³DOM</strong>ã«æç”»</h3>\n<p>D3-Cloudã®è§£ææƒ…å ±ã«æ–‡å­—è‰²ã‚„é…ç½®æƒ…å ±ã‚’è¿½åŠ ã—ã¦SVGã‚’ä»®æƒ³DOMä¸Šã«æç”»ã—ã¾ã™ã€‚\nä»®æƒ³DOMã¯<a href=\"https://github.com/jsdom/jsdom\">jsdom</a>ã‚’ä½¿ã£ã¦ç”Ÿæˆã—ã¾ã™ã€‚<br/>\nãƒ•ã‚©ãƒ³ãƒˆè‰²ã®ãƒ†ãƒ¼ãƒã¯<code class=\"language-text\">schemeCategory10</code>ã‚’ä½¿ã„ã¾ã—ãŸã€‚ä»–ã«ã‚‚ã„ã‚ã„ã‚ãƒ†ãƒ¼ãƒãŒã‚ã‚‹ã‚ˆã†ã§ã™ã€‚<br/>\nå‚è€ƒï¼š<a href=\"https://wizardace.com/d3v5-scale-chromatic/\">D3.js v5 ã‚«ãƒ©ãƒ¼ãƒ†ãƒ¼ãƒã¾ã¨ã‚ (d3-scale-chromatic) â€“ ãƒ‡ãƒ¼ã‚¿ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ©ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³ãƒ»ãƒ©ãƒœ</a></p>\n<div class=\"gatsby-code-title\">d3.jsã«ã‚ˆã‚‹SVGæç”»å‡¦ç†</div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> d3 <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'d3'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> <span class=\"token constant\">JSDOM</span> <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"jsdom\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// ä»®æƒ³documentã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ç”Ÿæˆ</span>\n<span class=\"token keyword\">const</span> document <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">JSDOM</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">&lt;body>&lt;/body></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>window<span class=\"token punctuation\">.</span>document\n\n<span class=\"token comment\">// WordCloudæç”»é ˜åŸŸã®å¹…(px) â€»Canvasã®ã‚„ã¤ã‚’ä½¿ã„ã¾ã‚ã—</span>\n<span class=\"token keyword\">const</span> w <span class=\"token operator\">=</span> <span class=\"token number\">1600</span>\n\n<span class=\"token comment\">// WordCloudæç”»é ˜åŸŸã®é«˜ã•(px) â€»Canvasã®ã‚„ã¤ã‚’ä½¿ã„ã¾ã‚ã—</span>\n<span class=\"token keyword\">const</span> h <span class=\"token operator\">=</span> <span class=\"token number\">1000</span>\n\n\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token comment\">// kuromoji.jsã«ã‚ˆã‚‹å½¢æ…‹ç´ è§£æ</span>\n  <span class=\"token comment\">// (ç•¥)</span>\n\n  <span class=\"token comment\">// D3-Cloudã«ã‚ˆã‚‹è§£æå‡¦ç†</span>\n  <span class=\"token comment\">// (ç•¥)</span>\n\n  <span class=\"token comment\">// d3.jsã«ã‚ˆã‚‹SVGæç”»å‡¦ç†</span>\n  <span class=\"token comment\">// ä»®æƒ³DOMã®bodyã‚¿ã‚°ã‚’æŒ‡å®š</span>\n  d3<span class=\"token punctuation\">.</span><span class=\"token function\">select</span><span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">)</span>\n    <span class=\"token comment\">// SVGå½¢å¼ã§ä»®æƒ³DOMã«æç”»</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">'svg'</span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// SVGã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚‚ã‚ã‚‚ã‚æŒ‡å®š</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'class'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'ui fluid image'</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'viewBox'</span><span class=\"token punctuation\">,</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">0 0 </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>w<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>h<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'width'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'100%'</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'height'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'100%'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token comment\">// SVGã®ã‚°ãƒ«ãƒ¼ãƒ—è¦ç´ è¿½åŠ ã—ã¦</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">'g'</span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// SVGã‚’ä¸­å¤®å¯„ã›</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'transform'</span><span class=\"token punctuation\">,</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">translate(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>w<span class=\"token operator\">/</span><span class=\"token number\">2</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">,</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>h<span class=\"token operator\">/</span><span class=\"token number\">2</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">)</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n    <span class=\"token comment\">// ãƒ†ã‚­ã‚¹ãƒˆè¦ç´ ã«D3-Cloudã«ã‚ˆã‚‹è§£æçµæœã‚’è¿½åŠ </span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">selectAll</span><span class=\"token punctuation\">(</span><span class=\"token string\">'text'</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">data</span><span class=\"token punctuation\">(</span>wordsForCloud<span class=\"token punctuation\">)</span>\n    <span class=\"token comment\">// é ˜åŸŸã‚’æ–°è¦ä½œæˆã—ã€ãƒ†ã‚­ã‚¹ãƒˆè¦ç´ è¿½åŠ </span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">enter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">'text'</span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// ãƒ•ã‚©ãƒ³ãƒˆã®å¤§ãã•ã¯è§£æçµæœé€šã‚Šã«æŒ‡å®š</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">style</span><span class=\"token punctuation\">(</span><span class=\"token string\">'font-size'</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">d</span> <span class=\"token operator\">=></span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>d<span class=\"token punctuation\">.</span>size<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// ãƒ•ã‚©ãƒ³ãƒˆã®ç¨®é¡ã¯è§£æçµæœé€šã‚Šã«æŒ‡å®š</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">style</span><span class=\"token punctuation\">(</span><span class=\"token string\">'font-family'</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">d</span> <span class=\"token operator\">=></span> d<span class=\"token punctuation\">.</span>font<span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// ãƒ•ã‚©ãƒ³ãƒˆã®é…è‰²ã¯ã€schemeCategory10ã‚’æŒ‡å®š</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">style</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fill'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">d<span class=\"token punctuation\">,</span> i</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> d3<span class=\"token punctuation\">.</span>schemeCategory10<span class=\"token punctuation\">[</span>i <span class=\"token operator\">%</span> <span class=\"token number\">10</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// ãƒ†ã‚­ã‚¹ãƒˆã®çœŸã‚“ä¸­ã‚’è¡¨ç¤ºä½ç½®ã®ãƒã‚¤ãƒ³ãƒˆã«æŒ‡å®š</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'text-anchor'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'middle'</span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// ä½ç½®ã¨å›è»¢ä½ç½®ã¯è§£æçµæœé€šã‚Šã«æŒ‡å®š</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'transform'</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">d</span> <span class=\"token operator\">=></span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">translate(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>d<span class=\"token punctuation\">.</span>x<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">, </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>d<span class=\"token punctuation\">.</span>y<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">)rotate(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>d<span class=\"token punctuation\">.</span>rotate<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">)</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// å˜èªã¯è§£æçµæœé€šã‚Šã«æŒ‡å®š</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">text</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">d</span> <span class=\"token operator\">=></span> d<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\">// SVGãƒ•ã‚¡ã‚¤ãƒ«å‡ºåŠ›å‡¦ç†</span>\n    <span class=\"token comment\">// (ç•¥)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<br/>\n<h3 id=\"4-svgã‚’ãƒ•ã‚¡ã‚¤ãƒ«å‡ºåŠ›\" style=\"position:relative;\"><a href=\"#4-svg%E3%82%92%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E5%87%BA%E5%8A%9B\" aria-label=\"4 svgã‚’ãƒ•ã‚¡ã‚¤ãƒ«å‡ºåŠ› permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. SVGã‚’ãƒ•ã‚¡ã‚¤ãƒ«å‡ºåŠ›</h3>\n<p>ä»®æƒ³DOMã«æç”»ã—ãŸSVGã‚’ãƒ•ã‚¡ã‚¤ãƒ«å‡ºåŠ›ã—ã¾ã™ã€‚</p>\n<div class=\"gatsby-code-title\">d3.jsã«ã‚ˆã‚‹SVGæç”»å‡¦ç†</div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> fs <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fs'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token comment\">// kuromoji.jsã«ã‚ˆã‚‹å½¢æ…‹ç´ è§£æ</span>\n  <span class=\"token comment\">// (ç•¥)</span>\n\n  <span class=\"token comment\">// D3-Cloudã«ã‚ˆã‚‹è§£æå‡¦ç†</span>\n  <span class=\"token comment\">// (ç•¥)</span>\n\n  <span class=\"token comment\">// d3.jsã«ã‚ˆã‚‹SVGæç”»å‡¦ç†</span>\n  <span class=\"token comment\">// (ç•¥)</span>\n\n  <span class=\"token comment\">// ä»®æƒ³DOMã«æç”»ã•ã‚ŒãŸSVGã‚’ãƒ•ã‚¡ã‚¤ãƒ«å‡ºåŠ›</span>\n  fs<span class=\"token punctuation\">.</span><span class=\"token function\">writeFileSync</span><span class=\"token punctuation\">(</span><span class=\"token string\">'wordcloud.svg'</span><span class=\"token punctuation\">,</span> document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>innerHTML<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<br/>\n<p>ã™ã‚‹ã¨ä»¥ä¸‹ã®ã‚ˆã†ãªãƒ•ã‚¡ã‚¤ãƒ«ãŒå‡ºåŠ›ã•ã‚Œã¾ã™ã€‚</p>\n<div class=\"gatsby-highlight\" data-language=\"html:svgãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸­èº«\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-html:svgãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸­èº« line-numbers\"><code class=\"language-html:svgãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸­èº«\">&lt;svg class=&quot;ui fluid image&quot; viewBox=&quot;0 0 1600 1000&quot; width=&quot;100%&quot; height=&quot;100%&quot;&gt;\n  &lt;g transform=&quot;translate(800,500)&quot;&gt;\n    &lt;text style=&quot;font-size: 466px; font-family: meiryo; fill: #1f77b4;&quot; transform=&quot;translate(48, 35)rotate(0)&quot; text-anchor=&quot;middle&quot;&gt;ã‚ã‚‹&lt;/text&gt;\n    &lt;text style=&quot;font-size: 269px; font-family: meiryo; fill: #ff7f0e;&quot; transform=&quot;translate(460, 15)rotate(90)&quot; text-anchor=&quot;middle&quot;&gt;ã‚ˆã†&lt;/text&gt;&lt;text style=&quot;font-size: 245px; font-family: meiryo; fill: #2ca02c;&quot; transform=&quot;translate(-263, -290)rotate(0)&quot; text-anchor=&quot;middle&quot;&gt;äº‘ã†&lt;/text&gt;\n    &lt;text style=&quot;font-size: 191px; font-family: meiryo; fill: #d62728;&quot; transform=&quot;translate(-265, 193)rotate(0)&quot; text-anchor=&quot;middle&quot;&gt;ãã‚Œ&lt;/text&gt;\n   ãƒ»\n   ãƒ»\n   ãƒ»\n  &lt;/g&gt;\n&lt;/svg&gt;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<br/>\n<p>æç”»ã™ã‚‹ã¨ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/5e4aed803fecc163a2ec605e3c7848a6/29007/wordcloud.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 63%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABcRAAAXEQHKJvM/AAACnUlEQVR42n2T7U/TUBjF/XP9aPxgNP4DJMYYlJj4xSiJYJCIgCyACBkZgW2srN1Kx9q16/qyDugrbVd2e3vMuiEixpucnHuTk999nif3PvB9n3cc59hxHMa2bca2Bsx47/h+7lHgM4HvMVe+xzi2w1xc2rnyzK2qruueVSqVZw8AgKYpHXvKsiB7u0g5Dmn5EBlJMYhSBAlFcJ0hIXns3sqyLB27JElzEyBNydiGmk692hEdNpq0Wdijqzt1+oW1aLXnUd70KddzaIE16KejLo2TvIgbjabA11Mgza/uD87RaTagnrWwfNjGo8UiXn2tQGcFqN4VzlQVbzdqmN2VkICg21NgGiY0TcsrVBTlzR2gG3qQ5DNctHl8r4p4usLkwOVCBT+6BhbqHTxZOMRSqYWNpg7N1GDoOvT7wMkMZb+Pc5tHtX2BuR0BD+dLcAUWG2UOa2UGH4oneLd1gpagYW79FFZXAORdpBluZjgBTmrMcOwFMJMIjGTiRaGBlZqIn5UWXq6XoXbfoy4fYGaFxfPFItYZC9Q4AS3OgNY+pkAISdHutiz0PAiDALFpIDB0BKYLuW1BbndQFArYldfB9DgsNlfRUXhcihwiq4TRxenfFYIOr0aorCno8RYaZQ09/hz8gQy9IUE2eGwK2zjqMSgbB1gU5rFVXoPbrCOOOxh1tlNgCElWboGjhCDwCJKBhkAUYTVsdFt9hO0BWIXHfv0bjtjPUE0Lx1oZQRKDDkRQcROUXUqReZBU/XfL1wBIrtAksC0SNm0Sqy5JRJeYtUuSqApJTZY4/ZggnWbHihyC6zAZc0SxPXtnhv/+BuNnm+F/685PSZKkGkXRfhRFpYnCiYfT8zAqRclw4lFYGg5vcn/mw/04jk84jnv8Cy/EsfT7rCouAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/5e4aed803fecc163a2ec605e3c7848a6/ba381/wordcloud.webp 200w,\n/static/5e4aed803fecc163a2ec605e3c7848a6/7f61c/wordcloud.webp 400w,\n/static/5e4aed803fecc163a2ec605e3c7848a6/d00b9/wordcloud.webp 800w,\n/static/5e4aed803fecc163a2ec605e3c7848a6/92f8c/wordcloud.webp 1200w,\n/static/5e4aed803fecc163a2ec605e3c7848a6/fad48/wordcloud.webp 1600w\"\n              sizes=\"(max-width: 800px) 100vw, 800px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/5e4aed803fecc163a2ec605e3c7848a6/772e8/wordcloud.png 200w,\n/static/5e4aed803fecc163a2ec605e3c7848a6/e17e5/wordcloud.png 400w,\n/static/5e4aed803fecc163a2ec605e3c7848a6/5a190/wordcloud.png 800w,\n/static/5e4aed803fecc163a2ec605e3c7848a6/c1b63/wordcloud.png 1200w,\n/static/5e4aed803fecc163a2ec605e3c7848a6/29007/wordcloud.png 1600w\"\n            sizes=\"(max-width: 800px) 100vw, 800px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/5e4aed803fecc163a2ec605e3c7848a6/5a190/wordcloud.png\"\n            alt=\"wordcloud\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h2 id=\"ã¾ã¨ã‚\" style=\"position:relative;\"><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\" aria-label=\"ã¾ã¨ã‚ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ã¾ã¨ã‚</h2>\n<p>Node.jsã§WordCloudã®SVGãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‡ºåŠ›ã™ã‚‹æ–¹æ³•ã«ã¤ã„ã¦ã”ç´¹ä»‹ã—ã¾ã—ãŸã€‚\nä»Šå›ã®å®Ÿè£…ã§ã€ãƒ–ãƒ©ã‚¦ã‚¶å‡¦ç†ã¯node-canvasã¨jsdomã‚’ä½¿ãˆã°Node.jsã§ã‚‚å†ç¾ã§ãã‚‹ã“ã¨ãŒã‚ã‹ã£ãŸã®ã§ã€ã„ã‚ã‚“ãªå ´é¢ã§å¿œç”¨ã§ããã†ã§ã™ã€‚\næ¬¡å›ã¯ã€ä»Šå›ã®å®Ÿè£…ã‚’ãƒ™ãƒ¼ã‚¹ã«ã—ã¦è‡ªåˆ†ã®ãƒ–ãƒ­ã‚°ã®WordCloudã‚’ç”Ÿæˆã—ã¦ã¿ã‚ˆã†ã¨æ€ã„ã¾ã™ğŸ…</p>","excerpt":"ãªã«ã“ã‚Œ å‰å›è¨˜äº‹ã§ã¯Reactã§WordCloudã‚’å‡ºåŠ›ã—ã¾ã—ãŸã€‚ã—ã‹ã—å®Ÿéš›ã¯ã€éå»å¤§é‡ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰å‡ºåŠ›ã™ã‚‹ã‚ˆã†ãªãƒ„ãƒ¼ãƒ«ã¨ã—ã¦ä½¿ãˆãŸã»ã†ãŒä¾¿åˆ©ã§ã™ã€‚\nãã“ã§å‰å›ã®ã‚µãƒ³ãƒ—ãƒ«ã‚’ãƒ™ãƒ¼ã‚¹ã«Node.jsã§WordCloudã®SVGâ€¦","frontmatter":{"slug":"/wordcloud-with-kuromoji-d3cloud-nodejs","title":"Node.js + kuromoji.js + D3-Cloudã§WordCloudã®ç”»åƒã‚’å‡ºåŠ›","date":"2019-05-04T18:00:00.000+09:00","tags":["Node.js","kuromoji.js","d3.js","d3Cloud","ãƒ‡ãƒ¼ã‚¿å¯è¦–åŒ–","å½¢æ…‹ç´ è§£æ","WordCloud"],"keywords":["WordCloud"],"thumbnail":"thumbnail/2019/05/wordcloud-with-kuromoji-d3cloud-nodejs.png","category":null}}],"tag":"Node.js","tagCounts":[{"text":"Gatsby","size":26},{"text":"ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰","size":11},{"text":"AutoHotkey","size":10},{"text":"ä½œæ¥­åŠ¹ç‡åŒ–","size":10},{"text":"React","size":8},{"text":"Vue.js","size":8},{"text":"GraphQL","size":6},{"text":"AWS","size":5},{"text":"AppSync","size":5},{"text":"Vuetify","size":5},{"text":"GatsbyPlugin","size":4},{"text":"Netlify","size":3},{"text":"VueI18n","size":3},{"text":"WordCloud","size":3},{"text":"d3.js","size":3},{"text":"d3Cloud","size":3},{"text":"kuromoji.js","size":3},{"text":"mdx-deck","size":3},{"text":"ãƒ‡ãƒ¼ã‚¿å¯è¦–åŒ–","size":3},{"text":"å‹‰å¼·ä¼š","size":3},{"text":"å½¢æ…‹ç´ è§£æ","size":3},{"text":"Apollo Client","size":2},{"text":"Cognito","size":2},{"text":"CrossPlatform","size":2},{"text":"LT","size":2},{"text":"Mobile","size":2},{"text":"Node.js","size":2},{"text":"Nuxt.js","size":2},{"text":"ReactNative","size":2},{"text":"SNS","size":2},{"text":"SRE","size":2},{"text":"VeeValidate","size":2},{"text":"code-surfer","size":2},{"text":"gatsby-image","size":2},{"text":"markdown","size":2},{"text":"mdx","size":2},{"text":"ã‚¹ãƒ©ã‚¤ãƒ‰","size":2},{"text":"ãƒ–ãƒ­ã‚°","size":2},{"text":"ãƒ—ãƒ¬ã‚¼ãƒ³","size":2},{"text":"èª­æ›¸æ„Ÿæƒ³","size":2},{"text":"Amplify","size":1},{"text":"Axios","size":1},{"text":"CSS","size":1},{"text":"CSSModules","size":1},{"text":"CircleCI","size":1},{"text":"Connpass","size":1},{"text":"Cytoscape.js","size":1},{"text":"DynamoDB","size":1},{"text":"Flutter","size":1},{"text":"Fromik","size":1},{"text":"Gatsby theme","size":1},{"text":"Git","size":1},{"text":"GitHub","size":1},{"text":"Github-Pages","size":1},{"text":"Graphpack","size":1},{"text":"HttpsåŒ–","size":1},{"text":"Hugo","size":1},{"text":"Iframely","size":1},{"text":"Ionic","size":1},{"text":"JJUG CCC","size":1},{"text":"JSON-LD","size":1},{"text":"Java","size":1},{"text":"JavaScript","size":1},{"text":"Kotlin","size":1},{"text":"NetlifyForms","size":1},{"text":"OGP","size":1},{"text":"PWA","size":1},{"text":"RSS","size":1},{"text":"SER","size":1},{"text":"Schema-org","size":1},{"text":"Vim","size":1},{"text":"Vimium","size":1},{"text":"Vuex","size":1},{"text":"Windows","size":1},{"text":"Zapier","size":1},{"text":"clip-path","size":1},{"text":"gatsby-image-sharp","size":1},{"text":"gatsby-plugin-feed","size":1},{"text":"gatsy-image","size":1},{"text":"golang","size":1},{"text":"oEmbed","size":1},{"text":"rehype","size":1},{"text":"remark","size":1},{"text":"serverless","size":1},{"text":"typescript","size":1},{"text":"unified","size":1},{"text":"ã‚¤ãƒ™ãƒ³ãƒˆãƒ¬ãƒãƒ¼ãƒˆ","size":1},{"text":"ã‚«ã‚¹ã‚¿ãƒ ãƒ‰ãƒ¡ã‚¤ãƒ³","size":1},{"text":"ãƒ‡ãƒ¥ã‚¢ãƒ«ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰","size":1},{"text":"ãƒ‘ã‚½ã‚³ãƒ³","size":1},{"text":"ãƒ©ãƒ³ãƒãƒ£ãƒ¼","size":1},{"text":"åŸ‹ã‚è¾¼ã¿ã‚³ãƒ¼ãƒ‰","size":1},{"text":"è‚©ã“ã‚Š","size":1}]}},"staticQueryHashes":["3868140423","4185443638","467257065"],"slicesMap":{}}