{"componentChunkName":"component---src-templates-tags-template-tsx","path":"/tags/css-modules/","result":{"pageContext":{"nodes":[{"html":"<h2 id=\"なにこれ\" style=\"position:relative;\"><a href=\"#%E3%81%AA%E3%81%AB%E3%81%93%E3%82%8C\" aria-label=\"なにこれ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>なにこれ</h2>\n<p><a href=\"https://www.gatsbyjs.org/\">Gatsby</a>でブログを作っていて、機能拡張とともにテンプレートが肥大化してきたので、下記図の青枠単位でコンポーネント分割しました。\nあわせてCSS Moduleも採用しました。そのときのメモです。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/647324ff6c538d8dafb2c5363a8cad81/76823/page.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 95%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAAAsTAAALEwEAmpwYAAAEN0lEQVR42nXR+08UVxjG8f3nTGwaW6+ptY2NrZpSbWRTK7RWm9hWsVwEXVg0Sr3AKkgVw8UbskAXCpbhsotigNIqKygMyO7cZ84532a32BptT/LmnXd++MzzngldWns+1bXu1Mrt9dWL3Zsr9etbjuvX3/tBv7e9VL+1o1xv/rhSv10Q0Tv3VeudX0T0zq8i+r1D1XrXkWo9XhLR4+URPX4ystAdjVj1ZfW9oZ41J9JsLMTfUKgerf+OK+uOceGdEuo3lNCx9Vumdu/E3b8PvgmjjoShJAwVYaguhHNhuBSGpkLJnS/piVQlQ3fPTc2OXHzIeCwlI98/VuHP0mrvvkW1Z++cOrT/iWosGVf1x1Kq/nhK1f+YUg3lSRWrTKlYVUo1nEqpWHVSxaJJcbVuitqa6bGQQKRnMxAfR13rlUzPmcwtu2Rc0G14asC8CfMGPDPhzyWouQ6T84q5LDxdgdll5JILrQmZDIGfnvwDxlK6utIRYNg22cwyRmYZ37MIPAvLNjFMA9+3MU2by+0eRjYLwgGCXEmAXk3kQJGenoWJqRV19Y7AdR2y2SyGYWDbOcDCcgMMR+AEkozhE+uQrGQchAgQQiKkXAXl3+DkE5h+bKnGmz6LC8+ZnU2TTqcRQvDyqNXuetDQLljJWPm3Sink6+DULIxPrqimWwLHya1oYZoGlmXlU/q+jx8EBIFP1vRpaA94kbHwXCf/0TfAyccwOZNRTbcFppHFtB1s18dyPIIgyKfglYSxjlxCO7/yfybM3WFiWKrmTrAdm4Wsh+krfAkvrZfdyYOSFxkbz/NW75B/QSlEOjcsr6Dup8CxTRzPxBdu/g8q5SOVQORFD8f1iHWA5/PqyYM9QzIZEqtgLsRAEhIjiqEHksExwWBSMpiS9I0pEqOKgWRAYlhwsRVS0zAxAw9n4MHvyJl5uJl4Dfx1DLoGoX9EkRjmn8rNfcOK/lGI34f+UUXWhOUMvMjmu3QDMK3XwJGH4JgmgbsManUn38c1dHw3kxvwHIfUhEDx5spSvgEqHDNAeLkSKCHBc3GMDJ6ZBenhmD5jE/L/wcVnTlpfUCwtuOqXAY873R7dfR7xhEt7j6A5Di3dcC1O/vlGl6B/yENf8ni+4LGw6PF80ZWGBbruJENNmy4+GdxQzv0tZcHQtjIx8EGZGPioTAx+UiYqtzWJiu0RcXLXBVH36VlxvuC8iO65IrSj5WKkrFSMVJWK0ZpSMXq21J+InaD5VMNIqO/dmjRbv4b3i5T6sBh2FMOuYigoYmJXBdruowyHS5k5UMp0cQXTh8tRVUVQWwx1xdBQBM0HJHcP0huNJkOX19bd/HnN6bEba2uHWt46rbW8HdVa1kW1lvVRrWVTjXZh42mtfnO11rztjNa4/YzWurNGayuIaq2fR7W2cFRr2x/V2g5Gf2s7XPug4dBPjX8B4hcgfHQU8pAAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/647324ff6c538d8dafb2c5363a8cad81/ba381/page.webp 200w,\n/static/647324ff6c538d8dafb2c5363a8cad81/7f61c/page.webp 400w,\n/static/647324ff6c538d8dafb2c5363a8cad81/d00b9/page.webp 800w,\n/static/647324ff6c538d8dafb2c5363a8cad81/6a022/page.webp 1038w\"\n              sizes=\"(max-width: 800px) 100vw, 800px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/647324ff6c538d8dafb2c5363a8cad81/772e8/page.png 200w,\n/static/647324ff6c538d8dafb2c5363a8cad81/e17e5/page.png 400w,\n/static/647324ff6c538d8dafb2c5363a8cad81/5a190/page.png 800w,\n/static/647324ff6c538d8dafb2c5363a8cad81/76823/page.png 1038w\"\n            sizes=\"(max-width: 800px) 100vw, 800px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/647324ff6c538d8dafb2c5363a8cad81/5a190/page.png\"\n            alt=\"分割した結果\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h2 id=\"cssをコンポーネントスコープにする方法\" style=\"position:relative;\"><a href=\"#css%E3%82%92%E3%82%B3%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%8D%E3%83%B3%E3%83%88%E3%82%B9%E3%82%B3%E3%83%BC%E3%83%97%E3%81%AB%E3%81%99%E3%82%8B%E6%96%B9%E6%B3%95\" aria-label=\"cssをコンポーネントスコープにする方法 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>CSSをコンポーネントスコープにする方法</h2>\n<p>コンポーネントを分割する際、CSSもあわせて分割が必要です。その場合、グローバルスコープだとスタイルがコンポーネントに限定されなくなってしまうので、コンポーネントスコープにする必要があります。Gatsbyはコンポーネントスコープの実現方法が3つ用意されています。</p>\n<ul>\n<li><a href=\"https://www.gatsbyjs.org/docs/css-modules/\">CSS Modules</a></li>\n<li><a href=\"https://www.gatsbyjs.org/docs/glamor/\">Using CSS-in-JS library Glamor</a></li>\n<li><a href=\"https://www.gatsbyjs.org/docs/styled-components/\">Using CSS-in-JS library styled components</a></li>\n</ul>\n<p>僕はスタイルをHTMLやJSの中に書くのを躊躇してしまう人（古い時代の人）なので、スタイルをCSSファイルに書けるCSS Moduleを採用しました。\n流行はStyled Componentsなんでしょうか?</p>\n<h3 id=\"css-module\" style=\"position:relative;\"><a href=\"#css-module\" aria-label=\"css module permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>CSS Module</h3>\n<p>CSSファイルのクラス名、アニメーション名をローカルスコープで使えるようにする仕組みです。\nCSSファイルは通常のCSSと同じ文法で書くことができて、ICSSまたはInteroperable CSSと呼ばれる形式にコンパイルすることでローカルスコープを実現します。\nJavaScriptファイルでCSS Moduleを使う場合、ローカル変数名をつけてインポートし、DOMのクラス名には<code class=\"language-text\">変数名.クラス名</code>のように指定します。</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">import</span> styles <span class=\"token keyword\">from</span> <span class=\"token string\">\"./style.css\"</span><span class=\"token punctuation\">;</span>\n\nelement<span class=\"token punctuation\">.</span>innerHTML <span class=\"token operator\">=</span> <span class=\"token string\">'&lt;div class=\"'</span> <span class=\"token operator\">+</span> styles<span class=\"token punctuation\">.</span>className <span class=\"token operator\">+</span> <span class=\"token string\">'\">'</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>参考：<a href=\"https://github.com/css-modules/css-modules\">公式ページ</a></p>\n<h3 id=\"gatsbyでcss-module\" style=\"position:relative;\"><a href=\"#gatsby%E3%81%A7css-module\" aria-label=\"gatsbyでcss module permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>GatsbyでCSS Module</h3>\n<p>CSSファイル名を<code class=\"language-text\">XXX.module.css</code>のようにしてコンポーネントでインポートするだけでCSS Moduleが使えます。<br />\n<br /></p>\n<p>例えば下記のようなCSSがあるとしたら</p>\n<div class=\"gatsby-code-title\">src/components/container.module.css</div>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-css line-numbers\"><code class=\"language-css\"><span class=\"token selector\">.container</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">margin</span><span class=\"token punctuation\">:</span> 3rem auto<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">max-width</span><span class=\"token punctuation\">:</span> 600px<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<br>\n<p>JavaScriptでこのように読み込みます。</p>\n<div class=\"gatsby-code-title\">src/components/container.js</div>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">import</span> styles <span class=\"token keyword\">from</span> <span class=\"token string\">\"./container.module.css\"</span></span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> children <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token operator\">&lt;</span>div className<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>styles<span class=\"token punctuation\">.</span>container<span class=\"token punctuation\">}</span><span class=\"token operator\">></span><span class=\"token punctuation\">{</span>children<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span></span><span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id=\"コンポーネント分割\" style=\"position:relative;\"><a href=\"#%E3%82%B3%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%8D%E3%83%B3%E3%83%88%E5%88%86%E5%89%B2\" aria-label=\"コンポーネント分割 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>コンポーネント分割</h2>\n<p>CSSがコンポーネントスコープにできたところで、ようやくコンポーネントを分割できるようになります。\n純粋にReactの作法に従って分割します(Gatsbyは特に関係ありません)。<br>\nここでは、テンプレートから記事部分を分割するケースについて説明しましょう。<br></p>\n<p><strong>テンプレート(分割前)</strong></p>\n<div class=\"gatsby-code-title\">src/templates/blog-post.js</div>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> styles <span class=\"token keyword\">from</span> <span class=\"token string\">'blog-post.module.css'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">BlogPostTemplate</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> post <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>markdownRemark\n\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token operator\">&lt;</span>Layout<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>h1 className<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>styles<span class=\"token punctuation\">.</span>blogTitle<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>Takumon Blog<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h1<span class=\"token operator\">></span>\n<span class=\"gatsby-highlight-code-line\">        <span class=\"token operator\">&lt;</span>article<span class=\"token operator\">></span></span><span class=\"gatsby-highlight-code-line\">          <span class=\"token operator\">&lt;</span>h1 className<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>styles<span class=\"token punctuation\">.</span>postTitle<span class=\"token punctuation\">}</span><span class=\"token operator\">></span><span class=\"token punctuation\">{</span>post<span class=\"token punctuation\">.</span>frontmatter<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h1<span class=\"token operator\">></span></span><span class=\"gatsby-highlight-code-line\">          <span class=\"token operator\">&lt;</span>div className<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>styles<span class=\"token punctuation\">.</span>postContent<span class=\"token punctuation\">}</span> dangerouslySetInnerHTML<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">__html</span><span class=\"token operator\">:</span> post<span class=\"token punctuation\">.</span>html <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span></span><span class=\"gatsby-highlight-code-line\">        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>article<span class=\"token operator\">></span></span>      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Layout<span class=\"token operator\">></span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> BlogPostTemplate\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> pageQuery <span class=\"token operator\">=</span> graphql<span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\"></span>\n<span class=\"token string\">  query($slug: String!) {</span>\n<span class=\"token string\">    markdownRemark(fields: { slug: { eq: $slug } }) {</span>\n<span class=\"token string\">      html</span>\n<span class=\"token string\">      frontmatter {</span>\n<span class=\"token string\">        title</span>\n<span class=\"token string\">      }</span>\n<span class=\"token string\">    }</span>\n<span class=\"token string\">  }</span>\n<span class=\"token string\"></span><span class=\"token template-punctuation string\">`</span></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div class=\"gatsby-code-title\">src/templates/blog-post.module.css</div>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token punctuation\">.</span>blogTitle <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">color</span><span class=\"token operator\">:</span> red\n<span class=\"token punctuation\">}</span>\n\n<span class=\"gatsby-highlight-code-line\"><span class=\"token punctuation\">.</span>postTitle <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token literal-property property\">color</span><span class=\"token operator\">:</span> blue<span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token punctuation\">}</span></span><span class=\"gatsby-highlight-code-line\"></span><span class=\"gatsby-highlight-code-line\"><span class=\"token punctuation\">.</span>postContent <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token literal-property property\">color</span><span class=\"token operator\">:</span> green<span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token punctuation\">}</span></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<hr>\n<p>分割後は下記のようになります。\nなお分割したコンポーネントに記事情報を渡すための属性を定義します。ここではpostという属性名にしています。<br>\nテンプレートにて記事コンポーネントのpost属性に記事情報を指定すると、\n記事コンポーネントでは<code class=\"language-text\">this.props.post</code>で受け取れるようになります。</p>\n<p><strong>テンプレート(分割後)</strong></p>\n<div class=\"gatsby-code-title\">src/templates/blog-post.js</div>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> styles <span class=\"token keyword\">from</span> <span class=\"token string\">'blog-post.module.css'</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">import</span> Post <span class=\"token keyword\">from</span> <span class=\"token string\">'../components/post'</span><span class=\"token punctuation\">;</span></span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">BlogPostTemplate</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> post <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>markdownRemark\n\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token operator\">&lt;</span>Layout<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>h1 className<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>styles<span class=\"token punctuation\">.</span>blogTitle<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>Takumon Blog<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h1<span class=\"token operator\">></span>\n<span class=\"gatsby-highlight-code-line\">        <span class=\"token operator\">&lt;</span>Post post<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>post<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span></span>      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Layout<span class=\"token operator\">></span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> BlogPostTemplate\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> pageQuery <span class=\"token operator\">=</span> graphql<span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\"></span>\n<span class=\"token string\">  query($slug: String!) {</span>\n<span class=\"token string\">    markdownRemark(fields: { slug: { eq: $slug } }) {</span>\n<span class=\"token string\">      html</span>\n<span class=\"token string\">      frontmatter {</span>\n<span class=\"token string\">        title</span>\n<span class=\"token string\">      }</span>\n<span class=\"token string\">    }</span>\n<span class=\"token string\">  }</span>\n<span class=\"token string\"></span><span class=\"token template-punctuation string\">`</span></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div class=\"gatsby-code-title\">src/templates/blog-post.module.css</div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token punctuation\">.</span>blogTitle <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">color</span><span class=\"token operator\">:</span> red\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<br>\n<p><strong>記事コンポーネント</strong></p>\n<div class=\"gatsby-code-title\">src/components/post.js</div>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">import</span> styles <span class=\"token keyword\">from</span> <span class=\"token string\">'post.module.css'</span><span class=\"token punctuation\">;</span></span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Post</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">const</span> post <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>post<span class=\"token punctuation\">;</span></span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token operator\">&lt;</span>article<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>h1 className<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>styles<span class=\"token punctuation\">.</span>postTitle<span class=\"token punctuation\">}</span><span class=\"token operator\">></span><span class=\"token punctuation\">{</span>post<span class=\"token punctuation\">.</span>frontmatter<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h1<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>div className<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>styles<span class=\"token punctuation\">.</span>postContent<span class=\"token punctuation\">}</span> dangerouslySetInnerHTML<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">__html</span><span class=\"token operator\">:</span> post<span class=\"token punctuation\">.</span>html <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>article<span class=\"token operator\">></span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> Post</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div class=\"gatsby-code-title\">src/components/post.module.css</div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token punctuation\">.</span>postTitle <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">color</span><span class=\"token operator\">:</span> blue<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">.</span>postContent <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">color</span><span class=\"token operator\">:</span> green<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<hr>\n<p>なお分割したことにより<code class=\"language-text\">src/components/post.module.css</code>が「記事に対するスタイル」ということは自明になるので、クラス名をより簡潔にできます。</p>\n<p><strong>記事コンポーネント(CSSリファクタリング後)</strong></p>\n<div class=\"gatsby-code-title\">src/components/post.js</div>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> styles <span class=\"token keyword\">from</span> <span class=\"token string\">'post.module.css'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Post</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> post <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>post<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token operator\">&lt;</span>article<span class=\"token operator\">></span>\n<span class=\"gatsby-highlight-code-line\">        <span class=\"token operator\">&lt;</span>h1 className<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>styles<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">}</span><span class=\"token operator\">></span><span class=\"token punctuation\">{</span>post<span class=\"token punctuation\">.</span>frontmatter<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h1<span class=\"token operator\">></span></span><span class=\"gatsby-highlight-code-line\">        <span class=\"token operator\">&lt;</span>div className<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>styles<span class=\"token punctuation\">.</span>content<span class=\"token punctuation\">}</span> dangerouslySetInnerHTML<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">__html</span><span class=\"token operator\">:</span> post<span class=\"token punctuation\">.</span>html <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span></span>      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>article<span class=\"token operator\">></span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> Post</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div class=\"gatsby-code-title\">src/components/post.module.css</div>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"gatsby-highlight-code-line\"><span class=\"token punctuation\">.</span>title <span class=\"token punctuation\">{</span></span>  <span class=\"token literal-property property\">color</span><span class=\"token operator\">:</span> blue<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"gatsby-highlight-code-line\"><span class=\"token punctuation\">.</span>content <span class=\"token punctuation\">{</span></span>  <span class=\"token literal-property property\">color</span><span class=\"token operator\">:</span> green<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>以上の手順を繰り返すことで、コンポーネントを細かく分割できます。</p>\n<h2 id=\"まとめ\" style=\"position:relative;\"><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\" aria-label=\"まとめ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>まとめ</h2>\n<p>コンポーネントを細かく分割することで、再利用性が向上し、画面レイアウトを組みやすくなりました。\nReactのWebアプリケーションの場合は、Reduxのステート用コールバック関数の受け渡しなどで複雑になりますが、\nGatsbyのような静的Webサイトの場合、単純な分割だけで事足りるかなーと。\n分割設計については<a href=\"https://www.amazon.co.jp/Atomic-Design-%E5%A0%85%E7%89%A2%E3%81%A7%E4%BD%BF%E3%81%84%E3%82%84%E3%81%99%E3%81%84UI%E3%82%92%E5%8A%B9%E7%8E%87%E8%89%AF%E3%81%8F%E8%A8%AD%E8%A8%88%E3%81%99%E3%82%8B-%E4%BA%94%E8%97%A4-%E4%BD%91%E5%85%B8/dp/477419705X\">Atomic Design ~堅牢で使いやすいUIを効率良く設計する</a>を参考にしたいところです。まだ読んでない...🍅</p>","excerpt":"なにこれ Gatsbyでブログを作っていて、機能拡張とともにテンプレートが肥大化してきたので、下記図の青枠単位でコンポーネント分割しました。\nあわせてCSS Moduleも採用しました。そのときのメモです。  CSS…","frontmatter":{"slug":"/2018/10/14/","title":"Gatsbyにおけるコンポーネント分割とCSS Module","date":"2018-10-14T07:00:00.000Z","tags":["Gatsby","React","CSSModules"],"keywords":["Gatsby"],"thumbnail":"thumbnail/2018/gatsby-css-modules.png","category":null}}],"tag":"CSSModules","tagCounts":[{"text":"Gatsby","size":26},{"text":"React","size":8},{"text":"Vue.js","size":8},{"text":"GraphQL","size":6},{"text":"AWS","size":5},{"text":"AppSync","size":5},{"text":"Vuetify","size":5},{"text":"GatsbyPlugin","size":4},{"text":"Netlify","size":3},{"text":"VueI18n","size":3},{"text":"WordCloud","size":3},{"text":"d3.js","size":3},{"text":"d3Cloud","size":3},{"text":"kuromoji.js","size":3},{"text":"mdx-deck","size":3},{"text":"キーボード","size":3},{"text":"データ可視化","size":3},{"text":"勉強会","size":3},{"text":"形態素解析","size":3},{"text":"Apollo Client","size":2},{"text":"AutoHotkey","size":2},{"text":"Cognito","size":2},{"text":"CrossPlatform","size":2},{"text":"LT","size":2},{"text":"Mobile","size":2},{"text":"Node.js","size":2},{"text":"Nuxt.js","size":2},{"text":"ReactNative","size":2},{"text":"SNS","size":2},{"text":"SRE","size":2},{"text":"VeeValidate","size":2},{"text":"code-surfer","size":2},{"text":"gatsby-image","size":2},{"text":"markdown","size":2},{"text":"mdx","size":2},{"text":"スライド","size":2},{"text":"ブログ","size":2},{"text":"プレゼン","size":2},{"text":"作業効率化","size":2},{"text":"読書感想","size":2},{"text":"Amplify","size":1},{"text":"Axios","size":1},{"text":"CSS","size":1},{"text":"CSSModules","size":1},{"text":"CircleCI","size":1},{"text":"Connpass","size":1},{"text":"Cytoscape.js","size":1},{"text":"DynamoDB","size":1},{"text":"Flutter","size":1},{"text":"Fromik","size":1},{"text":"Gatsby theme","size":1},{"text":"Git","size":1},{"text":"GitHub","size":1},{"text":"Github-Pages","size":1},{"text":"Graphpack","size":1},{"text":"Https化","size":1},{"text":"Hugo","size":1},{"text":"Iframely","size":1},{"text":"Ionic","size":1},{"text":"JJUG CCC","size":1},{"text":"JSON-LD","size":1},{"text":"Java","size":1},{"text":"JavaScript","size":1},{"text":"Kotlin","size":1},{"text":"NetlifyForms","size":1},{"text":"OGP","size":1},{"text":"PWA","size":1},{"text":"RPG","size":1},{"text":"RSS","size":1},{"text":"SER","size":1},{"text":"Schema-org","size":1},{"text":"Vim","size":1},{"text":"Vimium","size":1},{"text":"Vuex","size":1},{"text":"Windows","size":1},{"text":"Zapier","size":1},{"text":"clip-path","size":1},{"text":"gatsby-image-sharp","size":1},{"text":"gatsby-plugin-feed","size":1},{"text":"gatsy-image","size":1},{"text":"golang","size":1},{"text":"oEmbed","size":1},{"text":"rehype","size":1},{"text":"remark","size":1},{"text":"serverless","size":1},{"text":"typescript","size":1},{"text":"unified","size":1},{"text":"イベントレポート","size":1},{"text":"カスタムドメイン","size":1},{"text":"デュアルキーボード","size":1},{"text":"パソコン","size":1},{"text":"ランチャー","size":1},{"text":"リンク集","size":1},{"text":"埋め込みコード","size":1},{"text":"肩こり","size":1}]}},"staticQueryHashes":["3868140423","4185443638","467257065"],"slicesMap":{}}