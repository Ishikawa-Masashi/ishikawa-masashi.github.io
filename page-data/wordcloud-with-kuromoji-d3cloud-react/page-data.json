{"componentChunkName":"component---src-templates-blog-post-template-tsx","path":"/wordcloud-with-kuromoji-d3cloud-react/","result":{"data":{"post":{"html":"<h2 id=\"なにこれ\" style=\"position:relative;\"><a href=\"#%E3%81%AA%E3%81%AB%E3%81%93%E3%82%8C\" aria-label=\"なにこれ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>なにこれ</h2>\n<p>WordCloudをJSだけで生成したい。Pythonとか使わずにフロントエンドだけでやりたい。というモチベーションで、\n<a href=\"https://github.com/takuyaa/kuromoji.js/\">kuromoji.js</a>と<a href=\"https://github.com/jasondavies/d3-cloud\">D3-Cloud</a>を使って文字列をインプットにWordCloudを描画するReactアプリを作ってみました。今回はそのやり方についてご紹介します。</p>\n<p>※サンプルコードは以下に置いております。\n<a href=\"https://github.com/Takumon/playbox2019/blob/master/react-kuromoji-sample/src/App.js\">https://github.com/Takumon/playbox2019/blob/master/react-kuromoji-sample/src/App.js</a></p>\n<h2 id=\"wordcloudの作り方原理\" style=\"position:relative;\"><a href=\"#wordcloud%E3%81%AE%E4%BD%9C%E3%82%8A%E6%96%B9%E5%8E%9F%E7%90%86\" aria-label=\"wordcloudの作り方原理 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>WordCloudの作り方（原理）</h2>\n<p>WordCloudは文章をインプットにして画像をアウトプットします。\nその過程は2つに分かれます。</p>\n<h3 id=\"1-文章を解析して単語出現回数をデータ化\" style=\"position:relative;\"><a href=\"#1-%E6%96%87%E7%AB%A0%E3%82%92%E8%A7%A3%E6%9E%90%E3%81%97%E3%81%A6%E5%8D%98%E8%AA%9E%E5%87%BA%E7%8F%BE%E5%9B%9E%E6%95%B0%E3%82%92%E3%83%87%E3%83%BC%E3%82%BF%E5%8C%96\" aria-label=\"1 文章を解析して単語出現回数をデータ化 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. 文章を解析して単語出現回数をデータ化</h3>\n<div class=\"gatsby-code-title\">たとえばこんな文章を...</div>\n<div class=\"gatsby-highlight\" data-language=\"txt\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-txt line-numbers\"><code class=\"language-txt\">そこも場合もうその病気らに対して旨の時がしんませ。単に事実に使用方はどうかその応用たないでもが思いてならないがも発展思いうべきて、あいにくにもなるだなですた。\n差が向いんものは何だか翌日からしきりにんなけれう。もちろんネルソンさんで養成道具一応束縛に致しませ示威この力誰か講演をというご妨害ないますですうば、\n...</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>↓↓</p>\n<div class=\"gatsby-code-title\">単語と出現回数のデータに加工します</div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">text</span><span class=\"token operator\">:</span> <span class=\"token string\">\"そこ\"</span><span class=\"token punctuation\">,</span>    <span class=\"token literal-property property\">value</span><span class=\"token operator\">:</span> <span class=\"token number\">14</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">text</span><span class=\"token operator\">:</span> <span class=\"token string\">\"場合\"</span><span class=\"token punctuation\">,</span>    <span class=\"token literal-property property\">value</span><span class=\"token operator\">:</span> <span class=\"token number\">11</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">text</span><span class=\"token operator\">:</span> <span class=\"token string\">\"うそ\"</span><span class=\"token punctuation\">,</span>    <span class=\"token literal-property property\">value</span><span class=\"token operator\">:</span> <span class=\"token number\">2</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">text</span><span class=\"token operator\">:</span> <span class=\"token string\">\"病気\"</span><span class=\"token punctuation\">,</span>    <span class=\"token literal-property property\">value</span><span class=\"token operator\">:</span> <span class=\"token number\">8</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">text</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ら\"</span><span class=\"token punctuation\">,</span>      <span class=\"token literal-property property\">value</span><span class=\"token operator\">:</span> <span class=\"token number\">17</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">text</span><span class=\"token operator\">:</span> <span class=\"token string\">\"旨\"</span><span class=\"token punctuation\">,</span>      <span class=\"token literal-property property\">value</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">text</span><span class=\"token operator\">:</span> <span class=\"token string\">\"時\"</span><span class=\"token punctuation\">,</span>      <span class=\"token literal-property property\">value</span><span class=\"token operator\">:</span> <span class=\"token number\">43</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">text</span><span class=\"token operator\">:</span> <span class=\"token string\">\"しん\"</span><span class=\"token punctuation\">,</span>    <span class=\"token literal-property property\">value</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">text</span><span class=\"token operator\">:</span> <span class=\"token string\">\"事実\"</span><span class=\"token punctuation\">,</span>    <span class=\"token literal-property property\">value</span><span class=\"token operator\">:</span> <span class=\"token number\">10</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">text</span><span class=\"token operator\">:</span> <span class=\"token string\">\"使用\"</span><span class=\"token punctuation\">,</span>    <span class=\"token literal-property property\">value</span><span class=\"token operator\">:</span> <span class=\"token number\">6</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">text</span><span class=\"token operator\">:</span> <span class=\"token string\">\"方\"</span><span class=\"token punctuation\">,</span>      <span class=\"token literal-property property\">value</span><span class=\"token operator\">:</span> <span class=\"token number\">41</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">text</span><span class=\"token operator\">:</span> <span class=\"token string\">\"応用\"</span><span class=\"token punctuation\">,</span>    <span class=\"token literal-property property\">value</span><span class=\"token operator\">:</span> <span class=\"token number\">3</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">text</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ない\"</span><span class=\"token punctuation\">,</span>    <span class=\"token literal-property property\">value</span><span class=\"token operator\">:</span> <span class=\"token number\">175</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">text</span><span class=\"token operator\">:</span> <span class=\"token string\">\"思う\"</span><span class=\"token punctuation\">,</span>    <span class=\"token literal-property property\">value</span><span class=\"token operator\">:</span> <span class=\"token number\">39</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">text</span><span class=\"token operator\">:</span> <span class=\"token string\">\"なる\"</span><span class=\"token punctuation\">,</span>    <span class=\"token literal-property property\">value</span><span class=\"token operator\">:</span> <span class=\"token number\">99</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">text</span><span class=\"token operator\">:</span> <span class=\"token string\">\"発展\"</span><span class=\"token punctuation\">,</span>    <span class=\"token literal-property property\">value</span><span class=\"token operator\">:</span> <span class=\"token number\">13</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">text</span><span class=\"token operator\">:</span> <span class=\"token string\">\"思い\"</span><span class=\"token punctuation\">,</span>    <span class=\"token literal-property property\">value</span><span class=\"token operator\">:</span> <span class=\"token number\">5</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">text</span><span class=\"token operator\">:</span> <span class=\"token string\">\"くる\"</span><span class=\"token punctuation\">,</span>    <span class=\"token literal-property property\">value</span><span class=\"token operator\">:</span> <span class=\"token number\">8</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">text</span><span class=\"token operator\">:</span> <span class=\"token string\">\"差\"</span><span class=\"token punctuation\">,</span>      <span class=\"token literal-property property\">value</span><span class=\"token operator\">:</span> <span class=\"token number\">4</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">text</span><span class=\"token operator\">:</span> <span class=\"token string\">\"向く\"</span><span class=\"token punctuation\">,</span>    <span class=\"token literal-property property\">value</span><span class=\"token operator\">:</span> <span class=\"token number\">6</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n<span class=\"token punctuation\">]</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id=\"2-データをもとにイイ感じの画像出力\" style=\"position:relative;\"><a href=\"#2-%E3%83%87%E3%83%BC%E3%82%BF%E3%82%92%E3%82%82%E3%81%A8%E3%81%AB%E3%82%A4%E3%82%A4%E6%84%9F%E3%81%98%E3%81%AE%E7%94%BB%E5%83%8F%E5%87%BA%E5%8A%9B\" aria-label=\"2 データをもとにイイ感じの画像出力 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. データをもとにイイ感じの画像出力</h3>\n<p>単語と出現回数の他に、以下の値を何らかの形で決定します。</p>\n<ul>\n<li>フォントの大きさ</li>\n<li>フォントの回転位置</li>\n<li>フォントの種類</li>\n<li>フォントの色</li>\n<li>表示位置</li>\n</ul>\n<p>大体のWordCloud系ライブラリは出現回数が多い単語を大きく中心に配置し、\nその周りに敷き詰めるように他の単語を配置します。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/76191097103de55829c825fc63f9828a/748b0/wordcloud-sample.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 86%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAENElEQVR42kWS624aZwJAedl9kNXuj0p7UdTLrrorbXerNm0um5hkEjtxHGzHEAzmAzw2twGGuQ9zgYEBhst8PlXVH32BI52jU1DV1lcj3epNG29v1lf/FaPRG2G4FRHexWI28sSbW0s8/dQVP37qCuvOEd26JxqfHRENZ8Ib+0KLI9Hzw5uWF/QajcajgmHqypyULNZy4j6rrEW+6ZH5GotsTa07oTxZUjXWZMuQ3OySGWOw75GLDHu+5zjd5G+2MHKcYkGf6K8yEppmtH/d8uV0tpBc/0duP34hN+0nkvI3cq9dyMDey4XWlQf9WnL1SB4u/yYtN5XGXSjb6/W+lO4xbPtlYawbSnIAMZnl35fHdMIMaV3Dsz+QGg6Zcc9D8xlTD9Ig4VD7gYf3f+bQVfA0nZu7iNNZkncOoFtWsaCPB8phmzL3zTx0l0zjDXz8E/LiW1YRyPsy2/4R8zSA1lMeescs5zEbZ8ju7d8piYB/RfP8+WLHyLSKhYFhKqx06Cr5pjlD2iYPNz8ga09YBrBVzzlUvmQXD8CoQflrHkp/Zd8scij/D7Nj0Rkbubt/wHLdYsG2HQVW5EGUr7SE7Sjl4CRgtgmGDk+vNaR2xso3WfgWmVCQv2qrL5m/KpKefsB7+yzHC5jUh8WCaZoK7Jj7Tj4xbQLTpl+tcFep4N0JXjddfrwJSOczVvOIXesW2b5mmy1IL0tsHYefwtPcywK85qRYsF1X4SBZW3a+negsfJ/edZlho0bzwzGLqcl5x+SPRyr/LvV5fNrntl4Dq0rut9mvFljtcs56xcT0igVT0xTSBdHUz23TxxxPGIk6ekvQrVyxXfm8V3X+8rbPu7bJS7X9ayuCB5g7Dqt370gqtXxu6KiiXiwYuq64C4kX+3k4V0nmNlq1QvtTCa9X53l9wk9VCysdUHXO+e72W150n6JGY9SpSmN4zj5K8kOSMLhVi4WxriuTJehOLV8uq0ytK4aNOoPrCvdC8N2lxmIW4I6GHA+Oed75PyeTDzQHFzitGqo7Jj15l3PfQdcnxYJj2wpAuJrl0fIOyyij1auoF2fcHCtMgym98YhZEiPcBo/bj3k9OkEML0lOzhF+Rvzieb6tVKi3mr8D+zM3PzNP6Rq3DD5fcfvxBLVySaLrZNqIj/oZyvANxf4RT+5/5kR/D2qf2dEL0vOLXG42lPq/bfNKAk4a7Rt+Qw5DTTqDoex+FnIWRHL54UzG//in1HqqrHSqsj9syWb3s2z6ujwK13JomjK0f96vWfBp5L0sOE6kQMAu6+W2NSXwbXbpDl/bsl9twbFhFrNZpiyTlF264iGJSTcrqpnE3e85bNQcNqiTXrFw31a/SmKrF3rmjTkciVG3I1xjIjzPFaHjiNgwRZLEYjENhR/FIg5nIg0dETlj4TmuiD1HRNPZjakPeqVG6dEvx/OxlPZOgfsAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/76191097103de55829c825fc63f9828a/ba381/wordcloud-sample.webp 200w,\n/static/76191097103de55829c825fc63f9828a/7f61c/wordcloud-sample.webp 400w,\n/static/76191097103de55829c825fc63f9828a/d00b9/wordcloud-sample.webp 800w,\n/static/76191097103de55829c825fc63f9828a/1ae05/wordcloud-sample.webp 868w\"\n              sizes=\"(max-width: 800px) 100vw, 800px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/76191097103de55829c825fc63f9828a/772e8/wordcloud-sample.png 200w,\n/static/76191097103de55829c825fc63f9828a/e17e5/wordcloud-sample.png 400w,\n/static/76191097103de55829c825fc63f9828a/5a190/wordcloud-sample.png 800w,\n/static/76191097103de55829c825fc63f9828a/748b0/wordcloud-sample.png 868w\"\n            sizes=\"(max-width: 800px) 100vw, 800px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/76191097103de55829c825fc63f9828a/5a190/wordcloud-sample.png\"\n            alt=\"wordcloud sample\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h2 id=\"wordcloudの作り方実装\" style=\"position:relative;\"><a href=\"#wordcloud%E3%81%AE%E4%BD%9C%E3%82%8A%E6%96%B9%E5%AE%9F%E8%A3%85\" aria-label=\"wordcloudの作り方実装 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>WordCloudの作り方（実装）</h2>\n<p>自前実装の必要はありません。<a href=\"https://github.com/takuyaa/kuromoji.js/\">kuromoji.js</a>と<a href=\"https://github.com/jasondavies/d3-cloud\">D3-Cloud</a>というライブラリを使えば簡単に実装できます。\nさらに<a href=\"https://github.com/Yoctol/react-d3-cloud\">react-d3-cloud</a>というD3-CloudをReactで使うためのライブラリもあったので、それを使ってReactアプリを実装します。</p>\n<h3 id=\"1-文章を解析して単語出現回数をデータ化-1\" style=\"position:relative;\"><a href=\"#1-%E6%96%87%E7%AB%A0%E3%82%92%E8%A7%A3%E6%9E%90%E3%81%97%E3%81%A6%E5%8D%98%E8%AA%9E%E5%87%BA%E7%8F%BE%E5%9B%9E%E6%95%B0%E3%82%92%E3%83%87%E3%83%BC%E3%82%BF%E5%8C%96-1\" aria-label=\"1 文章を解析して単語出現回数をデータ化 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. 文章を解析して単語出現回数をデータ化</h3>\n<p>kuromoji.jsは形態素解析で辞書を使います。\nkuromoji.jsをインストールすると辞書がバンドルされています。\nReactで使う場合は以下のように辞書の場所を移動して、辞書をブラウザから読み込めるようにしておく必要があります。</p>\n<div class=\"gatsby-code-title\">辞書をブラウザから読み込める場所にコピー</div>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">$ <span class=\"token function\">cp</span> <span class=\"token parameter variable\">-a</span> node_modules/kuromoji/dict public/</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<br/>\n<p>kuromoji.jsの解析結果は以下のようになります。\n色々ありますが、今回は<code class=\"language-text\">pos（品詞）</code>と<code class=\"language-text\">surface_form（表層形）</code>または<code class=\"language-text\">basic_form（基本形）</code>のみを使います。</p>\n<div class=\"gatsby-code-title\">kuromoji.js解析結果の形式</div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">word_id</span><span class=\"token operator\">:</span> <span class=\"token number\">509800</span><span class=\"token punctuation\">,</span>          <span class=\"token comment\">// 辞書内での単語ID</span>\n  <span class=\"token literal-property property\">word_type</span><span class=\"token operator\">:</span> <span class=\"token string\">'KNOWN'</span><span class=\"token punctuation\">,</span>       <span class=\"token comment\">// 単語タイプ(辞書に登録されている単語ならKNOWN, 未知語ならUNKNOWN)</span>\n  <span class=\"token literal-property property\">word_position</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>         <span class=\"token comment\">// 単語の開始位置</span>\n  <span class=\"token literal-property property\">surface_form</span><span class=\"token operator\">:</span> <span class=\"token string\">'黒文字'</span><span class=\"token punctuation\">,</span>    <span class=\"token comment\">// 表層形</span>\n  <span class=\"token literal-property property\">pos</span><span class=\"token operator\">:</span> <span class=\"token string\">'名詞'</span><span class=\"token punctuation\">,</span>               <span class=\"token comment\">// 品詞</span>\n  <span class=\"token literal-property property\">pos_detail_1</span><span class=\"token operator\">:</span> <span class=\"token string\">'一般'</span><span class=\"token punctuation\">,</span>      <span class=\"token comment\">// 品詞細分類1</span>\n  <span class=\"token literal-property property\">pos_detail_2</span><span class=\"token operator\">:</span> <span class=\"token string\">'*'</span><span class=\"token punctuation\">,</span>        <span class=\"token comment\">// 品詞細分類2</span>\n  <span class=\"token literal-property property\">pos_detail_3</span><span class=\"token operator\">:</span> <span class=\"token string\">'*'</span><span class=\"token punctuation\">,</span>        <span class=\"token comment\">// 品詞細分類3</span>\n  <span class=\"token literal-property property\">conjugated_type</span><span class=\"token operator\">:</span> <span class=\"token string\">'*'</span><span class=\"token punctuation\">,</span>     <span class=\"token comment\">// 活用型</span>\n  <span class=\"token literal-property property\">conjugated_form</span><span class=\"token operator\">:</span> <span class=\"token string\">'*'</span><span class=\"token punctuation\">,</span>     <span class=\"token comment\">// 活用形</span>\n  <span class=\"token literal-property property\">basic_form</span><span class=\"token operator\">:</span> <span class=\"token string\">'黒文字'</span><span class=\"token punctuation\">,</span>      <span class=\"token comment\">// 基本形</span>\n  <span class=\"token literal-property property\">reading</span><span class=\"token operator\">:</span> <span class=\"token string\">'クロモジ'</span><span class=\"token punctuation\">,</span>       <span class=\"token comment\">// 読み</span>\n  <span class=\"token literal-property property\">pronunciation</span><span class=\"token operator\">:</span> <span class=\"token string\">'クロモジ'</span>  <span class=\"token comment\">// 発音</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<br/>\n<p>Reactコンポーネントでは以下のように実装します。</p>\n<div class=\"gatsby-code-title\">テキスト加工処理</div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span>\n<span class=\"token keyword\">import</span> kuromoji <span class=\"token keyword\">from</span> <span class=\"token string\">'kuromoji'</span>\n\n<span class=\"token keyword\">const</span> text <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">そこも場合もうその病気らに対して旨の時がしんませ。\n単に事実に使用方はどうかその応用たないでもが思いてならないがも発展思いうべきて、\n...\n</span><span class=\"token template-punctuation string\">`</span></span>\n\n<span class=\"token comment\">// 辞書格納フォルダパス</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">DIC_URL</span> <span class=\"token operator\">=</span> <span class=\"token string\">'/dict'</span>\n\n<span class=\"token comment\">// WordCloudの情報として抽出する品詞（助詞、助動詞などは意味がないので拾わない）</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">TARGET_POS</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'名詞'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'動詞'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'形容詞'</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token comment\">// kuromoji.jsの解析結果の値で特に値がない場合は以下の文字が設定される</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">NO_CONTENT</span> <span class=\"token operator\">=</span> <span class=\"token string\">'*'</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">App</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token comment\">// kuromoji.jsによる形態素解析は非同期なので</span>\n  <span class=\"token comment\">// 解析結果はstateのプロパティとしてコンストラクタで初期化しておく</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">dataForD3Cloud</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">componentWillMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// 辞書を読み混んでトークナイザー（形態素解析するための関数）を生成</span>\n    kuromoji<span class=\"token punctuation\">.</span><span class=\"token function\">builder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">dicPath</span><span class=\"token operator\">:</span> <span class=\"token constant\">DIC_URL</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">err<span class=\"token punctuation\">,</span> tokenizer</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">return</span>\n      <span class=\"token punctuation\">}</span>\n\n      <span class=\"token comment\">// テキストを引数にして形態素解析</span>\n      <span class=\"token keyword\">const</span> tokens <span class=\"token operator\">=</span> tokenizer<span class=\"token punctuation\">.</span><span class=\"token function\">tokenize</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">)</span>\n\n      <span class=\"token comment\">// 解析結果から単語と出現回数を抽出</span>\n      <span class=\"token keyword\">const</span> dataForD3Cloud <span class=\"token operator\">=</span> tokens\n        <span class=\"token comment\">// pos（品詞）を参照し、'名詞', '動詞', '形容詞'のみを抽出</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">t</span> <span class=\"token operator\">=></span> <span class=\"token constant\">TARGET_POS</span><span class=\"token punctuation\">.</span><span class=\"token function\">includes</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">.</span>pos<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token comment\">// 単語を抽出(basic_formかsurface_formに単語が存在する)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">t</span> <span class=\"token operator\">=></span> t<span class=\"token punctuation\">.</span>basic_form <span class=\"token operator\">===</span> <span class=\"token constant\">NO_CONTENT</span> <span class=\"token operator\">?</span> t<span class=\"token punctuation\">.</span>surface_form <span class=\"token operator\">:</span> t<span class=\"token punctuation\">.</span>basic_form<span class=\"token punctuation\">)</span>\n        <span class=\"token comment\">// [{text: 単語, value: 出現回数}]の形にReduce</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">reduce</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">data<span class=\"token punctuation\">,</span> text</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n          <span class=\"token keyword\">const</span> target <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">c</span> <span class=\"token operator\">=></span> c<span class=\"token punctuation\">.</span>text <span class=\"token operator\">===</span> text<span class=\"token punctuation\">)</span>\n          <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>target<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            target<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> target<span class=\"token punctuation\">.</span>value <span class=\"token operator\">+</span> <span class=\"token number\">1</span>\n          <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n            data<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n              text<span class=\"token punctuation\">,</span>\n              <span class=\"token literal-property property\">value</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">}</span>\n          <span class=\"token keyword\">return</span> data\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n      \n      <span class=\"token comment\">// 加工した解析結果をstateにセット</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>dataForD3Cloud<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// 略</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> App<span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<br/>\n<h3 id=\"2-データをもとにイイ感じの画像出力-1\" style=\"position:relative;\"><a href=\"#2-%E3%83%87%E3%83%BC%E3%82%BF%E3%82%92%E3%82%82%E3%81%A8%E3%81%AB%E3%82%A4%E3%82%A4%E6%84%9F%E3%81%98%E3%81%AE%E7%94%BB%E5%83%8F%E5%87%BA%E5%8A%9B-1\" aria-label=\"2 データをもとにイイ感じの画像出力 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. データをもとにイイ感じの画像出力</h3>\n<p><a href=\"https://github.com/Yoctol/react-d3-cloud\">react-d3-cloud</a>が専用のコンポーネントを提供しているのでそれを使うだけです。</p>\n<div class=\"gatsby-code-title\">WordCloud描画処理</div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> WordCloud <span class=\"token keyword\">from</span> <span class=\"token string\">\"react-d3-cloud\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// フォントの大きさを決める関数</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">fontSizeMapper</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">word</span> <span class=\"token operator\">=></span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">pow</span><span class=\"token punctuation\">(</span>word<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">,</span> <span class=\"token number\">0.8</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">10</span>\n\n<span class=\"token comment\">// フォントの回転位置</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">rotate</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">word</span> <span class=\"token operator\">=></span> word<span class=\"token punctuation\">.</span>value <span class=\"token operator\">%</span> <span class=\"token number\">2</span> <span class=\"token operator\">===</span> <span class=\"token number\">1</span> <span class=\"token operator\">?</span> <span class=\"token number\">0</span> <span class=\"token operator\">:</span> <span class=\"token number\">90</span>\n\n<span class=\"token comment\">// フォントの種類</span>\n<span class=\"token keyword\">const</span> fontFamily <span class=\"token operator\">=</span> <span class=\"token string\">'meiryo'</span>\n\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">App</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// 略</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">componentWillMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// 略</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token operator\">&lt;</span>div className<span class=\"token operator\">=</span><span class=\"token string\">\"App\"</span><span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>WordCloud\n          data<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>dataForD3Cloud<span class=\"token punctuation\">}</span>\n          fontSizeMapper<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>fontSizeMapper<span class=\"token punctuation\">}</span>\n          rotate<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>rotate<span class=\"token punctuation\">}</span>\n          font<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>fontFamily<span class=\"token punctuation\">}</span>\n        <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> App<span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<br/>\n<p>さて、ここで疑問を持たれる方もいると思います。\n前述の<a href=\"#2-%E3%83%87%E3%83%BC%E3%82%BF%E3%82%92%E3%82%82%E3%81%A8%E3%81%AB%E3%82%A4%E3%82%A4%E6%84%9F%E3%81%98%E3%81%AE%E7%94%BB%E5%83%8F%E5%87%BA%E5%8A%9B\">WordCloudの作り方（原理）> 2. データをもとにイイ感じの画像出力</a>で画像出力するには以下を決定する必要があると述べました。</p>\n<ol>\n<li>フォントの大きさ・・・・・☚コンポーネントで定義した👍</li>\n<li>フォントの回転位置・・・・☚コンポーネントで定義した👍</li>\n<li>フォントの種類・・・・・・☚コンポーネントで定義した👍</li>\n<li>フォントの色・・・・・・・☚コンポーネントで定義してない🤔</li>\n<li>表示位置・・・・・・・・・☚コンポーネントで定義してない🤔</li>\n</ol>\n<p><code class=\"language-text\">4</code>,<code class=\"language-text\">5</code>どうやって決めるのでしょうか？\n実は<code class=\"language-text\">4</code>はreact-d3-cloud内部でよしなり定義してくれていて、\n<code class=\"language-text\">5</code>はD3-Cloudがイイ感じに決めてくれています。</p>\n<p><a href=\"https://github.com/Yoctol/react-d3-cloud/blob/master/src/WordCloud.js#L91\"><strong>↓react-d3-cloud内部ロジック 色定義：WordCloud.js#L91</strong></a></p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber 67\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\">   <span class=\"token keyword\">const</span> layout <span class=\"token operator\">=</span> <span class=\"token function\">cloud</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>width<span class=\"token punctuation\">,</span> height<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">font</span><span class=\"token punctuation\">(</span>font<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">words</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">padding</span><span class=\"token punctuation\">(</span>padding<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">rotate</span><span class=\"token punctuation\">(</span>rotate<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">fontSize</span><span class=\"token punctuation\">(</span>fontSizeMapper<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'end'</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">words</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">const</span> texts <span class=\"token operator\">=</span> <span class=\"token function\">select</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>wordCloud<span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">'svg'</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'width'</span><span class=\"token punctuation\">,</span> layout<span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'height'</span><span class=\"token punctuation\">,</span> layout<span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">'g'</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span>\n            <span class=\"token string\">'transform'</span><span class=\"token punctuation\">,</span>\n            <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">translate(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>layout<span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">,</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>layout<span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">)</span><span class=\"token template-punctuation string\">`</span></span>\n          <span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">selectAll</span><span class=\"token punctuation\">(</span><span class=\"token string\">'text'</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">data</span><span class=\"token punctuation\">(</span>words<span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">enter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">'text'</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">style</span><span class=\"token punctuation\">(</span><span class=\"token string\">'font-size'</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">d</span> <span class=\"token operator\">=></span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>d<span class=\"token punctuation\">.</span>size<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">style</span><span class=\"token punctuation\">(</span><span class=\"token string\">'font-family'</span><span class=\"token punctuation\">,</span> font<span class=\"token punctuation\">)</span>\n<span class=\"gatsby-highlight-code-line\">          <span class=\"token punctuation\">.</span><span class=\"token function\">style</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fill'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">d<span class=\"token punctuation\">,</span> i</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">fill</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></span>          <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'text-anchor'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'middle'</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'transform'</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">d</span> <span class=\"token operator\">=></span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">translate(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token punctuation\">[</span>d<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">.</span>y<span class=\"token punctuation\">]</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">)rotate(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>d<span class=\"token punctuation\">.</span>rotate<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">)</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">text</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">d</span> <span class=\"token operator\">=></span> d<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<br/>\n<p><a href=\"https://github.com/jasondavies/d3-cloud/blob/master/build/d3.layout.cloud.js#L59-L73\"><strong>↓D3-Cloud内部ロジック 表示位置定義：d3.layout.cloud.js#L59-L73</strong></a></p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber 56\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\">    <span class=\"token keyword\">function</span> <span class=\"token function\">step</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">var</span> start <span class=\"token operator\">=</span> Date<span class=\"token punctuation\">.</span><span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">      <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>Date<span class=\"token punctuation\">.</span><span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> start <span class=\"token operator\">&lt;</span> timeInterval <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">++</span>i <span class=\"token operator\">&lt;</span> n <span class=\"token operator\">&amp;&amp;</span> timer<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">        <span class=\"token keyword\">var</span> d <span class=\"token operator\">=</span> data<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">        d<span class=\"token punctuation\">.</span>x <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>size<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">.5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">>></span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">        d<span class=\"token punctuation\">.</span>y <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>size<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">.5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">>></span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">        <span class=\"token function\">cloudSprite</span><span class=\"token punctuation\">(</span>contextAndRatio<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>d<span class=\"token punctuation\">.</span>hasText <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">place</span><span class=\"token punctuation\">(</span>board<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> bounds<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">          tags<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>d<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">          <span class=\"token function\">event</span><span class=\"token punctuation\">.</span><span class=\"token function\">call</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"word\"</span><span class=\"token punctuation\">,</span> cloud<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">          <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>bounds<span class=\"token punctuation\">)</span> <span class=\"token function\">cloudBounds</span><span class=\"token punctuation\">(</span>bounds<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">          <span class=\"token keyword\">else</span> bounds <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">x</span><span class=\"token operator\">:</span> d<span class=\"token punctuation\">.</span>x <span class=\"token operator\">+</span> d<span class=\"token punctuation\">.</span>x0<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">y</span><span class=\"token operator\">:</span> d<span class=\"token punctuation\">.</span>y <span class=\"token operator\">+</span> d<span class=\"token punctuation\">.</span>y0<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span><span class=\"token literal-property property\">x</span><span class=\"token operator\">:</span> d<span class=\"token punctuation\">.</span>x <span class=\"token operator\">+</span> d<span class=\"token punctuation\">.</span>x1<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">y</span><span class=\"token operator\">:</span> d<span class=\"token punctuation\">.</span>y <span class=\"token operator\">+</span> d<span class=\"token punctuation\">.</span>y1<span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">          <span class=\"token comment\">// Temporary hack</span></span><span class=\"gatsby-highlight-code-line\">          d<span class=\"token punctuation\">.</span>x <span class=\"token operator\">-=</span> size<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">>></span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">          d<span class=\"token punctuation\">.</span>y <span class=\"token operator\">-=</span> size<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">>></span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">        <span class=\"token punctuation\">}</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token punctuation\">}</span></span>      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>i <span class=\"token operator\">>=</span> n<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        cloud<span class=\"token punctuation\">.</span><span class=\"token function\">stop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">event</span><span class=\"token punctuation\">.</span><span class=\"token function\">call</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"end\"</span><span class=\"token punctuation\">,</span> cloud<span class=\"token punctuation\">,</span> tags<span class=\"token punctuation\">,</span> bounds<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<br/>\n<p>これによって以下のようなイイ感じのWordCloudを出力することができるのですね。\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/76191097103de55829c825fc63f9828a/748b0/wordcloud-sample.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 86%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAENElEQVR42kWS624aZwJAedl9kNXuj0p7UdTLrrorbXerNm0um5hkEjtxHGzHEAzmAzw2twGGuQ9zgYEBhst8PlXVH32BI52jU1DV1lcj3epNG29v1lf/FaPRG2G4FRHexWI28sSbW0s8/dQVP37qCuvOEd26JxqfHRENZ8Ib+0KLI9Hzw5uWF/QajcajgmHqypyULNZy4j6rrEW+6ZH5GotsTa07oTxZUjXWZMuQ3OySGWOw75GLDHu+5zjd5G+2MHKcYkGf6K8yEppmtH/d8uV0tpBc/0duP34hN+0nkvI3cq9dyMDey4XWlQf9WnL1SB4u/yYtN5XGXSjb6/W+lO4xbPtlYawbSnIAMZnl35fHdMIMaV3Dsz+QGg6Zcc9D8xlTD9Ig4VD7gYf3f+bQVfA0nZu7iNNZkncOoFtWsaCPB8phmzL3zTx0l0zjDXz8E/LiW1YRyPsy2/4R8zSA1lMeescs5zEbZ8ju7d8piYB/RfP8+WLHyLSKhYFhKqx06Cr5pjlD2iYPNz8ga09YBrBVzzlUvmQXD8CoQflrHkp/Zd8scij/D7Nj0Rkbubt/wHLdYsG2HQVW5EGUr7SE7Sjl4CRgtgmGDk+vNaR2xso3WfgWmVCQv2qrL5m/KpKefsB7+yzHC5jUh8WCaZoK7Jj7Tj4xbQLTpl+tcFep4N0JXjddfrwJSOczVvOIXesW2b5mmy1IL0tsHYefwtPcywK85qRYsF1X4SBZW3a+negsfJ/edZlho0bzwzGLqcl5x+SPRyr/LvV5fNrntl4Dq0rut9mvFljtcs56xcT0igVT0xTSBdHUz23TxxxPGIk6ekvQrVyxXfm8V3X+8rbPu7bJS7X9ayuCB5g7Dqt370gqtXxu6KiiXiwYuq64C4kX+3k4V0nmNlq1QvtTCa9X53l9wk9VCysdUHXO+e72W150n6JGY9SpSmN4zj5K8kOSMLhVi4WxriuTJehOLV8uq0ytK4aNOoPrCvdC8N2lxmIW4I6GHA+Oed75PyeTDzQHFzitGqo7Jj15l3PfQdcnxYJj2wpAuJrl0fIOyyij1auoF2fcHCtMgym98YhZEiPcBo/bj3k9OkEML0lOzhF+Rvzieb6tVKi3mr8D+zM3PzNP6Rq3DD5fcfvxBLVySaLrZNqIj/oZyvANxf4RT+5/5kR/D2qf2dEL0vOLXG42lPq/bfNKAk4a7Rt+Qw5DTTqDoex+FnIWRHL54UzG//in1HqqrHSqsj9syWb3s2z6ujwK13JomjK0f96vWfBp5L0sOE6kQMAu6+W2NSXwbXbpDl/bsl9twbFhFrNZpiyTlF264iGJSTcrqpnE3e85bNQcNqiTXrFw31a/SmKrF3rmjTkciVG3I1xjIjzPFaHjiNgwRZLEYjENhR/FIg5nIg0dETlj4TmuiD1HRNPZjakPeqVG6dEvx/OxlPZOgfsAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/76191097103de55829c825fc63f9828a/ba381/wordcloud-sample.webp 200w,\n/static/76191097103de55829c825fc63f9828a/7f61c/wordcloud-sample.webp 400w,\n/static/76191097103de55829c825fc63f9828a/d00b9/wordcloud-sample.webp 800w,\n/static/76191097103de55829c825fc63f9828a/1ae05/wordcloud-sample.webp 868w\"\n              sizes=\"(max-width: 800px) 100vw, 800px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/76191097103de55829c825fc63f9828a/772e8/wordcloud-sample.png 200w,\n/static/76191097103de55829c825fc63f9828a/e17e5/wordcloud-sample.png 400w,\n/static/76191097103de55829c825fc63f9828a/5a190/wordcloud-sample.png 800w,\n/static/76191097103de55829c825fc63f9828a/748b0/wordcloud-sample.png 868w\"\n            sizes=\"(max-width: 800px) 100vw, 800px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/76191097103de55829c825fc63f9828a/5a190/wordcloud-sample.png\"\n            alt=\"wordcloud sample\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h2 id=\"その他日本語長文サンプルの準備にはすぐに使えるダミーテキストが便利\" style=\"position:relative;\"><a href=\"#%E3%81%9D%E3%81%AE%E4%BB%96%E6%97%A5%E6%9C%AC%E8%AA%9E%E9%95%B7%E6%96%87%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AB%E3%81%AE%E6%BA%96%E5%82%99%E3%81%AB%E3%81%AF%E3%81%99%E3%81%90%E3%81%AB%E4%BD%BF%E3%81%88%E3%82%8B%E3%83%80%E3%83%9F%E3%83%BC%E3%83%86%E3%82%AD%E3%82%B9%E3%83%88%E3%81%8C%E4%BE%BF%E5%88%A9\" aria-label=\"その他日本語長文サンプルの準備にはすぐに使えるダミーテキストが便利 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>その他：日本語長文サンプルの準備には「すぐに使えるダミーテキスト」が便利</h2>\n<p>WordCloudを作るときにテキトーな日本語文章を大量に用意する必要があります。\nそんな時は下記サイトが便利でした。</p>\n<p><a href=\"https://lipsum.sugutsukaeru.jp/index.cgi\">https://lipsum.sugutsukaeru.jp/index.cgi</a></p>\n<h2 id=\"まとめ\" style=\"position:relative;\"><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\" aria-label=\"まとめ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>まとめ</h2>\n<p>Pythonじゃないと形態素解析とWordCloud生成は無理かなと思っていましたが、JavaScriptでもライブラリが提供されていました。JavaScriptであればブラウザ上で処理を行えるので、たとえば入力フォームに入力した文字列をインプットにWordCloudを生成するなど、インタラクティブな操作が可能です。ただし生成に時間がかかるので、実際使うときはユーザーに生成中の旨をフィードバックするようなUIにする必要があるでしょう🍅</p>","excerpt":"なにこれ WordCloudをJSだけで生成したい。Pythonとか使わずにフロントエンドだけでやりたい。というモチベーションで、\nkuromoji.jsとD3-Cloudを使って文字列をインプットにWordCloudを描画するReact…","frontmatter":{"slug":"/wordcloud-with-kuromoji-d3cloud-react","title":"React + kuromoji.js + D3-CloudでWordCloudをブラウザに描画","date":"2019-05-04T12:40:00.000+09:00","tags":["React","kuromoji.js","d3.js","d3Cloud","データ可視化","形態素解析","WordCloud"],"keywords":["React"],"thumbnail":"thumbnail/2019/05/wordcloud-with-kuromoji-d3cloud-react.png"},"headingsDetail":[{"id":"なにこれ","value":"なにこれ","depth":2,"parents":[]},{"id":"wordcloudの作り方（原理）","value":"WordCloudの作り方（原理）","depth":2,"parents":[]},{"id":"1-文章を解析して単語出現回数をデータ化","value":"1. 文章を解析して単語出現回数をデータ化","depth":3,"parents":[{"id":"wordcloudの作り方（原理）","value":"WordCloudの作り方（原理）","depth":2}]},{"id":"2-データをもとにイイ感じの画像出力","value":"2. データをもとにイイ感じの画像出力","depth":3,"parents":[{"id":"wordcloudの作り方（原理）","value":"WordCloudの作り方（原理）","depth":2}]},{"id":"wordcloudの作り方（実装）","value":"WordCloudの作り方（実装）","depth":2,"parents":[]},{"id":"1-文章を解析して単語出現回数をデータ化-1","value":"1. 文章を解析して単語出現回数をデータ化","depth":3,"parents":[{"id":"wordcloudの作り方（実装）","value":"WordCloudの作り方（実装）","depth":2}]},{"id":"2-データをもとにイイ感じの画像出力-1","value":"2. データをもとにイイ感じの画像出力","depth":3,"parents":[{"id":"wordcloudの作り方（実装）","value":"WordCloudの作り方（実装）","depth":2}]},{"id":"その他：日本語長文サンプルの準備には「すぐに使えるダミーテキスト」が便利","value":"その他：日本語長文サンプルの準備には「すぐに使えるダミーテキスト」が便利","depth":2,"parents":[]},{"id":"まとめ","value":"まとめ","depth":2,"parents":[]}]}},"pageContext":{"thumbnail":{"node":{"relativePath":"thumbnail/2019/05/wordcloud-with-kuromoji-d3cloud-react.png","name":"wordcloud-with-kuromoji-d3cloud-react","childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#388898","images":{"fallback":{"src":"/static/3fb7b9c0d1f04fd4bd59c54533bea99f/e7888/wordcloud-with-kuromoji-d3cloud-react.png","srcSet":"/static/3fb7b9c0d1f04fd4bd59c54533bea99f/6b9a5/wordcloud-with-kuromoji-d3cloud-react.png 300w,\n/static/3fb7b9c0d1f04fd4bd59c54533bea99f/ae865/wordcloud-with-kuromoji-d3cloud-react.png 600w,\n/static/3fb7b9c0d1f04fd4bd59c54533bea99f/e7888/wordcloud-with-kuromoji-d3cloud-react.png 1200w","sizes":"(min-width: 1200px) 1200px, 100vw"},"sources":[{"srcSet":"/static/3fb7b9c0d1f04fd4bd59c54533bea99f/b0a02/wordcloud-with-kuromoji-d3cloud-react.webp 300w,\n/static/3fb7b9c0d1f04fd4bd59c54533bea99f/86b42/wordcloud-with-kuromoji-d3cloud-react.webp 600w,\n/static/3fb7b9c0d1f04fd4bd59c54533bea99f/b1bc4/wordcloud-with-kuromoji-d3cloud-react.webp 1200w","type":"image/webp","sizes":"(min-width: 1200px) 1200px, 100vw"}]},"width":1200,"height":631}}}},"siteMetadata":{"title":"Masashi Ishikawa's portfolio","author":"Masashi Ishikawa"},"slug":"/wordcloud-with-kuromoji-d3cloud-react","relatedPosts":[{"html":"<h2 id=\"なにこれ\" style=\"position:relative;\"><a href=\"#%E3%81%AA%E3%81%AB%E3%81%93%E3%82%8C\" aria-label=\"なにこれ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>なにこれ</h2>\n<p><a href=\"/wordcloud-with-kuromoji-d3cloud-nodejs\">前回記事</a>ではNode.jsでWordCloudを出力しました。\n今回は、<a href=\"https://github.com/Takumon/playbox2019/blob/master/node-kuromoji-d3cloud-sample/index.js\">前回のサンプル</a>をベースに自分のブログ（Gatsby製のブログ）にWordCloudを取り入れてみたので、その時の実装方法のメモです。</p>\n<p>※ソースコードは以下です。<br/>\n<a href=\"https://github.com/Takumon/blog/blob/master/gatsby-node.js\">https://github.com/Takumon/blog/blob/master/gatsby-node.js</a></p>\n<h2 id=\"wordcloudどんなかんじ\" style=\"position:relative;\"><a href=\"#wordcloud%E3%81%A9%E3%82%93%E3%81%AA%E3%81%8B%E3%82%93%E3%81%98\" aria-label=\"wordcloudどんなかんじ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>WordCloudどんなかんじ？</h2>\n<p>(1)記事全文をインプットにしたものと、(2)記事のタグをインプットにしたものの2つを生成しました。<a href=\"./map\">全記事解析ページ</a>で見れます。</p>\n<h3 id=\"1記事全文をインプットにしたもの\" style=\"position:relative;\"><a href=\"#1%E8%A8%98%E4%BA%8B%E5%85%A8%E6%96%87%E3%82%92%E3%82%A4%E3%83%B3%E3%83%97%E3%83%83%E3%83%88%E3%81%AB%E3%81%97%E3%81%9F%E3%82%82%E3%81%AE\" aria-label=\"1記事全文をインプットにしたもの permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>(1)記事全文をインプットにしたもの</h3>\n<p>キーワード以外にも、「登録」「実現」「まとめ」のような何回も使う表現がノイズとして混ざるのであまり満足度は高くありません。それでも「Gatsby」「React」が目立って表示されているので、形だけはWordCloudになっています。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d54597d54916946ac04e434744ea4221/29007/wordcloud-from-texts.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 52.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAABcRAAAXEQHKJvM/AAACBklEQVR42hXR2U7bQBQAUP//X/S5dBG8VFUrVWqAEpIQcBxjxx7PPnf2GS8k9Knq+YVT2Bx8ijHGkE304KMSVl0EOCaoGgYrwRgXpLcuB5miizFM0zSnOC/nIie3uDB6m5MxgEW0APx8UqF/bvQeqxfOQUPujGWYSIUESK9gjm6Z5mIO8BbExFweJGV9TV3TlrxXvN/1eMvZpqJEMVcD3zeDUEQrGi1zIJc5F2aMWAVbv6Y/K0H79Svv6z3ab3eM3g3NlrGhwZRAh/sTiF4rbWQnjga6aU4FgE4MzuUOnp4o5Q+16O8e2O8Vw8/ytCasAzSsK4QPZXhdAzt1NlRKKq2CTcWFoEmHpr6X1X2sO9wMmXRaDrw5kuMjq4+47p63pUadb2/fj/eac4xi4nRMsZh85ApeRPPe3h7Lz18OV9+766/Vh5vy09Xm4/Xh2+Opio2zYicNeyOlow2ImDReZihcVNSBN3Ikmpf7h+bnE/qxbld37WbTrq7bm1/Hl6qFHSOcCMMbgltvaTQqjb4I/3MdVWpgOvR4xr3URKCJUO0l34u2R9w0PaKGAw7DIQg0Gjtqk8/nIhuXU9TOMSeZQZ4OiiuhPONUUIQFn4Q4M6SkY54FYMkz69KY3bTkYk4q53GMPkdjA8zR5uxNtpB0nLJL0+zJJerFJR9SCPlt9nH04xj/XpZ/tYBKcGRHX0MAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/d54597d54916946ac04e434744ea4221/ba381/wordcloud-from-texts.webp 200w,\n/static/d54597d54916946ac04e434744ea4221/7f61c/wordcloud-from-texts.webp 400w,\n/static/d54597d54916946ac04e434744ea4221/d00b9/wordcloud-from-texts.webp 800w,\n/static/d54597d54916946ac04e434744ea4221/92f8c/wordcloud-from-texts.webp 1200w,\n/static/d54597d54916946ac04e434744ea4221/fad48/wordcloud-from-texts.webp 1600w\"\n              sizes=\"(max-width: 800px) 100vw, 800px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/d54597d54916946ac04e434744ea4221/772e8/wordcloud-from-texts.png 200w,\n/static/d54597d54916946ac04e434744ea4221/e17e5/wordcloud-from-texts.png 400w,\n/static/d54597d54916946ac04e434744ea4221/5a190/wordcloud-from-texts.png 800w,\n/static/d54597d54916946ac04e434744ea4221/c1b63/wordcloud-from-texts.png 1200w,\n/static/d54597d54916946ac04e434744ea4221/29007/wordcloud-from-texts.png 1600w\"\n            sizes=\"(max-width: 800px) 100vw, 800px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/d54597d54916946ac04e434744ea4221/5a190/wordcloud-from-texts.png\"\n            alt=\"wordcloud from texts\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span>\n<br/></p>\n<h3 id=\"2記事のタグをインプットにしたもの\" style=\"position:relative;\"><a href=\"#2%E8%A8%98%E4%BA%8B%E3%81%AE%E3%82%BF%E3%82%B0%E3%82%92%E3%82%A4%E3%83%B3%E3%83%97%E3%83%83%E3%83%88%E3%81%AB%E3%81%97%E3%81%9F%E3%82%82%E3%81%AE\" aria-label=\"2記事のタグをインプットにしたもの permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>(2)記事のタグをインプットにしたもの</h3>\n<p>上記を作ってみて満足いかなかったので、試しに記事のタグをインプットにしたものを作ってみたら、思いのほかそれっぽくなりました。自分の直感とも一致していているので、「どんなブログ書いてるの？」という質問の答えとして十分使えそうです。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/6b221814408fff0db1c489870df79575/29007/wordcloud-from-tags.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 53%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABcRAAAXEQHKJvM/AAACXElEQVR42lWSW2/bRhSE+f9/QR8LBCj6UOShCNAYbVwXgd04sRNKliWLikRJvIg3LbnkkktySX2BbPSSAQYYzJk5T2MBnE6nZ75oOI0v2hFLgngFbc+oc9q6YxggbjRNo//Ln/vxHBqBZYaaZO+j8pyuzVF5TB55dI3mrfsbnyKHpZCgfNSxpulGDrohOx4pVIPpOgYpYP0O6iNW26aE6w3Jbs1+brOa3bOdT/HmEb8u3vHzx0fuNz4Pns/vk5C3s4irVcr7ZcSrvzd8+pqwmH8lvXsNfYmV6wzhbqnEFNVniEJQJ5pwJXjjXPHGXnHxectr+8APVy4Xi4iLxYFf7j1++rDkLyfjx8sHCvcLDC1WozVqF1Cln0mFi7teEnsJ60nCUzLj/c7mdvvEJHC4280IsyNT12dzyNgsfcJQcLNwwb0ELbHqSlE4LmVyhxen+PuQ7BByWBckgc+mWBN7D6g//yD9eIO8uaa5vqGZ3NNdXyKuPxAeCrrAw1QSqy0lUSwR1ZJaS3JVI/MG/6lAHlIaT1DOdrSTPcUionl0kM4UFT7Se0+U+4A4KglCSVF3WK0sCGRJVD4yV5LbQrEUiqmT8WUT4Ycl221B4OcMnsuwukXmKVqukFVEkRckcYmpNCdOWF0pTShLk1SOOeaJ2YvKJG5hdkFptqI2bhYar0xMGmem8zKj3J2pRWbGKjaizE2jMzMoYcYeAxjrPM4BGHmBMiMy1NC/OKeu51QLaBTInrGs6HX/POZz4sT3OD+0/8/GjHZZaJthtMd/fF3ZtPW/mWE830abZ37f/wZiDjREzphx4QAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/6b221814408fff0db1c489870df79575/ba381/wordcloud-from-tags.webp 200w,\n/static/6b221814408fff0db1c489870df79575/7f61c/wordcloud-from-tags.webp 400w,\n/static/6b221814408fff0db1c489870df79575/d00b9/wordcloud-from-tags.webp 800w,\n/static/6b221814408fff0db1c489870df79575/92f8c/wordcloud-from-tags.webp 1200w,\n/static/6b221814408fff0db1c489870df79575/fad48/wordcloud-from-tags.webp 1600w\"\n              sizes=\"(max-width: 800px) 100vw, 800px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/6b221814408fff0db1c489870df79575/772e8/wordcloud-from-tags.png 200w,\n/static/6b221814408fff0db1c489870df79575/e17e5/wordcloud-from-tags.png 400w,\n/static/6b221814408fff0db1c489870df79575/5a190/wordcloud-from-tags.png 800w,\n/static/6b221814408fff0db1c489870df79575/c1b63/wordcloud-from-tags.png 1200w,\n/static/6b221814408fff0db1c489870df79575/29007/wordcloud-from-tags.png 1600w\"\n            sizes=\"(max-width: 800px) 100vw, 800px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/6b221814408fff0db1c489870df79575/5a190/wordcloud-from-tags.png\"\n            alt=\"wordcloud from tags\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span>\n<br/></p>\n<h2 id=\"処理概要\" style=\"position:relative;\"><a href=\"#%E5%87%A6%E7%90%86%E6%A6%82%E8%A6%81\" aria-label=\"処理概要 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>処理概要</h2>\n<p>Gatsbyを使う場合、画面に必要なデータはビルド時に生成するのがベーシックなやり方です。\nそのためSVG生成は、表示時のReactコンポーネントではなくビルド時の処理（gatsby-node.js）にて行いました。\nビルドはNode.jsの世界ですから、前回記事の<a href=\"https://github.com/Takumon/playbox2019/blob/master/node-kuromoji-d3cloud-sample/index.js\">Node.jsでWordCloudのSVG画像を出力するサンプル</a>が、ほぼそのまま使えるわけです。サンプルと、Gatsbyビルド処理のお作法（gatsby-node.jsの書き方）を考慮して以下のような手順でSVG画像のデータを生成します。</p>\n<ul>\n<li>\n<p>記事全文のWordCloud生成</p>\n<ul>\n<li>記事全文を取得 ☚Gatsbyビルド処理のお作法</li>\n<li>記事全文をインプットにkuromoji.jsで形態素解析</li>\n<li>解析結果をインプットにD3-Cloudでフォーマット</li>\n<li>解析結果をインプットにd3.jsでSVG文字列生成</li>\n<li>Gatsbyページ生成時にContextのプロパティとして渡す ☚Gatsbyビルド処理のお作法</li>\n</ul>\n</li>\n<li>\n<p>記事全タグのWordCloud生成</p>\n<ul>\n<li>記事全タグを取得 ☚Gatsbyビルド処理のお作法</li>\n<li>記事全タグをインプットにタグ出現回数を算出</li>\n<li>解析結果をインプットにD3-Cloudでフォーマット</li>\n<li>解析結果をインプットにd3.jsでSVG文字列生成</li>\n<li>Gatsbyページ生成時にContextのプロパティとして渡す ☚Gatsbyビルド処理のお作法</li>\n</ul>\n</li>\n</ul>\n<p>そして表示時にコンポーネントでSVGデータを取得し画面に表示します。</p>\n<h2 id=\"処理のチューニングポイント\" style=\"position:relative;\"><a href=\"#%E5%87%A6%E7%90%86%E3%81%AE%E3%83%81%E3%83%A5%E3%83%BC%E3%83%8B%E3%83%B3%E3%82%B0%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88\" aria-label=\"処理のチューニングポイント permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>処理のチューニングポイント</h2>\n<p>WordCloudの品質を上げるために以下のようなチューニングを実施しました。</p>\n<ul>\n<li>「Gatsby」[gatsby」などは同じ単語とみなしてカウントしています。\n<ul>\n<li>文章中で前後文脈によって大文字小文字の差があるものは、同じ単語としてカウントしています。</li>\n<li>最終的にWordCloudに表示する単語は一番大文字の数が多い単語（「Gatsby」[gatsby」なら「Gatsby」）を採用するようにしました。</li>\n</ul>\n</li>\n<li>記事全文は、マークダウンではなくHTMLをインプットにして、HTMLタグを除外、さらにpreタグは中身ごと除外してから形態素解析のインプットとして渡しています。\n<ul>\n<li>マークダウンはリンク、スタイルなどメタ情報が多いため、いったんHTMLに変換したものからHTMLタグを抜くことで純粋な文書だけを抽出しています。</li>\n<li>またソースコードには同じような表現が多く含まれ、WordCloudの対象にするにはノイズが大きく、大事な単語であればソースコード外の文章中に出てくるという前提のもと、ソースコードはすべて除外しています</li>\n<li>「時」「場合」など言い回しとして何度も出てくる単語はWordCloudの情報にしても意味がないので除外しています。</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"処理詳細実装\" style=\"position:relative;\"><a href=\"#%E5%87%A6%E7%90%86%E8%A9%B3%E7%B4%B0%E5%AE%9F%E8%A3%85\" aria-label=\"処理詳細実装 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>処理詳細（実装）</h2>\n<p>ちょっと長いですが、\nソースコード中のコメントにて詳細を説明します。</p>\n<div class=\"gatsby-code-title\">gatsby-node.jsからWordCloud生成処理抜粋</div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token comment\">/** HTML形式の記事本文からHTMLタグを削除するために使う */</span>\n<span class=\"token keyword\">const</span> striptags <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'striptags'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">/** 仮想DOM d3.js D3-CloudはDOMがある前提なのでNode.js実行時でも正常動作するように仮想Canvasを使う */</span>\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> createCanvas <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'canvas'</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">/** 仮想DOM d3.js D3-CloudはDOMがある前提なのでNode.js実行時でも正常動作するように仮想DOMを使う */</span>\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> <span class=\"token constant\">JSDOM</span> <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'jsdom'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">/** 形態素解析のために使う */</span>\n<span class=\"token keyword\">const</span> kuromoji <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'kuromoji'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">/** WordCloudのSVG文字列作成用 */</span>\n<span class=\"token keyword\">const</span> d3 <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'d3'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">/** WordCloudのSVG文字列作成用 */</span>\n<span class=\"token keyword\">const</span> cloud <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'d3-cloud'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">/** createPageにてWordCloud生成処理を実装する */</span>\nexports<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">createPages</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> graphql<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> createPage <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resolve<span class=\"token punctuation\">,</span> reject</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token comment\">/** (略)ページコンポーネント呼び出し */</span>\n\n    <span class=\"token function\">graphql</span><span class=\"token punctuation\">(</span><span class=\"token comment\">/** (略)記事情報呼び出しクエリ */</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">result</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\n      <span class=\"token comment\">/** (略)もろもろのページ作成 */</span>\n\n\n      <span class=\"token comment\">// WordCloud用データ加工処理</span>\n\n      <span class=\"token comment\">/** (略)resultから記事全文の配列(allPostHtmlTexts)を取得する処理 */</span>\n\n      <span class=\"token comment\">// 記事全文文字列取得</span>\n      <span class=\"token keyword\">const</span> allPostTexts <span class=\"token operator\">=</span> allPostHtmlTexts\n        <span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">allHtmlTexts</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n          <span class=\"token comment\">// HTML文字列からタグを除外</span>\n          <span class=\"token comment\">// ただしpreタグは、中身をWordCloud解析対象外とするためここではあえて残している</span>\n          <span class=\"token keyword\">const</span> stripedAllText <span class=\"token operator\">=</span> <span class=\"token function\">striptags</span><span class=\"token punctuation\">(</span>allHtmlTexts<span class=\"token punctuation\">,</span> <span class=\"token string\">'&lt;pre>'</span><span class=\"token punctuation\">)</span>\n\n          <span class=\"token comment\">// そのためpreタグとその中身を除外する。</span>\n          <span class=\"token comment\">// preタグの中見はソースコード。</span>\n          <span class=\"token comment\">// キーワードはソースコード外の文章中に記述していることを想定して</span>\n          <span class=\"token comment\">// WordCloudの対象から外す。</span>\n          <span class=\"token keyword\">return</span> <span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">&lt;pre[\\s\\S]+?>[\\s\\S]+?&lt;\\/pre></span><span class=\"token regex-delimiter\">/</span><span class=\"token regex-flags\">g</span></span><span class=\"token punctuation\">,</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">trim</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n        <span class=\"token comment\">// 改行でつなぐ</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\n'</span><span class=\"token punctuation\">)</span>\n      \n\n      <span class=\"token comment\">/** (略)resultから記事全タグの配列(allPostTags)を取得する処理 */</span>\n\n      <span class=\"token comment\">// 記事タグ取得</span>\n      <span class=\"token keyword\">const</span> tagDatas <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n\n      <span class=\"token comment\">// 記事全タグ情報からどのタグが何回出現するか算出</span>\n      allPostTags<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">tags</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        tags<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">t</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\n          <span class=\"token keyword\">const</span> targetData <span class=\"token operator\">=</span> tagDatas<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">data</span> <span class=\"token operator\">=></span> data<span class=\"token punctuation\">.</span>text <span class=\"token operator\">===</span> t<span class=\"token punctuation\">)</span>\n          <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>targetData<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            targetData<span class=\"token punctuation\">.</span>size <span class=\"token operator\">=</span> targetData<span class=\"token punctuation\">.</span>size <span class=\"token operator\">+</span> <span class=\"token number\">1</span>\n          <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n            tagDatas<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n              <span class=\"token literal-property property\">text</span><span class=\"token operator\">:</span> t<span class=\"token punctuation\">,</span>\n              <span class=\"token literal-property property\">size</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n\n      <span class=\"token comment\">// タグ出現回数をインプットにWordCloud生成</span>\n      <span class=\"token comment\">// タグ情報の場合形態素解析せずとも単語ごとの出現回数が算出できるので</span>\n      <span class=\"token comment\">// 形態素解析はスキップしている</span>\n      <span class=\"token function\">createWordCloud</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        <span class=\"token literal-property property\">words</span><span class=\"token operator\">:</span> tagDatas<span class=\"token punctuation\">,</span>\n        <span class=\"token literal-property property\">w</span><span class=\"token operator\">:</span> <span class=\"token number\">1200</span><span class=\"token punctuation\">,</span>\n        <span class=\"token literal-property property\">h</span><span class=\"token operator\">:</span> <span class=\"token number\">630</span><span class=\"token punctuation\">,</span>\n        <span class=\"token literal-property property\">fontSizePow</span><span class=\"token operator\">:</span> <span class=\"token number\">0.8</span><span class=\"token punctuation\">,</span>\n        <span class=\"token literal-property property\">fontSizeZoom</span><span class=\"token operator\">:</span> <span class=\"token number\">18</span><span class=\"token punctuation\">,</span>\n        <span class=\"token literal-property property\">padding</span><span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">tagSvg</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// タグをインプットにしたSVGが出来上がる</span>\n\n        <span class=\"token comment\">// 記事全文文字列をインプットに単語出現回数を算出</span>\n        <span class=\"token function\">createWordCount</span><span class=\"token punctuation\">(</span>alltext<span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">data</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\n            <span class=\"token comment\">// 記事全文の単語出現回数をインプットにWordCloud生成</span>\n            <span class=\"token keyword\">return</span> <span class=\"token function\">createWordCloud</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n              <span class=\"token literal-property property\">words</span><span class=\"token operator\">:</span> data<span class=\"token punctuation\">,</span>\n              <span class=\"token literal-property property\">w</span><span class=\"token operator\">:</span> <span class=\"token number\">1200</span><span class=\"token punctuation\">,</span>\n              <span class=\"token literal-property property\">h</span><span class=\"token operator\">:</span> <span class=\"token number\">630</span><span class=\"token punctuation\">,</span>\n              <span class=\"token literal-property property\">fontSizePow</span><span class=\"token operator\">:</span> <span class=\"token number\">0.6</span><span class=\"token punctuation\">,</span>\n              <span class=\"token literal-property property\">fontSizeZoom</span><span class=\"token operator\">:</span> <span class=\"token number\">3.1</span><span class=\"token punctuation\">,</span>\n              <span class=\"token literal-property property\">padding</span><span class=\"token operator\">:</span> <span class=\"token number\">0.2</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">textSvg</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// 記事全文をインプットにしたSVGが出来上がる</span>\n\n            <span class=\"token comment\">// ページ生成時にSVGをContextのプロパティとして渡す</span>\n            <span class=\"token function\">createPage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n              <span class=\"token literal-property property\">path</span><span class=\"token operator\">:</span> <span class=\"token string\">'/map/'</span><span class=\"token punctuation\">,</span>\n              <span class=\"token literal-property property\">component</span><span class=\"token operator\">:</span> postRelationMapPage<span class=\"token punctuation\">,</span>\n              <span class=\"token literal-property property\">context</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n                allPostRelations<span class=\"token punctuation\">,</span>\n                <span class=\"token literal-property property\">wordCloudText</span> <span class=\"token operator\">:</span> textSvg<span class=\"token punctuation\">,</span>\n                <span class=\"token literal-property property\">wordCloudTag</span><span class=\"token operator\">:</span> tagSvg<span class=\"token punctuation\">,</span>\n              <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n            <span class=\"token comment\">// すべてのcreatePageを呼び終わったあとにresolveを呼んで処理終了</span>\n            <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token string\">'OK'</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">/**\n * ２つの単語の大文字小文字の違いをカウントする\n */</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">countDiff</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">a<span class=\"token punctuation\">,</span> b</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> a\n    <span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">charA<span class=\"token punctuation\">,</span> i</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> charA <span class=\"token operator\">===</span> b<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">?</span> <span class=\"token number\">0</span> <span class=\"token operator\">:</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">reduce</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">a<span class=\"token punctuation\">,</span> b</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> a <span class=\"token operator\">+</span> b<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n\n<span class=\"token comment\">/**\n * 指定した文字列を形態素解析して単語ごとの出現回数を返す\n */</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">createWordCount</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">text</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token comment\">// よく出る言い回しでWordCloudから除外したい単語を列挙  </span>\n  <span class=\"token keyword\">const</span> excludeWords <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token string\">'指定'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'時'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'追加'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">/** (略)除外したい単語 */</span>\n  <span class=\"token punctuation\">]</span>\n\n\n  <span class=\"token comment\">/** kuromoji.jsにバンドルされている辞書の格納場所 */</span>\n  <span class=\"token keyword\">const</span> <span class=\"token constant\">DIC_URL</span> <span class=\"token operator\">=</span> <span class=\"token string\">'node_modules/kuromoji/dict'</span>\n\n  <span class=\"token comment\">/** WordCloudでカウントする品詞（助詞・助動詞などは省く） */</span>\n  <span class=\"token keyword\">const</span> <span class=\"token constant\">TARGET_POS</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'名詞'</span><span class=\"token punctuation\">]</span>\n\n  <span class=\"token comment\">/** kuromoji.jsで該当プロパティの値が存在しない場合に設定されている値 */</span>\n  <span class=\"token keyword\">const</span> <span class=\"token constant\">NO_CONTENT</span> <span class=\"token operator\">=</span> <span class=\"token string\">'*'</span>\n\n  <span class=\"token comment\">// kuromoji.jsで形態素解析</span>\n  <span class=\"token comment\">// 単語ごとの出現回数を出力</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resolve<span class=\"token punctuation\">,</span> reject</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\n    kuromoji<span class=\"token punctuation\">.</span><span class=\"token function\">builder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">dicPath</span><span class=\"token operator\">:</span> <span class=\"token constant\">DIC_URL</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">err<span class=\"token punctuation\">,</span> tokenizer</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token function\">reject</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span>\n\n      <span class=\"token comment\">// 単語ごとの出現回数を出力</span>\n      <span class=\"token keyword\">const</span> words <span class=\"token operator\">=</span> tokenizer<span class=\"token punctuation\">.</span><span class=\"token function\">tokenize</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">t</span> <span class=\"token operator\">=></span> <span class=\"token constant\">TARGET_POS</span><span class=\"token punctuation\">.</span><span class=\"token function\">includes</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">.</span>pos<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">t</span> <span class=\"token operator\">=></span> t<span class=\"token punctuation\">.</span>basic_form <span class=\"token operator\">===</span> <span class=\"token constant\">NO_CONTENT</span> <span class=\"token operator\">?</span> t<span class=\"token punctuation\">.</span>surface_form <span class=\"token operator\">:</span> t<span class=\"token punctuation\">.</span>basic_form<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">reduce</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">data<span class=\"token punctuation\">,</span> text</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n          <span class=\"token comment\">// 大文字と小文字を区別せず出現回数をカウントする</span>\n          <span class=\"token keyword\">const</span> upperText <span class=\"token operator\">=</span> text<span class=\"token punctuation\">.</span><span class=\"token function\">toUpperCase</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n          <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>excludeWords<span class=\"token punctuation\">.</span><span class=\"token function\">includes</span><span class=\"token punctuation\">(</span>upperText<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">return</span> data\n          <span class=\"token punctuation\">}</span>\n\n          <span class=\"token keyword\">const</span> target <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">c</span> <span class=\"token operator\">=></span> c<span class=\"token punctuation\">.</span>text <span class=\"token operator\">===</span> upperText<span class=\"token punctuation\">)</span>\n\n          <span class=\"token comment\">// 出現回数は大文字小文字を区別しないが、実際の生の単語は後の処理で使うためとっておく</span>\n          <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>target<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            target<span class=\"token punctuation\">.</span>size <span class=\"token operator\">=</span> target<span class=\"token punctuation\">.</span>size <span class=\"token operator\">+</span> <span class=\"token number\">1</span>\n            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>target<span class=\"token punctuation\">.</span>rawTexts<span class=\"token punctuation\">.</span><span class=\"token function\">includes</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n              target<span class=\"token punctuation\">.</span>rawTexts<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">}</span>\n          <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n            data<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n              <span class=\"token literal-property property\">text</span><span class=\"token operator\">:</span> upperText<span class=\"token punctuation\">,</span>\n              <span class=\"token literal-property property\">rawTexts</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span> text <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n              <span class=\"token literal-property property\">size</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">}</span>\n          <span class=\"token keyword\">return</span> data\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">data</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\n          <span class=\"token comment\">// 上記処理で保持しておいた生の単語をもとに、一番大文字が多い単語をWordCloudの単語として採用する</span>\n          <span class=\"token comment\">// 例えばGatsbyとgatsbyであればGatsbyを採用</span>\n          <span class=\"token keyword\">const</span> almostSameText <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span>rawTexts<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">text</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n              <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n                text<span class=\"token punctuation\">,</span>\n                <span class=\"token literal-property property\">diff</span><span class=\"token operator\">:</span> <span class=\"token function\">countDiff</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n              <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">reduce</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">a<span class=\"token punctuation\">,</span> b</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> a<span class=\"token punctuation\">.</span>diff <span class=\"token operator\">&lt;=</span> b<span class=\"token punctuation\">.</span>diff <span class=\"token operator\">?</span> a <span class=\"token operator\">:</span> b<span class=\"token punctuation\">)</span> <span class=\"token comment\">// 大文字に近いほうを採用する</span>\n            <span class=\"token punctuation\">.</span>text\n          \n          <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token literal-property property\">text</span><span class=\"token operator\">:</span> almostSameText<span class=\"token punctuation\">,</span>\n            <span class=\"token literal-property property\">size</span><span class=\"token operator\">:</span> data<span class=\"token punctuation\">.</span>size<span class=\"token punctuation\">,</span>\n          <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n      <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>words<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">/**\n * 単語出現回数をもとにWordCloudのSVG文字列を返す\n */</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">createWordCloud</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  words<span class=\"token punctuation\">,</span> <span class=\"token comment\">// 単語出現回数</span>\n  w<span class=\"token punctuation\">,</span> <span class=\"token comment\">// SVGの幅(単位px)</span>\n  h<span class=\"token punctuation\">,</span> <span class=\"token comment\">// SVGの高さ(単位px)</span>\n  fontSizePow<span class=\"token punctuation\">,</span> <span class=\"token comment\">// WordCloudの文字の大きさの比率調整用係数</span>\n  fontSizeZoom<span class=\"token punctuation\">,</span> <span class=\"token comment\">// WordCloudの文字の大きさの係数</span>\n  padding<span class=\"token punctuation\">,</span> <span class=\"token comment\">// WordCloudの文字間の隙間</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token comment\">// D3-Cloudによる解析</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resolve<span class=\"token punctuation\">,</span> reject</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">cloud</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>w<span class=\"token punctuation\">,</span> h<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">canvas</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">createCanvas</span><span class=\"token punctuation\">(</span>w<span class=\"token punctuation\">,</span> h<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">words</span><span class=\"token punctuation\">(</span>words<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">rotate</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">word</span> <span class=\"token operator\">=></span> word<span class=\"token punctuation\">.</span>size <span class=\"token operator\">%</span> <span class=\"token number\">2</span> <span class=\"token operator\">===</span> <span class=\"token number\">1</span> <span class=\"token operator\">?</span> <span class=\"token number\">0</span> <span class=\"token operator\">:</span> <span class=\"token number\">90</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// 出現回数に応じて縦か横向きに表示</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">fontWeight</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">word</span> <span class=\"token operator\">=></span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">pow</span><span class=\"token punctuation\">(</span>word<span class=\"token punctuation\">.</span>size<span class=\"token punctuation\">,</span> fontSizePow<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> fontSizeZoom<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">fontSize</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">word</span> <span class=\"token operator\">=></span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">pow</span><span class=\"token punctuation\">(</span>word<span class=\"token punctuation\">.</span>size<span class=\"token punctuation\">,</span> fontSizePow<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> fontSizeZoom<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">font</span><span class=\"token punctuation\">(</span><span class=\"token string\">'meiryo'</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">padding</span><span class=\"token punctuation\">(</span>padding<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'end'</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">wordsForCloud</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\n        <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>wordsForCloud<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token comment\">// d3.jsによる解析</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">wordsForCloud</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resolve<span class=\"token punctuation\">,</span> reject</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">/** 仮想DOM */</span>\n      <span class=\"token keyword\">const</span> document <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">JSDOM</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">&lt;body>&lt;/body></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>window<span class=\"token punctuation\">.</span>document\n\n      d3<span class=\"token punctuation\">.</span><span class=\"token function\">select</span><span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">'svg'</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'class'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'ui fluid image'</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'viewBox'</span><span class=\"token punctuation\">,</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">0 0 </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>w<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>h<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'width'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'100%'</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'height'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'100%'</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">'g'</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'transform'</span><span class=\"token punctuation\">,</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">translate(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>w<span class=\"token operator\">/</span><span class=\"token number\">2</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">,</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>h<span class=\"token operator\">/</span><span class=\"token number\">2</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">)</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">selectAll</span><span class=\"token punctuation\">(</span><span class=\"token string\">'text'</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">data</span><span class=\"token punctuation\">(</span>wordsForCloud<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">enter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">'text'</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">style</span><span class=\"token punctuation\">(</span><span class=\"token string\">'font-size'</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">d</span> <span class=\"token operator\">=></span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>d<span class=\"token punctuation\">.</span>size<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">style</span><span class=\"token punctuation\">(</span><span class=\"token string\">'font-family'</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">d</span> <span class=\"token operator\">=></span> d<span class=\"token punctuation\">.</span>font<span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'transform'</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">d</span> <span class=\"token operator\">=></span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">translate(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>d<span class=\"token punctuation\">.</span>x<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">, </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>d<span class=\"token punctuation\">.</span>y<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">)rotate(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>d<span class=\"token punctuation\">.</span>rotate<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">)</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">style</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fill'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">d<span class=\"token punctuation\">,</span> i</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> d3<span class=\"token punctuation\">.</span>schemeCategory10<span class=\"token punctuation\">[</span>i <span class=\"token operator\">%</span> <span class=\"token number\">10</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'text-anchor'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'middle'</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">text</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">d</span> <span class=\"token operator\">=></span> d<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span>\n      \n      <span class=\"token comment\">// 最終的にSVGの文字列を返す</span>\n      <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>innerHTML<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<br/>\n<h2 id=\"まとめ\" style=\"position:relative;\"><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\" aria-label=\"まとめ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>まとめ</h2>\n<p>自分のブログにWordCloudを導入したいと思い立ち、WordCloudについて3回にわたりブログを書いてきましたが、各種ライブラリのおかげで、すんなりと導入できました。\n人に自分のブログを紹介するときのネタとしてはとても効果的だと思います。<br/>\nなお形態素解析やWordCloud生成は重い処理なので、ビルドに時間がかかるようになってしまいますが、画面表示に関してはパフォーマンスに影響はありません。<br/>\nあと本来であればプラグイン化して配布したいところですが、プラグイン化のためには、まだまだ汎用性を高る必要があって、それは今後の課題です🍅</p>","excerpt":"なにこれ 前回記事ではNode.jsでWordCloudを出力しました。\n今回は、前回のサンプルをベースに自分のブログ（Gatsby製のブログ）にWordCloudを取り入れてみたので、その時の実装方法のメモです。 ※ソースコードは以下です。\nhttps://github.com…","frontmatter":{"slug":"/wordcloud-in-gatsby-blog","title":"Gatsby製ブログにWordCloudを導入","date":"2019-05-11T17:00:00.000+09:00","tags":["Gatsby","kuromoji.js","d3.js","d3Cloud","形態素解析","データ可視化","WordCloud"],"keywords":["Gatsby"],"thumbnail":"thumbnail/2019/05/wordcloud-in-gatsby-blog.png","category":null}},{"html":"<h2 id=\"なにこれ\" style=\"position:relative;\"><a href=\"#%E3%81%AA%E3%81%AB%E3%81%93%E3%82%8C\" aria-label=\"なにこれ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>なにこれ</h2>\n<p><a href=\"/wordcloud-with-kuromoji-d3cloud-react\">前回記事</a>ではReactでWordCloudを出力しました。しかし実際は、過去大量データから出力するようなツールとして使えたほうが便利です。\nそこで<a href=\"https://github.com/Takumon/playbox2019/blob/master/react-kuromoji-sample/src/App.js\">前回のサンプル</a>をベースにNode.jsでWordCloudのSVGファイルを出力するサンプルを作成しました。\n今回はサンプルの実装方法をポイントと合わせてご紹介します。</p>\n<p>※サンプルは以下に置いております。\n<a href=\"https://github.com/Takumon/playbox2019/blob/master/node-kuromoji-d3cloud-sample/index.js\">https://github.com/Takumon/playbox2019/blob/master/node-kuromoji-d3cloud-sample/index.js</a></p>\n<p>この記事は、<a href=\"https://gw-advent.9wick.com/calendars/9\">challenge-every-month全員でアウトプット芸人 Advent Calendar</a> 9日目の記事です。前日の記事は、<a href=\"https://twitter.com/kojirock5260\">@kojirock5260</a>さんの記事でした。</p>\n<iframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fkojirooooocks.hatenablog.com%2Fentry%2F2019%2F05%2F04%2F163742\" style=\"border: 0; width: 100%; height: 190px;\" allowfullscreen scrolling=\"no\" allow=\"autoplay; encrypted-media\"></iframe>\n<h2 id=\"処理手順\" style=\"position:relative;\"><a href=\"#%E5%87%A6%E7%90%86%E6%89%8B%E9%A0%86\" aria-label=\"処理手順 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>処理手順</h2>\n<p>以下4ステップです。</p>\n<ol>\n<li>kuromoji.jsで文章を解析して単語出現回数をデータ化</li>\n<li>D3-Cloudで上記データに以下情報追加\n<ol>\n<li>フォントの大きさ</li>\n<li>フォントの回転位置</li>\n<li>フォントの種類</li>\n<li>表示位置</li>\n</ol>\n</li>\n<li>d3.jsで配色を決定しSVGを<strong>仮想DOM</strong>に描画</li>\n<li>SVGをファイル出力</li>\n</ol>\n<h2 id=\"実装のポイント\" style=\"position:relative;\"><a href=\"#%E5%AE%9F%E8%A3%85%E3%81%AE%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88\" aria-label=\"実装のポイント permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>実装のポイント</h2>\n<h3 id=\"1-d3-cloud--canvasだけでは不十分なのでd3jsを使う\" style=\"position:relative;\"><a href=\"#1-d3-cloud--canvas%E3%81%A0%E3%81%91%E3%81%A7%E3%81%AF%E4%B8%8D%E5%8D%81%E5%88%86%E3%81%AA%E3%81%AE%E3%81%A7d3js%E3%82%92%E4%BD%BF%E3%81%86\" aria-label=\"1 d3 cloud  canvasだけでは不十分なのでd3jsを使う permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. D3-Cloud + Canvasだけでは不十分なのでd3.jsを使う</h3>\n<p>最初は、D3-CloudでCanvasを使えるので、<a href=\"https://github.com/Automattic/node-canvas\">node-canvas</a>を使えばNode.jsでも画像を生成できるのでは？と考えたのですが、やってみるとうまくいきません。以下のような画像が出力されます。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/4538ff67e1815ab50581a395af5a3b88/5a3c9/wordcloud-by-canvas.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 68.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAABcRAAAXEQHKJvM/AAACWUlEQVR42k1STU/bQBD1//8DVVWp4siNA1GtVM2BA+IAAQJyQrCTTZzYcbJe25sQgnGWV73dumBpvLPz8ebNzHqi3/9enJ721knySw6Hvry48GWS+PLkxJfdri+XS19mmS/nc1/e3fny7MyXk4kvN5v/duYWj49/xkHw09OLRYCrK6AsDfZ7QAigroF+H8gy4HgE8hy4vgYOB2C9BpoGeH9352YDvLwY9HpQURR6VZ4/AoAxpjH7vTHHo7EfTa20H/XDwZi6NqYoXGyWGZMkDZZL5Gk69vTlZYDBgNUNhkNWA7QGlIK9SwnMZsDTEzAew8bSdnPjYpZL+mx3SuvQ01oHZIjj0Vg+/NLUtb5YAFHkgJnI1tsYlwPsdrZB/pRSoaejKLDz0NrYGTGhZUidjDmrsnSAjKWvqoDt1s2buR8fUEURelqIwFbabg3e3lxgkrjhM5ktTqfuTjYuFnh9dWAEl/ILw+EwsM6qMigKx46gPJlIIRgZUufmWZg6R0M7c+saKklCT9/fO4arlcFk4gZPRpzZfP7ZWgsQhq71tm0+td3OAUoZeno0cjOMY2NBCErhUuLYtcmTgO1WuSxunoV5JonBagU1Gv1jyMf5/GxsAFkxyQWSuQMkCKX100edPpIpS6jxOPS2Qgws9TStIWWDNG2wWPChNuCDpWRZY3153qAonE6bUg2qqkFZ1uxAxfHI03HsWuam2BIXQ2ER3lsbh09pZ9fenW5fiJrNQi++vf32IsTvMorOq8mkUwnRqabTT+GddspXW3vO551SiPPdbNYVDw8//gJnIRX3lkjjHwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/4538ff67e1815ab50581a395af5a3b88/ba381/wordcloud-by-canvas.webp 200w,\n/static/4538ff67e1815ab50581a395af5a3b88/7f61c/wordcloud-by-canvas.webp 400w,\n/static/4538ff67e1815ab50581a395af5a3b88/d00b9/wordcloud-by-canvas.webp 800w,\n/static/4538ff67e1815ab50581a395af5a3b88/e28de/wordcloud-by-canvas.webp 1169w\"\n              sizes=\"(max-width: 800px) 100vw, 800px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/4538ff67e1815ab50581a395af5a3b88/772e8/wordcloud-by-canvas.png 200w,\n/static/4538ff67e1815ab50581a395af5a3b88/e17e5/wordcloud-by-canvas.png 400w,\n/static/4538ff67e1815ab50581a395af5a3b88/5a190/wordcloud-by-canvas.png 800w,\n/static/4538ff67e1815ab50581a395af5a3b88/5a3c9/wordcloud-by-canvas.png 1169w\"\n            sizes=\"(max-width: 800px) 100vw, 800px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/4538ff67e1815ab50581a395af5a3b88/5a190/wordcloud-by-canvas.png\"\n            alt=\"wordcloud by canvas\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>そのためD3-Cloud + Canvasだけの組み合わせはあきらめて、\n<a href=\"https://github.com/Yoctol/react-d3-cloud\">react-d3-cloud</a>の内部実装と同じようにd3.jsを使ってSVGを描画して、そこからファイル出力処理するようにしました。</p>\n<h3 id=\"2-domエミュレート用にnode-canvasとjsdomを使う\" style=\"position:relative;\"><a href=\"#2-dom%E3%82%A8%E3%83%9F%E3%83%A5%E3%83%AC%E3%83%BC%E3%83%88%E7%94%A8%E3%81%ABnode-canvas%E3%81%A8jsdom%E3%82%92%E4%BD%BF%E3%81%86\" aria-label=\"2 domエミュレート用にnode canvasとjsdomを使う permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. DOMエミュレート用にnode-canvasとjsdomを使う</h3>\n<p><a href=\"https://github.com/d3/d3\">d3.js</a>は、ブラウザ上での動作を前提としているためDOMが必要です。Node.jsでDOMをエミュレートするために<a href=\"https://github.com/jsdom/jsdom\">jsdom</a>を使いました。<br/>\n<a href=\"https://github.com/jasondavies/d3-cloud\">D3-Cloud</a>も同様にCanvasの指定が必須です。\nそのためCanvasをエミュレートする<a href=\"https://github.com/Automattic/node-canvas\">node-canvas</a>を使いました。</p>\n<h2 id=\"実装\" style=\"position:relative;\"><a href=\"#%E5%AE%9F%E8%A3%85\" aria-label=\"実装 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>実装</h2>\n<p>ポイントを踏まえたうえで4ステップごとに実装方法を説明します。</p>\n<h3 id=\"1-kuromojijsで文章を解析して単語出現回数をデータ化\" style=\"position:relative;\"><a href=\"#1-kuromojijs%E3%81%A7%E6%96%87%E7%AB%A0%E3%82%92%E8%A7%A3%E6%9E%90%E3%81%97%E3%81%A6%E5%8D%98%E8%AA%9E%E5%87%BA%E7%8F%BE%E5%9B%9E%E6%95%B0%E3%82%92%E3%83%87%E3%83%BC%E3%82%BF%E5%8C%96\" aria-label=\"1 kuromojijsで文章を解析して単語出現回数をデータ化 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. kuromoji.jsで文章を解析して単語出現回数をデータ化</h3>\n<p>kuromoji.jsによるデータ加工については<a href=\"/wordcloud-with-kuromoji-d3cloud-react#1-%E6%96%87%E7%AB%A0%E3%82%92%E8%A7%A3%E6%9E%90%E3%81%97%E3%81%A6%E5%8D%98%E8%AA%9E%E5%87%BA%E7%8F%BE%E5%9B%9E%E6%95%B0%E3%82%92%E3%83%87%E3%83%BC%E3%82%BF%E5%8C%96-1\">前回記事のReactアプリ</a>と同様です。\n今回はブラウザではなくNode.jsで動かすのでkuromoji.jsの辞書はnode_modules配下から移動する必要はありません。</p>\n<div class=\"gatsby-code-title\">kuromoji.jsによる解析処理</div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> kuromoji <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'kuromoji'</span><span class=\"token punctuation\">)</span>\n\n\n<span class=\"token comment\">// インプットとなる文章(長文につき一部省略)</span>\n<span class=\"token keyword\">const</span> text <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\nそこも場合もうその病気らに対して旨の時がしんませ。\n単に事実に使用方はどうかその応用たないでもが思いてならないがも発展思いうべきて、\nあいにくにもなるだなですた。\n・・・\n</span><span class=\"token template-punctuation string\">`</span></span>\n\n<span class=\"token comment\">// kuromoji.jsにバンドルされている辞書のフォルダパス</span>\n<span class=\"token comment\">// kuromoji.jsは形態素解析用関数を生成する際に辞書を読み込む</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">DIC_URL</span> <span class=\"token operator\">=</span> <span class=\"token string\">'node_modules/kuromoji/dict'</span>\n\n<span class=\"token comment\">// WordCloudの情報として抽出する品詞（助詞、助動詞などは意味がないので拾わない）</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">TARGET_POS</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'名詞'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'動詞'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'形容詞'</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token comment\">// kuromoji.jsの解析結果の値で特に値がない場合は以下の文字が設定される</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">NO_CONTENT</span> <span class=\"token operator\">=</span> <span class=\"token string\">'*'</span>\n\n\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token comment\">// kuromoji.jsによる解析処理</span>\n  <span class=\"token keyword\">const</span> words <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resolve<span class=\"token punctuation\">,</span> reject</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// 辞書を読み混んでトークナイザー（形態素解析するための関数）を生成</span>\n    kuromoji<span class=\"token punctuation\">.</span><span class=\"token function\">builder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">dicPath</span><span class=\"token operator\">:</span> <span class=\"token constant\">DIC_URL</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">err<span class=\"token punctuation\">,</span> tokenizer</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token function\">reject</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span>\n\n      <span class=\"token comment\">// テキストを引数にして形態素解析</span>\n      <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>tokenizer<span class=\"token punctuation\">.</span><span class=\"token function\">tokenize</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">)</span>\n        <span class=\"token comment\">// pos（品詞）を参照し、'名詞', '動詞', '形容詞'のみを抽出</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">t</span> <span class=\"token operator\">=></span> <span class=\"token constant\">TARGET_POS</span><span class=\"token punctuation\">.</span><span class=\"token function\">includes</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">.</span>pos<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token comment\">// 単語を抽出(basic_formかsurface_formに単語が存在する)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">t</span> <span class=\"token operator\">=></span> t<span class=\"token punctuation\">.</span>basic_form <span class=\"token operator\">===</span> <span class=\"token constant\">NO_CONTENT</span> <span class=\"token operator\">?</span> t<span class=\"token punctuation\">.</span>surface_form <span class=\"token operator\">:</span> t<span class=\"token punctuation\">.</span>basic_form<span class=\"token punctuation\">)</span>\n        <span class=\"token comment\">// [{text: 単語, size: 出現回数}]の形にReduce</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">reduce</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">data<span class=\"token punctuation\">,</span> text</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n          <span class=\"token keyword\">const</span> target <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">c</span> <span class=\"token operator\">=></span> c<span class=\"token punctuation\">.</span>text <span class=\"token operator\">===</span> text<span class=\"token punctuation\">)</span>\n\n          <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>target<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            target<span class=\"token punctuation\">.</span>size <span class=\"token operator\">=</span> target<span class=\"token punctuation\">.</span>size <span class=\"token operator\">+</span> <span class=\"token number\">1</span>\n          <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n            data<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n              text<span class=\"token punctuation\">,</span>\n              <span class=\"token literal-property property\">size</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">}</span>\n          <span class=\"token keyword\">return</span> data\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n\n  <span class=\"token comment\">// D3-Cloudによる解析処理</span>\n  <span class=\"token comment\">// (略)</span>\n\n  <span class=\"token comment\">// d3.jsによる描画処理</span>\n  <span class=\"token comment\">// (略)</span>\n\n  <span class=\"token comment\">// SVGファイル出力処理</span>\n  <span class=\"token comment\">// (略)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<br/>\n<p>これで以下のような情報が得られます。</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token punctuation\">[</span> \n  <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">text</span><span class=\"token operator\">:</span> <span class=\"token string\">'相違'</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 単語</span>\n    <span class=\"token literal-property property\">size</span><span class=\"token operator\">:</span> <span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 出現回数</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<br/>\n<h3 id=\"2-d3-cloudで上記データに以下情報追加\" style=\"position:relative;\"><a href=\"#2-d3-cloud%E3%81%A7%E4%B8%8A%E8%A8%98%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AB%E4%BB%A5%E4%B8%8B%E6%83%85%E5%A0%B1%E8%BF%BD%E5%8A%A0\" aria-label=\"2 d3 cloudで上記データに以下情報追加 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. D3-Cloudで上記データに以下情報追加</h3>\n<p>D3-Cloudでは解析情報に以下を追加するだけです。</p>\n<ul>\n<li>フォントの回転位置 ☚自分で定義</li>\n<li>フォントの重み ☚自分で定義</li>\n<li>フォントの大きさ ☚自分で定義</li>\n<li>フォントの種類 ☚自分で定義</li>\n<li>表示位置 ☚D3-Cloudが定義してくれる</li>\n</ul>\n<p>なおD3-CloudはbodyタグかCanvasが必須なので、今回は<a href=\"https://github.com/Automattic/node-canvas\">node-canvas</a>を使います。</p>\n<div class=\"gatsby-code-title\">D3-Cloudによる解析処理</div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> cloud <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'d3-cloud'</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">// Node.jsでCanvasをエミュレートするためnode-canvasを使う</span>\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> createCanvas <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'canvas'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// Canvasの幅(px)</span>\n<span class=\"token keyword\">const</span> w <span class=\"token operator\">=</span> <span class=\"token number\">1600</span>\n\n<span class=\"token comment\">// Canvasの高さ(px)</span>\n<span class=\"token keyword\">const</span> h <span class=\"token operator\">=</span> <span class=\"token number\">1000</span>\n\n\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token comment\">// kuromoji.jsによる解析処理</span>\n  <span class=\"token comment\">// (略)</span>\n\n  <span class=\"token comment\">// D3-Cloudによる解析処理</span>\n  <span class=\"token comment\">// D3-Cloudの解析によってwordsForCloudには</span>\n  <span class=\"token comment\">// 出現回数の他にフォントの回転位置、大きさ、重み、種類が追加された状態になる</span>\n  <span class=\"token keyword\">const</span> wordsForCloud <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resolve</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">cloud</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>w<span class=\"token punctuation\">,</span> h<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// node-canvasを指定する(エラーを防ぐため)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">canvas</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">createCanvas</span><span class=\"token punctuation\">(</span>w<span class=\"token punctuation\">,</span> h<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// kuromoji.jsの解析結果を指定</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">words</span><span class=\"token punctuation\">(</span>words<span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// フォントの回転位置を指定</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">rotate</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">word</span> <span class=\"token operator\">=></span> word<span class=\"token punctuation\">.</span>size <span class=\"token operator\">%</span> <span class=\"token number\">2</span> <span class=\"token operator\">===</span> <span class=\"token number\">1</span> <span class=\"token operator\">?</span> <span class=\"token number\">0</span> <span class=\"token operator\">:</span> <span class=\"token number\">90</span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// フォントの重みを指定</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">fontWeight</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">word</span> <span class=\"token operator\">=></span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">pow</span><span class=\"token punctuation\">(</span>word<span class=\"token punctuation\">.</span>size<span class=\"token punctuation\">,</span> <span class=\"token number\">1.3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// フォントの大きさを指定</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">fontSize</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">word</span> <span class=\"token operator\">=></span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">pow</span><span class=\"token punctuation\">(</span>word<span class=\"token punctuation\">.</span>size<span class=\"token punctuation\">,</span> <span class=\"token number\">1.3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// フォントの種類を指定</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">font</span><span class=\"token punctuation\">(</span><span class=\"token string\">'meiryo'</span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// 加工終了時のイベント登録、解析結果をd3.jsでの描画に引き継ぐ</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'end'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">words</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>words<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// 解析開始</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token comment\">// d3.jsによる描画処理</span>\n  <span class=\"token comment\">// (略)</span>\n\n  <span class=\"token comment\">// SVGファイル出力処理</span>\n  <span class=\"token comment\">// (略)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<br/>\n<p>これで以下のような情報が得られます。</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">{</span> \n    <span class=\"token literal-property property\">text</span><span class=\"token operator\">:</span> <span class=\"token string\">'相違'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">size</span><span class=\"token operator\">:</span> <span class=\"token number\">19</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// D3-Cloudによって追加された情報</span>\n    <span class=\"token literal-property property\">font</span><span class=\"token operator\">:</span> <span class=\"token string\">'meiryo'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">style</span><span class=\"token operator\">:</span> <span class=\"token string\">'normal'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">weight</span><span class=\"token operator\">:</span> <span class=\"token number\">19.952623149688797</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">rotate</span><span class=\"token operator\">:</span> <span class=\"token number\">90</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">padding</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">width</span><span class=\"token operator\">:</span> <span class=\"token number\">64</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">height</span><span class=\"token operator\">:</span> <span class=\"token number\">59</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">xoff</span><span class=\"token operator\">:</span> <span class=\"token number\">192</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">yoff</span><span class=\"token operator\">:</span> <span class=\"token number\">957</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">x1</span><span class=\"token operator\">:</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">y1</span><span class=\"token operator\">:</span> <span class=\"token number\">28</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">x0</span><span class=\"token operator\">:</span> <span class=\"token operator\">-</span><span class=\"token number\">32</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">y0</span><span class=\"token operator\">:</span> <span class=\"token operator\">-</span><span class=\"token number\">22</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">hasText</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">x</span><span class=\"token operator\">:</span> <span class=\"token operator\">-</span><span class=\"token number\">199</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">y</span><span class=\"token operator\">:</span> <span class=\"token number\">294</span> \n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<br/>\n<h3 id=\"3-d3jsで配色を決定しsvgを仮想domに描画\" style=\"position:relative;\"><a href=\"#3-d3js%E3%81%A7%E9%85%8D%E8%89%B2%E3%82%92%E6%B1%BA%E5%AE%9A%E3%81%97svg%E3%82%92%E4%BB%AE%E6%83%B3dom%E3%81%AB%E6%8F%8F%E7%94%BB\" aria-label=\"3 d3jsで配色を決定しsvgを仮想domに描画 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. d3.jsで配色を決定しSVGを<strong>仮想DOM</strong>に描画</h3>\n<p>D3-Cloudの解析情報に文字色や配置情報を追加してSVGを仮想DOM上に描画します。\n仮想DOMは<a href=\"https://github.com/jsdom/jsdom\">jsdom</a>を使って生成します。<br/>\nフォント色のテーマは<code class=\"language-text\">schemeCategory10</code>を使いました。他にもいろいろテーマがあるようです。<br/>\n参考：<a href=\"https://wizardace.com/d3v5-scale-chromatic/\">D3.js v5 カラーテーマまとめ (d3-scale-chromatic) – データビジュアライゼーション・ラボ</a></p>\n<div class=\"gatsby-code-title\">d3.jsによるSVG描画処理</div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> d3 <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'d3'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> <span class=\"token constant\">JSDOM</span> <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"jsdom\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// 仮想documentオブジェクトを生成</span>\n<span class=\"token keyword\">const</span> document <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">JSDOM</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">&lt;body>&lt;/body></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>window<span class=\"token punctuation\">.</span>document\n\n<span class=\"token comment\">// WordCloud描画領域の幅(px) ※Canvasのやつを使いまわし</span>\n<span class=\"token keyword\">const</span> w <span class=\"token operator\">=</span> <span class=\"token number\">1600</span>\n\n<span class=\"token comment\">// WordCloud描画領域の高さ(px) ※Canvasのやつを使いまわし</span>\n<span class=\"token keyword\">const</span> h <span class=\"token operator\">=</span> <span class=\"token number\">1000</span>\n\n\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token comment\">// kuromoji.jsによる形態素解析</span>\n  <span class=\"token comment\">// (略)</span>\n\n  <span class=\"token comment\">// D3-Cloudによる解析処理</span>\n  <span class=\"token comment\">// (略)</span>\n\n  <span class=\"token comment\">// d3.jsによるSVG描画処理</span>\n  <span class=\"token comment\">// 仮想DOMのbodyタグを指定</span>\n  d3<span class=\"token punctuation\">.</span><span class=\"token function\">select</span><span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">)</span>\n    <span class=\"token comment\">// SVG形式で仮想DOMに描画</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">'svg'</span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// SVGのプロパティもろもろ指定</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'class'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'ui fluid image'</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'viewBox'</span><span class=\"token punctuation\">,</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">0 0 </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>w<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>h<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'width'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'100%'</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'height'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'100%'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token comment\">// SVGのグループ要素追加して</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">'g'</span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// SVGを中央寄せ</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'transform'</span><span class=\"token punctuation\">,</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">translate(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>w<span class=\"token operator\">/</span><span class=\"token number\">2</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">,</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>h<span class=\"token operator\">/</span><span class=\"token number\">2</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">)</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n    <span class=\"token comment\">// テキスト要素にD3-Cloudによる解析結果を追加</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">selectAll</span><span class=\"token punctuation\">(</span><span class=\"token string\">'text'</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">data</span><span class=\"token punctuation\">(</span>wordsForCloud<span class=\"token punctuation\">)</span>\n    <span class=\"token comment\">// 領域を新規作成し、テキスト要素追加</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">enter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">'text'</span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// フォントの大きさは解析結果通りに指定</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">style</span><span class=\"token punctuation\">(</span><span class=\"token string\">'font-size'</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">d</span> <span class=\"token operator\">=></span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>d<span class=\"token punctuation\">.</span>size<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// フォントの種類は解析結果通りに指定</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">style</span><span class=\"token punctuation\">(</span><span class=\"token string\">'font-family'</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">d</span> <span class=\"token operator\">=></span> d<span class=\"token punctuation\">.</span>font<span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// フォントの配色は、schemeCategory10を指定</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">style</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fill'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">d<span class=\"token punctuation\">,</span> i</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> d3<span class=\"token punctuation\">.</span>schemeCategory10<span class=\"token punctuation\">[</span>i <span class=\"token operator\">%</span> <span class=\"token number\">10</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// テキストの真ん中を表示位置のポイントに指定</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'text-anchor'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'middle'</span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// 位置と回転位置は解析結果通りに指定</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'transform'</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">d</span> <span class=\"token operator\">=></span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">translate(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>d<span class=\"token punctuation\">.</span>x<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">, </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>d<span class=\"token punctuation\">.</span>y<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">)rotate(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>d<span class=\"token punctuation\">.</span>rotate<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">)</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// 単語は解析結果通りに指定</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">text</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">d</span> <span class=\"token operator\">=></span> d<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\">// SVGファイル出力処理</span>\n    <span class=\"token comment\">// (略)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<br/>\n<h3 id=\"4-svgをファイル出力\" style=\"position:relative;\"><a href=\"#4-svg%E3%82%92%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E5%87%BA%E5%8A%9B\" aria-label=\"4 svgをファイル出力 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. SVGをファイル出力</h3>\n<p>仮想DOMに描画したSVGをファイル出力します。</p>\n<div class=\"gatsby-code-title\">d3.jsによるSVG描画処理</div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> fs <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fs'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token comment\">// kuromoji.jsによる形態素解析</span>\n  <span class=\"token comment\">// (略)</span>\n\n  <span class=\"token comment\">// D3-Cloudによる解析処理</span>\n  <span class=\"token comment\">// (略)</span>\n\n  <span class=\"token comment\">// d3.jsによるSVG描画処理</span>\n  <span class=\"token comment\">// (略)</span>\n\n  <span class=\"token comment\">// 仮想DOMに描画されたSVGをファイル出力</span>\n  fs<span class=\"token punctuation\">.</span><span class=\"token function\">writeFileSync</span><span class=\"token punctuation\">(</span><span class=\"token string\">'wordcloud.svg'</span><span class=\"token punctuation\">,</span> document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>innerHTML<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<br/>\n<p>すると以下のようなファイルが出力されます。</p>\n<div class=\"gatsby-highlight\" data-language=\"html:svgファイルの中身\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-html:svgファイルの中身 line-numbers\"><code class=\"language-html:svgファイルの中身\">&lt;svg class=&quot;ui fluid image&quot; viewBox=&quot;0 0 1600 1000&quot; width=&quot;100%&quot; height=&quot;100%&quot;&gt;\n  &lt;g transform=&quot;translate(800,500)&quot;&gt;\n    &lt;text style=&quot;font-size: 466px; font-family: meiryo; fill: #1f77b4;&quot; transform=&quot;translate(48, 35)rotate(0)&quot; text-anchor=&quot;middle&quot;&gt;ある&lt;/text&gt;\n    &lt;text style=&quot;font-size: 269px; font-family: meiryo; fill: #ff7f0e;&quot; transform=&quot;translate(460, 15)rotate(90)&quot; text-anchor=&quot;middle&quot;&gt;よう&lt;/text&gt;&lt;text style=&quot;font-size: 245px; font-family: meiryo; fill: #2ca02c;&quot; transform=&quot;translate(-263, -290)rotate(0)&quot; text-anchor=&quot;middle&quot;&gt;云う&lt;/text&gt;\n    &lt;text style=&quot;font-size: 191px; font-family: meiryo; fill: #d62728;&quot; transform=&quot;translate(-265, 193)rotate(0)&quot; text-anchor=&quot;middle&quot;&gt;それ&lt;/text&gt;\n   ・\n   ・\n   ・\n  &lt;/g&gt;\n&lt;/svg&gt;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<br/>\n<p>描画すると以下のようになります。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/5e4aed803fecc163a2ec605e3c7848a6/29007/wordcloud.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 63%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABcRAAAXEQHKJvM/AAACnUlEQVR42n2T7U/TUBjF/XP9aPxgNP4DJMYYlJj4xSiJYJCIgCyACBkZgW2srN1Kx9q16/qyDugrbVd2e3vMuiEixpucnHuTk999nif3PvB9n3cc59hxHMa2bca2Bsx47/h+7lHgM4HvMVe+xzi2w1xc2rnyzK2qruueVSqVZw8AgKYpHXvKsiB7u0g5Dmn5EBlJMYhSBAlFcJ0hIXns3sqyLB27JElzEyBNydiGmk692hEdNpq0Wdijqzt1+oW1aLXnUd70KddzaIE16KejLo2TvIgbjabA11Mgza/uD87RaTagnrWwfNjGo8UiXn2tQGcFqN4VzlQVbzdqmN2VkICg21NgGiY0TcsrVBTlzR2gG3qQ5DNctHl8r4p4usLkwOVCBT+6BhbqHTxZOMRSqYWNpg7N1GDoOvT7wMkMZb+Pc5tHtX2BuR0BD+dLcAUWG2UOa2UGH4oneLd1gpagYW79FFZXAORdpBluZjgBTmrMcOwFMJMIjGTiRaGBlZqIn5UWXq6XoXbfoy4fYGaFxfPFItYZC9Q4AS3OgNY+pkAISdHutiz0PAiDALFpIDB0BKYLuW1BbndQFArYldfB9DgsNlfRUXhcihwiq4TRxenfFYIOr0aorCno8RYaZQ09/hz8gQy9IUE2eGwK2zjqMSgbB1gU5rFVXoPbrCOOOxh1tlNgCElWboGjhCDwCJKBhkAUYTVsdFt9hO0BWIXHfv0bjtjPUE0Lx1oZQRKDDkRQcROUXUqReZBU/XfL1wBIrtAksC0SNm0Sqy5JRJeYtUuSqApJTZY4/ZggnWbHihyC6zAZc0SxPXtnhv/+BuNnm+F/685PSZKkGkXRfhRFpYnCiYfT8zAqRclw4lFYGg5vcn/mw/04jk84jnv8Cy/EsfT7rCouAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/5e4aed803fecc163a2ec605e3c7848a6/ba381/wordcloud.webp 200w,\n/static/5e4aed803fecc163a2ec605e3c7848a6/7f61c/wordcloud.webp 400w,\n/static/5e4aed803fecc163a2ec605e3c7848a6/d00b9/wordcloud.webp 800w,\n/static/5e4aed803fecc163a2ec605e3c7848a6/92f8c/wordcloud.webp 1200w,\n/static/5e4aed803fecc163a2ec605e3c7848a6/fad48/wordcloud.webp 1600w\"\n              sizes=\"(max-width: 800px) 100vw, 800px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/5e4aed803fecc163a2ec605e3c7848a6/772e8/wordcloud.png 200w,\n/static/5e4aed803fecc163a2ec605e3c7848a6/e17e5/wordcloud.png 400w,\n/static/5e4aed803fecc163a2ec605e3c7848a6/5a190/wordcloud.png 800w,\n/static/5e4aed803fecc163a2ec605e3c7848a6/c1b63/wordcloud.png 1200w,\n/static/5e4aed803fecc163a2ec605e3c7848a6/29007/wordcloud.png 1600w\"\n            sizes=\"(max-width: 800px) 100vw, 800px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/5e4aed803fecc163a2ec605e3c7848a6/5a190/wordcloud.png\"\n            alt=\"wordcloud\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h2 id=\"まとめ\" style=\"position:relative;\"><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\" aria-label=\"まとめ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>まとめ</h2>\n<p>Node.jsでWordCloudのSVGファイルを出力する方法についてご紹介しました。\n今回の実装で、ブラウザ処理はnode-canvasとjsdomを使えばNode.jsでも再現できることがわかったので、いろんな場面で応用できそうです。\n次回は、今回の実装をベースにして自分のブログのWordCloudを生成してみようと思います🍅</p>","excerpt":"なにこれ 前回記事ではReactでWordCloudを出力しました。しかし実際は、過去大量データから出力するようなツールとして使えたほうが便利です。\nそこで前回のサンプルをベースにNode.jsでWordCloudのSVG…","frontmatter":{"slug":"/wordcloud-with-kuromoji-d3cloud-nodejs","title":"Node.js + kuromoji.js + D3-CloudでWordCloudの画像を出力","date":"2019-05-04T18:00:00.000+09:00","tags":["Node.js","kuromoji.js","d3.js","d3Cloud","データ可視化","形態素解析","WordCloud"],"keywords":["WordCloud"],"thumbnail":"thumbnail/2019/05/wordcloud-with-kuromoji-d3cloud-nodejs.png","category":null}},{"html":"<h2 id=\"なにこれ\" style=\"position:relative;\"><a href=\"#%E3%81%AA%E3%81%AB%E3%81%93%E3%82%8C\" aria-label=\"なにこれ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>なにこれ</h2>\n<p>Slit Animationを実現するReactコンポーネントをCSSのclip-pathを使って作りました。\nSlit Animation(スリットアニメーション)は下記のようなものです。\nコマ画像を縞々にして合成した画像に、スリットを持つカバーを被せて横にスライドさせることでパラパラ漫画のようなアニメーションを実現します。</p>\n<p>デモはこちら ⇒ <a href=\"https://takumon.github.io/react-slit-animation/\">https://takumon.github.io/react-slit-animation/</a> <br>\nコンポーネントはnpmから落とせます ⇒ <a href=\"https://www.npmjs.com/package/@takumon/react-slit-animation\">@takumon/react-slit-animation</a></p>\n<p><img src=\"/fa2410ba2fb6a4f63446413bfccccfe5/animation.gif\" alt=\"animatino\"></p>\n<p><img src=\"/83306a709aca3018049ed4d392927fa3/animation-inco.gif\" alt=\"animatino\"></p>\n<p><img src=\"/e367d0c2dfb6145fde488b4df114097f/animation-go.gif\" alt=\"animatino\"></p>\n<h2 id=\"slit-animationの原理\" style=\"position:relative;\"><a href=\"#slit-animation%E3%81%AE%E5%8E%9F%E7%90%86\" aria-label=\"slit animationの原理 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Slit Animationの原理</h2>\n<p>CSSやReactコンポーネントなどの説明の前に、純粋にSlit Animationの原理を説明します。\nSlit Animationは何個かのコマ画像を合成した画像とカバーから成り立ちます。以下では簡単のため４コマで説明します。</p>\n<h3 id=\"コマ画像\" style=\"position:relative;\"><a href=\"#%E3%82%B3%E3%83%9E%E7%94%BB%E5%83%8F\" aria-label=\"コマ画像 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>コマ画像</h3>\n<p>それぞれのコマ画像を縞々にして１つの画像に合成します。\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/2c09ec2308cb40b9df2336c3a6c0cc9d/9b379/description_image-mix.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 115.00000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAXCAYAAAALHW+jAAAACXBIWXMAABcRAAAXEQHKJvM/AAAEt0lEQVR42pWVi09WZRzHH96L2ew/0Mlyulk2tZxrmq4MxelCsxQiV6NAkYto001tNi2mooJZuWYpvPC+HsQZKBevBHIXw0vKpUyR94bwMuKOgO9zzqed9329TV3zbN99f+ec5/ns+zvntz2ipKTkK7vTmd/s8WQ3d3bmPFMeT067vTWn09n+bDnasu0t9vzSsrJ1osXpzAFQt26VxMZCYiIkJPiVmIi2ehUk7+CAvZCY5sMk3raQEJBex91KZ92dLDkMeFx3FWF3uxUdKMePH0EIicEgfR6oNd1fnyoXFMVJkTNHGnPnS5EbIkVeiAw6MV+KvHly9G8LR1rVbjrdHpuwt7Ye1YFMmCDbhaDebOaM0Uix0cgRs5nTQsAb01lYsglhC2XUTwswJs/FuG0Opi2zEBtnMiY/QnoYpMvtUYQjAPS+OkH2CIHHZKbdYMRlMHLLZMYVAC4q3og4FspL1sWYjizClLkQc3ooQenzeaXgY+lhwA98kFANDtbbBIMBnwdqVfcpUwk9twlxYinGgnBEwQpEYThBRRGIwuWMzo/0J7yrJ3S5fMCSX/JkQUomRWk2ivZa/Uq1kr8rg0rLaS7ezqSw4RtONSZT1PBdQMkU1m/nbNMOCRK3q00RrS6HDxi846oUG/7AsPkKYss1xOarGL6+jthwmcmp/9BfFwLlAq3KADUCLgqoDfK5VjlaggeHu+sRcMK2ailiTjJq1XFMn2Vg+tzKqMiDiIhDTEm5Qf/lEPpOCVx5RhptQTTYgvjTYqDukGC47OVnAJMvSRGdi/lLG8ZPD2KM/BnzshTE8h95bW8TQ1cW0JUvaLKauXzISNUBI+fTTJxPFcjyMU8Dg7dUShFTgiG+DJFQgYivwLC2GrGqlMnbr9JfEwK/C7QyA1QIv6qCoFKglT7WsisAjD9+Uy5Lryciq5FwSwPhmQ1EZjWyIrORjYWtDLXshL8/QmuMRG0I90lriECtX47WtFLCIA6XPjZ2u39sVFXy2KVpms+bb/6F5fCvHE7P4lazCy3wTntyrW+vw+F4BPRKVaoa6NI3qJrGv93dXKqtJcNiwWazcvVKHb09XTpCj/BQmiafBj6ecGBkhIHePgb6+hkcvs/Q4D3u9ffTPzTM0L0h+nq66e27F0j3nIQ68EGbfRersJ3NI7euipFyG8fO5ZNdW05/pUJR8UksZaV0u6offprnA6XXHzH+Cyat/4B3bN9DpGBG0lKmH02DWMGS1fMY98NuZH1cAKi3rP4fMIpJaxcx27IXPhG8lRDGNNtuWCUIi36XsWk78F6PfQFgXBQTkxYzOzM1AFzCtCN7fMAlMe8xbt9O5I0XASZGM3l9GHOt+2ClYGbSMmYoqbBG8OHqEIL370LWxz8XqASAw6r3vk70Ehflnbjmfe+sgyleIoT3zdhQ77RDO71EC29Y1NvesTu/9XqvxfrWqqqeQtVPAJxOp1W0tLTkPBwbTfUnvFCMteY0x+/UQ/EejlafIbulHsr3U1h+koym62g9Fx6M9ZN/uaKiIsntduc5HA6b/sBhtyuOjk6lu6NL6W5rU+ydA0q3fn+3TbF39CldHV1Kr8ejONwdim+9XzaXy5VXU1OT+B+NQ3H5jhfmcgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/2c09ec2308cb40b9df2336c3a6c0cc9d/ba381/description_image-mix.webp 200w,\n/static/2c09ec2308cb40b9df2336c3a6c0cc9d/7f61c/description_image-mix.webp 400w,\n/static/2c09ec2308cb40b9df2336c3a6c0cc9d/d00b9/description_image-mix.webp 800w,\n/static/2c09ec2308cb40b9df2336c3a6c0cc9d/d9249/description_image-mix.webp 951w\"\n              sizes=\"(max-width: 800px) 100vw, 800px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/2c09ec2308cb40b9df2336c3a6c0cc9d/772e8/description_image-mix.png 200w,\n/static/2c09ec2308cb40b9df2336c3a6c0cc9d/e17e5/description_image-mix.png 400w,\n/static/2c09ec2308cb40b9df2336c3a6c0cc9d/5a190/description_image-mix.png 800w,\n/static/2c09ec2308cb40b9df2336c3a6c0cc9d/9b379/description_image-mix.png 951w\"\n            sizes=\"(max-width: 800px) 100vw, 800px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/2c09ec2308cb40b9df2336c3a6c0cc9d/5a190/description_image-mix.png\"\n            alt=\"description_image-mix\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h3 id=\"カバー\" style=\"position:relative;\"><a href=\"#%E3%82%AB%E3%83%90%E3%83%BC\" aria-label=\"カバー permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>カバー</h3>\n<p>カバーには等間隔で隙間があります。隙間幅は<code class=\"language-text\">縞々１個分</code>で間隔は<code class=\"language-text\">縞々１個分×コマ数</code>です。\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 685px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/036c1b029a3307238f01c918343766a6/8ce22/description_cover-slit.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 41%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABcRAAAXEQHKJvM/AAAB6klEQVR42nVQXW/SYBjt33VemvgPNF64DAd6adSE8TG2Ih97y9RkygxGZFg6KJCWrmvDWMvoFxR4+7JjqvPCxJ3kPCd5Tp6Tk4cTRfHhYrH4GgRBNQgCwXFmwtXVWDAMXRiPTcHzHMG2LME0DCH272F1Pp/XJUna4obDYQp/EEURgzV1oGo6xE4XZ+0OHNfHpTFGq90B22zwP2w2GxaroihJTlXVF3fr1SKkzHaWzPFDZjtzZs/m7MYN2cxbMmsWMjdYxYeMUvoP1+v1Ok7QNC3Bxal/G4ZLCmV0iZ7cR/dcQkf8CcbYXYtbUHaLexDFQ1XVXU6W5aTruvB9L9J1E7blo974gdfv3iCdzSGTL+CgkEM2k4ZxocePQalawV4ui2z+APuFfWT23kaqMoBpmrvcYDBIRFGEZRiG5rVNAVC1r9Cj/Hv6qVqmHyo85Ys1mi3UqDmd/fZPj09ojS/Rj1WeknKFpnNHy/5QjwN34oapfq8HbTKJ0D4DHj0GaWSwvfqM1LmFV6017CANhAlg5wlunj9DwhXwctLC9ndAUGVg9ZQBLSiKmeREUdyybbs+dd2K3+uR8JAn39onpDA6JcX2gJSaF8RQa8Qb8SQgZWIdE1JU66QoN8lh0yANSSS+lq9412dfpG7/wS83vy7zuremrgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/036c1b029a3307238f01c918343766a6/ba381/description_cover-slit.webp 200w,\n/static/036c1b029a3307238f01c918343766a6/7f61c/description_cover-slit.webp 400w,\n/static/036c1b029a3307238f01c918343766a6/80e32/description_cover-slit.webp 685w\"\n              sizes=\"(max-width: 685px) 100vw, 685px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/036c1b029a3307238f01c918343766a6/772e8/description_cover-slit.png 200w,\n/static/036c1b029a3307238f01c918343766a6/e17e5/description_cover-slit.png 400w,\n/static/036c1b029a3307238f01c918343766a6/8ce22/description_cover-slit.png 685w\"\n            sizes=\"(max-width: 685px) 100vw, 685px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/036c1b029a3307238f01c918343766a6/8ce22/description_cover-slit.png\"\n            alt=\"description_cover-slit\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h3 id=\"アニメーション\" style=\"position:relative;\"><a href=\"#%E3%82%A2%E3%83%8B%E3%83%A1%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3\" aria-label=\"アニメーション permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>アニメーション</h3>\n<p>合成画像にカバーを被せて横にスライドさせます。すると、カバーの隙間部分から<code class=\"language-text\">1→2→3→4→1→2→3→4→...</code>のようにコマが順番に繰り返し見えることになります。これによってパラパラ漫画のように見えるのです。\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/faa2fc90c70a0848e339f8cb451cc361/620ae/description_slit-animation.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 66.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABcRAAAXEQHKJvM/AAAC8ElEQVR42lWTXW/bNhSG/Sf3D3bbH9C7DdhV0WJAh2JA1qzF1jVZ7MyN0axNl7kZYgRNETtSXNtILMeOLan+kCKSkiiJH3oHKVmDESBweHj48DwAWRkMBo+EEEPP89qj0chYrlZGzLkhhPgyGaVGnCQGldLwlkuDpanhB4FBGTNYHBvFWc758OLi4kHl6uqqBgBRFKnlaoXo+hq++xmnJ22cGR202yY8GgK+j/TgoCgFabWQJwmYbSPo95EDqsjPZrPNyvn5+ZZdbASBWJBAi19e6vr6d/qr357oe49r+uiPr/V8fqYxdXW4vq4VoJ1fX2gRBPpzt6unfzeLnLgFblS63W41jmM4jqPG4zGSKIJSEqq493akWQYoBeatQMMQoe+BMIKQENDAB6H0rsN+v19ljIFSqubzOZp7ezjrnaFvX6JWq6Oxs43pbFKCt3rvsSAe7OsFGsaNfq29jyXxS6DjODdASimyLCuTZKOK/Z01POy28LhxjPHJQwTLfnn4zfAIK+LDuV5g/+IYkMCfvRa8W+CsAPZ6vSrnHK7rqslkUoCRI0cmJVIhbuIsg9YaUkjwNIPIMqRSIUkzSCkR8eROuQAWyowx5bouDg8PUa/XcfThI5Ykxt7bN5hOZ2WHQ3uJ7193AOTYaHbwcTABiRP88Nb4vzIh5E75+Qtsrn2L+61dPP1nCOvoGwTzbgmczD381OyXwMbxEKeWizDJ8PP7wR3wP2XbttXl5WWpV4w811BSlqppmiLPcwghypkkSZkrYs7jIi6B0+m07PD3QtXzvMxxXfWu/ko9XftRPXm2rrbquyr0B8p1xkpKpVjIVUjnavypoYSGGn/aUVFIFFkNMmQfMHOjl19+ShzH5S34q4mTgyrWrFNst22k/jZEOIGQxXuUyEWA5Wi3LF1YryEzDk4tBZwUwM2KZVmPAFiMsQ4lxGScm5wnZhLHJuexSVlsUsrMJElMSqlJihpGzSAgZsRu1oSQjpTSGo1GD/4FG1Ws3rylK48AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/faa2fc90c70a0848e339f8cb451cc361/ba381/description_slit-animation.webp 200w,\n/static/faa2fc90c70a0848e339f8cb451cc361/7f61c/description_slit-animation.webp 400w,\n/static/faa2fc90c70a0848e339f8cb451cc361/d00b9/description_slit-animation.webp 800w,\n/static/faa2fc90c70a0848e339f8cb451cc361/88fcb/description_slit-animation.webp 1043w\"\n              sizes=\"(max-width: 800px) 100vw, 800px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/faa2fc90c70a0848e339f8cb451cc361/772e8/description_slit-animation.png 200w,\n/static/faa2fc90c70a0848e339f8cb451cc361/e17e5/description_slit-animation.png 400w,\n/static/faa2fc90c70a0848e339f8cb451cc361/5a190/description_slit-animation.png 800w,\n/static/faa2fc90c70a0848e339f8cb451cc361/620ae/description_slit-animation.png 1043w\"\n            sizes=\"(max-width: 800px) 100vw, 800px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/faa2fc90c70a0848e339f8cb451cc361/5a190/description_slit-animation.png\"\n            alt=\"description_slit-animation\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h3 id=\"例\" style=\"position:relative;\"><a href=\"#%E4%BE%8B\" aria-label=\"例 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>例</h3>\n<p>最初にお見せしたRreactのロゴがくるくる回るSlit Animationは下記のような構成になっています。コマを縞々にして合成、隙間のあるカバーを作成し上に被せています。\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/abd1e8400892394fc5e63a454f9b6756/29007/description_image.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 133%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAbCAYAAAB836/YAAAACXBIWXMAABcRAAAXEQHKJvM/AAAE0UlEQVR42p1U31MTVxTOX2QHOypEpeMDduyTVl8VZUB9dfofaH2xdErBNCTKUDp1pNUpliBLEBpqmwRiyS9CmEQCSTCQH7vZTbLZTXb37te5l6Qto7ZMd+bOPfec73x77jnnHovP53OkUqnFtbW12a2tLS6TyXCJRIJLJpPc+vo6R3Wbm5tspVIpLhqNsp3a6U71sViM+i56vV67RZKkCACk02mSy+VQKpVgmiY0TUMymUS5XAYhhEIgCALi8TgajQbaH8VTXyqXy+WQpVQqhSloYmJCHxm5T54+fUoSiSTxeJaI3W4nDoeDLC0tkWAwSCYmviM2m408fjxJ4vE4cbvdZHh4mIyNjenBYBCZTCZoSafTEZ/Ph8HBL8nt27cxPj6OFy9eYHJyEnfufI57977A/Lwbfr8f9+/bcPfuXdjtdqyurmJ6ehqDg4NUR2ZnZ5HP50MWWZYjGxsbcDqdZNhmYyB6nna58MDhxEPnA3g8HiwvL2P823E4Ru34/tEjdqZ654MxOJwPSSQS2SekOVQUBRuxGPmN45B8/ZrlJr+7B3/4FbwBPxqqynTpTAYutweiKLJzva4i4FtAciNENN2gOQ5ZBJ5nRUEuR/SxMRgADGIw1Y9vfscKn/irAIKs4auF1P7BNGAC0AvTMMRfWVEEvhSyCILACOVqlShSBc1mk+FplaWqhLqiQNd1VnlVVSFVqszW7gRVraNakUirC/4m5Hme0Bag16GktVoNxWKR6plcr9eZTDG0fSh5tVph52KxSFotFLLwrSsXCgWSz+cZuC7LqEgVmmTkC3lUKhVUazIjLBTyKJUKUBQZoiRSP4ojpklaEYr7EQqCwCKs1WTohoFqpQKB5yGURdTrMhoNBeWyAF6QIEk1NNQGIy2LIo3s7Ss3m03S1DTo9BUUi6AZrzTqkNUadAKkRQOKqkIWt2HUkjAlL0w1i0bTgKY13yYk7fdFCMhaFFj5A+vZMPyFbbxKvkZ2xwcor2Aq64C2Q3sB7K//8H03obkPgijhzXoIK5kM6mIcQJVVVG2S/dVowjCMQxC2SDfTacwvejD/fBaJ5DYUpYFbtz5DX18fbt68gd7eXni9XgbXdf3dhGYrOlmWMfv8OUbtdthHR/Hzs2fYyWZx8dIldHd3o6enB1arFXNzc4cjlCQJMzMzsNlsbBBM/TSF9HYaly9fwblzn+D8+Qs4e/ZjLCws/Dth+8ZUjEajePLkCZs64XCY9eKFC5+iq8uKM2fO4PjxE6AT5lCE7adHG3lra4sNWmqempoCHXWBQIDlj76kwxWl9dEq0sgWF3/BysoKIyLEhGHoB3D/SdgWX758yfLW39+P3t6rGBi4josXL9Hp3r7q4Qjb/TU352Y5O3nyFE6c6MSpU6fR0dGBkZGRA7hDE3LcHGuP7u6PYLWeZPvRox/CZvvm/xG63W50dnaxyGhVT5/uZoRDQ1+/n5Dn+VDLqBFCDLo0TWODm+M449ixY0ZnZxfbrVarceTIB8bQ0BCzUxzFU9/WTF2lhNH3FYW2yLVr13D9+g309fVjYGAAV670YnLyhwO4ti/P82FLOBy27e7uurPZ7PTOzo6rvXK5nCuRSLj8fr8rEAi4lpeX2fL5fK5YLMbsbSz13dvbc0cikZE/AWZmWfhaLjpbAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/abd1e8400892394fc5e63a454f9b6756/ba381/description_image.webp 200w,\n/static/abd1e8400892394fc5e63a454f9b6756/7f61c/description_image.webp 400w,\n/static/abd1e8400892394fc5e63a454f9b6756/d00b9/description_image.webp 800w,\n/static/abd1e8400892394fc5e63a454f9b6756/92f8c/description_image.webp 1200w,\n/static/abd1e8400892394fc5e63a454f9b6756/fad48/description_image.webp 1600w\"\n              sizes=\"(max-width: 800px) 100vw, 800px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/abd1e8400892394fc5e63a454f9b6756/772e8/description_image.png 200w,\n/static/abd1e8400892394fc5e63a454f9b6756/e17e5/description_image.png 400w,\n/static/abd1e8400892394fc5e63a454f9b6756/5a190/description_image.png 800w,\n/static/abd1e8400892394fc5e63a454f9b6756/c1b63/description_image.png 1200w,\n/static/abd1e8400892394fc5e63a454f9b6756/29007/description_image.png 1600w\"\n            sizes=\"(max-width: 800px) 100vw, 800px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/abd1e8400892394fc5e63a454f9b6756/5a190/description_image.png\"\n            alt=\"description_image\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h2 id=\"縞々をclip-pathで実現する\" style=\"position:relative;\"><a href=\"#%E7%B8%9E%E3%80%85%E3%82%92clip-path%E3%81%A7%E5%AE%9F%E7%8F%BE%E3%81%99%E3%82%8B\" aria-label=\"縞々をclip pathで実現する permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>縞々をclip-pathで実現する</h2>\n<p>今回コンポーネント化にともない「画像を縞々にする」という課題がありました。\n最初は、画像要素に白い長方形のdivタグをたくさん並べてトライしましたが、それだとコマ合成時に下の画像ごと隠れてしまいます。\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/42337d4f4af57d6b4d157bfb57a7d125/29007/description_mask-pattern.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 72.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAABcRAAAXEQHKJvM/AAADEklEQVR42o2QsW8bZRjGP3XxUHVDYkH0T2Bi7sBWwdCFAbEwIpiokFCrIgStgJpWGZCqIkGFItQCBRKkDpUi4sRp45AmjePEzvVi+y7fd3f2nR37bF98Pt/nH0qCqGAofaRHj97l9z7vK1SplB/Pz2NPT+v9mRlas79TtCs8GOzy6KDO8kEVI3Yx2wnLKmbVS3ioEmR3BMkGk3gFHRc0lHHsxzmhrl1b5NQp2idOjG0hNC++rL98dEuL26/pzPQbWtw8o88uXdLnvt3S4p1ZnXn3Ny3euqs/mtnUrJ3WwazQ8mcxjucyOH9emBfu9et5Tp7EEULvCAEvvMQXyzcQ371K5uYZxFevcHb+Q87d2ES8+ROZt39AvP49F+4WoXAa70eBcUvo/r0M3urFnLDm5vJcvkx4/rwOz38An15hUa1x0bzD59Vf+Hj3DrfdBX4ttvnkviSbc7l032HBbIH/NVp+hlZXNOEUjnEvJ8xiMS+7XUr1ui5bFqYf0Ao7jJIRcTJimIxIxgnRMCaKEwZxcpTRcEScjhmOhwxGBxrAtnZyQk5P53FdokpFh6VNJu0O681dtppVtoM6Gw0Tvx/wuObz0GyyWHGPcrUakAw8+sEGoV/STBzqa988BfYrFb2/VSLd77LRNDF8CyOw2G5U2e+32awFrJo+D8qK1V2ftWqLJAroBdt0/YoG/2/gykqeKKLnurqvFKOwh+o0cfebeGEL1fUJox5OEGL7XWrNEKvZRQY9hoMOg66i11EaDrB2cjlh7e3lvUaDjVJJVy2LrXIZwzDY25OYT0yMyg5hGPIsaa2Pfug4Tk4oKfOHQ9Ju60GxSL9Wo1ev0TMMhuMxTCbA5Cj+62NN0Do9Bir1FDhqNPTB8jKRadIzTVqlElEy5nn0r4ZSyoUjYBAk7lI+bZTLabNSSd319bQTxSkTnaaHFZ7hNE2TQ4ZS6o9D4NLxmlTbQYDXadLo+Lgdnyhq/3PW8zRUSi2IQqHwvuu6U7aUVxuek3Xsalba1awn61nHfpKV0slKKf/PVz3PmyoUCu/9BfMIyNiVbX+7AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/42337d4f4af57d6b4d157bfb57a7d125/ba381/description_mask-pattern.webp 200w,\n/static/42337d4f4af57d6b4d157bfb57a7d125/7f61c/description_mask-pattern.webp 400w,\n/static/42337d4f4af57d6b4d157bfb57a7d125/d00b9/description_mask-pattern.webp 800w,\n/static/42337d4f4af57d6b4d157bfb57a7d125/92f8c/description_mask-pattern.webp 1200w,\n/static/42337d4f4af57d6b4d157bfb57a7d125/fad48/description_mask-pattern.webp 1600w\"\n              sizes=\"(max-width: 800px) 100vw, 800px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/42337d4f4af57d6b4d157bfb57a7d125/772e8/description_mask-pattern.png 200w,\n/static/42337d4f4af57d6b4d157bfb57a7d125/e17e5/description_mask-pattern.png 400w,\n/static/42337d4f4af57d6b4d157bfb57a7d125/5a190/description_mask-pattern.png 800w,\n/static/42337d4f4af57d6b4d157bfb57a7d125/c1b63/description_mask-pattern.png 1200w,\n/static/42337d4f4af57d6b4d157bfb57a7d125/29007/description_mask-pattern.png 1600w\"\n            sizes=\"(max-width: 800px) 100vw, 800px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/42337d4f4af57d6b4d157bfb57a7d125/5a190/description_mask-pattern.png\"\n            alt=\"description_mask-pattern\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>合成時に他の画像に干渉しないようにするには、隠すのではなく存在を消す必要があります。\nCSSの<a href=\"https://developer.mozilla.org/ja/docs/Web/CSS/clip-path\">clip-path</a>はまさにこのようなトリミング機能を実現するためのプロパティです。丸や楕円、任意の形にトリミングできます。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/37837a62cc83362e61e9d885046c4dc3/29007/description_clip-path.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 115.00000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAXCAYAAAALHW+jAAAACXBIWXMAABcRAAAXEQHKJvM/AAADkElEQVR42p1Uj0/bRhjl/12iMsMCgRGtEoiWaV0rIRQmraxSYZuAbYyElBEQbEoACVRGSAoNxD/P+dH8sJ3YiZNc3nRXcGGbSrazns732ff0fffedwPJZPKZrpOEqipxTZF3GIimcMiyvCNJ0r0QRTGuKEoykUh8PUA0bRcASlWbVs0WjLqLd0YT+YqNdoein0Ep5T8qirI9oGnaDtsoylrnIpujby9Fev72il5JGq1UDWoYBrVtm5qm6c0sdhu1Wq3T6/UY4daALMs8w5OT1/Thwy8w8/gxQqEJbP626WVwenqK+XAYyWSSr9nm2+h2uzxDTdO2PcLj42M6MjKC8fFxCIKAjY0N7EkO8jUb01OT8Pn9GB0dRaVS8Uj/XvIdwqOjIzo8PIyxsTEMDg4iEongdd6F4bSxtPgSwtAQZmdn0Wq1+iNMp9P06dNnCIfD+OrJE/y+t+dtcBwHmUwGpml+VBROqF2rzM6h16PoUQo+8wf/SWWPsN0FSKFM86Ua9GIVerEGhZRBChW+JvkKJO0dh2lZaDQad2BZ1h3b7DqtLrIioQopQVSKyCkFXCkFPotKAapeAvsmqSWYVp2XbhiGh2q1+oFQVVVesiSK9MWL77C0tIjnz79FMpng5biui9XVFfzw4/dcnI1olJV4v21SqRT9LBBAMBjEgweD+OXnVVzWupBKJkKfj8Pv93MsLCx8/Axvq8wswwgFYQixyDr+kGxkdAvxzRiWl1dweHgI1231TxgKhTA1NcW9uLa29g+/9a0yW7A+JUQDIQSqqsKo1d4T/h/bsEXDdqjrdsDR7sBxXNQbDhp2E1adzQ7qDRvWdYx9c5wmF63ZbH5QmRBt12q4yGRVmlOKyEpFXOTyeHOpsxjOrwj+fCMjK7IYwem5gvNLgrMLlVvKskxUqlWepOdDfh+WSjSdTvMWS6VS0DQVnU4brWaT26RSKaNcLvNOYjEmDutrBsdx/t02ExMTmJyc5Er/ei1KmwJNx8H8N/OYm5vjndHX5XB2dkbHgkEwfCoI2H4VwV6ujq2sichPy/jE54fP58fLxcV7CXfeX7AnHUEQaCAQoD6fn66sLLO/qNuhtFAo0JmZGfpoeprqhLDNlHXHzeh2ux3Goarqltd6uq7TWCyGeDyOaDTKMr6TyU3/3mub/f39LwkhcVVV1/P5fPQGhJCooigcsix7cfZ+E7+FdV3X4wcHB4/+AjtkcUBRGb2RAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/37837a62cc83362e61e9d885046c4dc3/ba381/description_clip-path.webp 200w,\n/static/37837a62cc83362e61e9d885046c4dc3/7f61c/description_clip-path.webp 400w,\n/static/37837a62cc83362e61e9d885046c4dc3/d00b9/description_clip-path.webp 800w,\n/static/37837a62cc83362e61e9d885046c4dc3/92f8c/description_clip-path.webp 1200w,\n/static/37837a62cc83362e61e9d885046c4dc3/fad48/description_clip-path.webp 1600w\"\n              sizes=\"(max-width: 800px) 100vw, 800px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/37837a62cc83362e61e9d885046c4dc3/772e8/description_clip-path.png 200w,\n/static/37837a62cc83362e61e9d885046c4dc3/e17e5/description_clip-path.png 400w,\n/static/37837a62cc83362e61e9d885046c4dc3/5a190/description_clip-path.png 800w,\n/static/37837a62cc83362e61e9d885046c4dc3/c1b63/description_clip-path.png 1200w,\n/static/37837a62cc83362e61e9d885046c4dc3/29007/description_clip-path.png 1600w\"\n            sizes=\"(max-width: 800px) 100vw, 800px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/37837a62cc83362e61e9d885046c4dc3/5a190/description_clip-path.png\"\n            alt=\"description_clip-path\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>今回は任意の形にトリミングできる<code class=\"language-text\">polygon</code>を使って\n<code class=\"language-text\">clip-path: polygon(5px 0px,5px 800px,6px 800px,6px 0px,11px 0px,11px 800px,...)</code>のようにして縞々化を実現しました。\nこれについても最初は、複数の長方形を指定しようとしましたが、polygonは１つの閉じた図形でなければならないという制約があり困りました。\nちょっと悩んだ末、ハック的に櫛型の図形を指定することで解決しました。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/84db7447d6686f560592257b3dc2dc68/2bcd1/description_clip-path-stripe.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 67.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAABcRAAAXEQHKJvM/AAAB/UlEQVR42o2S626bQBCFeeL+6JO06fNE/RFRKUVWSLBiBzCG3eViwFYLyy4XT0612JZ6S2ukT2dmV3O0Z4QlhFgIIe4453aWZTZj3GaM2Xme22VV2VVd25XRqj7XJ+r61Ncn7uq6du/v799b5a6A4IxYEoNzBsYSZFkKrTpc+72+vh6NhmF4Y6n+CJaWUyxK4mlFSVrRlpfEzsrzmsK4oE2yI55VFCYFBduceFZTxHaU5jXtD9/G4/EIz/M+Wm03YB0mFGxTREmGdcjhRwLBViCIBKI4nfV0n8+EcY6YF9jEGZjYYVfWx2ma8Pj4eGOZpzbNd5KyRds26LWa1fSdbCHbBkp10Fq9GZmI5si+758MpZSklELXdRiGwfRzfTnr+x5a6z9397cdXgzNYCclxnG82hBvGSqlSJ+HpnGcjUzdaz2rebXhKsM0y8AYIy4EDGa5lzg/c/VvMzw/4+D7dFgucXBdjGUJtVpB+z50FEEHAYbVCsN+f5n+T2TPg3x5IeV56BYLDEJAOg4614VaLmftHQe6KK4zpIcHYzh0T0+TXCymQYhJOs7Uue7ULZezaseZVFGYXUwgOumv9MYwCIIPFpIEmjHqNxv0vo+pqqDXa/RBgD6K0IchxvX6qsi+73+ytNZfmqa5bZrms0Ge9XeklP/itm3br67rvvsBIfYcVhip850AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/84db7447d6686f560592257b3dc2dc68/ba381/description_clip-path-stripe.webp 200w,\n/static/84db7447d6686f560592257b3dc2dc68/7f61c/description_clip-path-stripe.webp 400w,\n/static/84db7447d6686f560592257b3dc2dc68/d00b9/description_clip-path-stripe.webp 800w,\n/static/84db7447d6686f560592257b3dc2dc68/92f8c/description_clip-path-stripe.webp 1200w,\n/static/84db7447d6686f560592257b3dc2dc68/58c45/description_clip-path-stripe.webp 1561w\"\n              sizes=\"(max-width: 800px) 100vw, 800px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/84db7447d6686f560592257b3dc2dc68/772e8/description_clip-path-stripe.png 200w,\n/static/84db7447d6686f560592257b3dc2dc68/e17e5/description_clip-path-stripe.png 400w,\n/static/84db7447d6686f560592257b3dc2dc68/5a190/description_clip-path-stripe.png 800w,\n/static/84db7447d6686f560592257b3dc2dc68/c1b63/description_clip-path-stripe.png 1200w,\n/static/84db7447d6686f560592257b3dc2dc68/2bcd1/description_clip-path-stripe.png 1561w\"\n            sizes=\"(max-width: 800px) 100vw, 800px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/84db7447d6686f560592257b3dc2dc68/5a190/description_clip-path-stripe.png\"\n            alt=\"description_clip-path-stripe\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h2 id=\"reactコンポーネント\" style=\"position:relative;\"><a href=\"#react%E3%82%B3%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%8D%E3%83%B3%E3%83%88\" aria-label=\"reactコンポーネント permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Reactコンポーネント</h2>\n<h3 id=\"実装\" style=\"position:relative;\"><a href=\"#%E5%AE%9F%E8%A3%85\" aria-label=\"実装 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>実装</h3>\n<p>縞々化の<code class=\"language-text\">polygon</code>を組み立てロジックは、Slit Animationの原理で説明したようなロジックをもとに、先に説明したCSSのclip-pathで実現しました。</p>\n<div class=\"gatsby-code-title\">縞々生成ロジック</div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">craeteFramePolygonPoints</span><span class=\"token punctuation\">(</span>\n  coverSlitWidth<span class=\"token punctuation\">,</span>  <span class=\"token comment\">// カバーの隙間幅</span>\n  coverWidth<span class=\"token punctuation\">,</span>      <span class=\"token comment\">// カバー全体の幅</span>\n  coverHeight<span class=\"token punctuation\">,</span>     <span class=\"token comment\">// カバー全体の高さ</span>\n  frameCount<span class=\"token punctuation\">,</span>      <span class=\"token comment\">// コマ数</span>\n  frameIndex       <span class=\"token comment\">// 何番目のコマか</span>\n<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token comment\">// カバーの隙間を配置する間隔</span>\n  <span class=\"token keyword\">const</span> unitWidth <span class=\"token operator\">=</span> coverSlitWidth <span class=\"token operator\">*</span> frameCount<span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// 隙間を何個並べるか</span>\n  <span class=\"token keyword\">const</span> unitCount <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>coverWidth <span class=\"token operator\">/</span> unitWidth<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// 櫛型とpolygonを生成</span>\n  <span class=\"token keyword\">return</span> <span class=\"token function\">range</span><span class=\"token punctuation\">(</span>unitCount<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">i</span> <span class=\"token operator\">=></span>\n      <span class=\"token function\">range</span><span class=\"token punctuation\">(</span>frameCount<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">i</span> <span class=\"token operator\">=></span> i <span class=\"token operator\">%</span> frameCount <span class=\"token operator\">===</span> frameIndex  <span class=\"token operator\">%</span> frameCount<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">countInUnit</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n          <span class=\"token keyword\">const</span> offset <span class=\"token operator\">=</span> i <span class=\"token operator\">*</span> unitWidth\n          <span class=\"token keyword\">const</span> offsetInUnit <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>countInUnit <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> coverSlitWidth\n          <span class=\"token keyword\">const</span> xStart <span class=\"token operator\">=</span>  offset <span class=\"token operator\">+</span> offsetInUnit\n          <span class=\"token keyword\">const</span> xEnd <span class=\"token operator\">=</span> xStart <span class=\"token operator\">+</span> coverSlitWidth\n          <span class=\"token keyword\">const</span> yStart <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n          <span class=\"token keyword\">const</span> yEnd <span class=\"token operator\">=</span> coverHeight\n\n          <span class=\"token keyword\">return</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>xStart<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>yStart<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px,</span><span class=\"token template-punctuation string\">`</span></span> <span class=\"token operator\">+</span>\n            <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>xStart<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>yEnd<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px,</span><span class=\"token template-punctuation string\">`</span></span> <span class=\"token operator\">+</span>\n            <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>xEnd<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>yEnd<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px,</span><span class=\"token template-punctuation string\">`</span></span> <span class=\"token operator\">+</span>\n            <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>xEnd<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>yStart<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px</span><span class=\"token template-punctuation string\">`</span></span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">,</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">,</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// 補助関数</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">range</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">size<span class=\"token punctuation\">,</span> startAt <span class=\"token operator\">=</span> <span class=\"token number\">0</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">...</span><span class=\"token function\">Array</span><span class=\"token punctuation\">(</span>size<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">keys</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">i</span> <span class=\"token operator\">=></span> i <span class=\"token operator\">+</span> startAt<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>縞々ロジックが確立してしまえば後は簡単で、淡々とコンポーネントを作成していきます。</p>\n<p>縞々画像のコンポーネント</p>\n<div class=\"gatsby-code-title\">縞々画像のコンポーネント</div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> styled <span class=\"token keyword\">from</span> <span class=\"token string\">'styled-components'</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">SlitAnimationFrame</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>\n    coverSlitWidth <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n    imageWidth <span class=\"token operator\">=</span> <span class=\"token number\">500</span><span class=\"token punctuation\">,</span>\n    imageHeight <span class=\"token operator\">=</span> <span class=\"token number\">500</span><span class=\"token punctuation\">,</span>\n    frameIndex<span class=\"token punctuation\">,</span>\n    frameCount<span class=\"token punctuation\">,</span>\n    image\n  <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> props<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>frameIndex <span class=\"token operator\">&amp;&amp;</span> frameIndex <span class=\"token operator\">!==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">throw</span> <span class=\"token string\">'You need to set frameIndex.'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>frameCount<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">throw</span> <span class=\"token string\">'You need to set frameCount.'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>frameCount <span class=\"token operator\">-</span> <span class=\"token number\">1</span> <span class=\"token operator\">&lt;</span> frameIndex<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">throw</span> <span class=\"token string\">'You need to set frameIndex which is smaller then lastIndex of frame.'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>image<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">throw</span> <span class=\"token string\">'You need to set image.'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// 縞々ロジックを使う</span>\n  <span class=\"token keyword\">const</span> freamePolygonPoints <span class=\"token operator\">=</span> <span class=\"token function\">craeteFramePolygonPoints</span><span class=\"token punctuation\">(</span>\n    coverSlitWidth<span class=\"token punctuation\">,</span>\n    imageWidth<span class=\"token punctuation\">,</span>\n    imageHeight<span class=\"token punctuation\">,</span>\n    frameCount<span class=\"token punctuation\">,</span>\n    frameIndex\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\n  <span class=\"token keyword\">const</span> FrameImage <span class=\"token operator\">=</span> styled<span class=\"token punctuation\">.</span>img<span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\n    position: absolute;\n    width: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>imageWidth<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px;\n    height: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>imageHeight<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px;\n    display: block;\n    top: 50%;\n    left: 50%;\n    -webkit-transform: translateX(-50%) translateY(-50%);\n    -ms-transform: translateX(-50%) translateY(-50%);\n    transform: translateX(-50%) translateY(-50%);\n    -webkit-clip-path: polygon(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>freamePolygonPoints<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">);\n    clip-path: polygon(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>freamePolygonPoints<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">);\n  </span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>FrameImage key<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>frameIndex<span class=\"token punctuation\">}</span> src<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>image<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<br>\n<p>続いてカバーのコンポーネント</p>\n<div class=\"gatsby-code-title\">カバーのコンポーネント</div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> styled <span class=\"token keyword\">from</span> <span class=\"token string\">'styled-components'</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">SlitAnimationCover</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>\n    frameCount<span class=\"token punctuation\">,</span> <span class=\"token comment\">//required</span>\n    coverWidth <span class=\"token operator\">=</span> <span class=\"token number\">500</span><span class=\"token punctuation\">,</span>\n    coverHeight <span class=\"token operator\">=</span> <span class=\"token number\">500</span><span class=\"token punctuation\">,</span>\n    coverColor <span class=\"token operator\">=</span> <span class=\"token string\">'#000'</span><span class=\"token punctuation\">,</span>\n    coverSlitWidth <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n    startAt <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n    endAt <span class=\"token operator\">=</span> coverWidth<span class=\"token punctuation\">,</span>\n    duration <span class=\"token operator\">=</span> <span class=\"token number\">50</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> props<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>frameCount <span class=\"token operator\">&amp;&amp;</span> frameCount <span class=\"token operator\">!==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">throw</span> <span class=\"token string\">'You need to set frameCount.'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// ここでも縞々ロジックを使う</span>\n  <span class=\"token keyword\">const</span> coverPolygonPoints <span class=\"token operator\">=</span> <span class=\"token function\">craeteCoverPolygonPoints</span><span class=\"token punctuation\">(</span>\n    coverSlitWidth<span class=\"token punctuation\">,</span>\n    coverWidth<span class=\"token punctuation\">,</span>\n    coverHeight<span class=\"token punctuation\">,</span>\n    frameCount<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> CoverDiv <span class=\"token operator\">=</span> styled<span class=\"token punctuation\">.</span>div<span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\n    top: 0;\n    left: 0;\n    position: absolute;\n    width: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>coverWidth<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px;\n    height: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>coverHeight<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px;\n    overflow: hidden;\n    &amp;:after {\n      top: 0;\n      left: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>startAt<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px;\n      position: absolute;\n      content: '';\n      display: block;\n      width: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>coverWidth<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px;\n      height: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>coverHeight<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px;\n      background: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>coverColor<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">;\n      -webkit-clip-path: polygon(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>coverPolygonPoints<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">);\n      clip-path: polygon(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>coverPolygonPoints<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">);\n    }\n    &amp;:hover:after {\n      left: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>endAt<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px;\n      transition: left </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>duration<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">s linear;\n    }\n  </span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>CoverDiv <span class=\"token operator\">/</span><span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<br>\n最後に全体を取りまとめるコンポーネント。<br>\n縞々画像とカバーを重ねて表示します。<br>\nホバー時にカバーを横スライドするようにしました。\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> Component <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> styled <span class=\"token keyword\">from</span> <span class=\"token string\">'styled-components'</span>\n\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">SlitAnimation</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>  <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>\n    images<span class=\"token punctuation\">,</span> <span class=\"token comment\">// required</span>\n    imageWidth <span class=\"token operator\">=</span> <span class=\"token number\">500</span><span class=\"token punctuation\">,</span>\n    imageHeight <span class=\"token operator\">=</span> <span class=\"token number\">500</span><span class=\"token punctuation\">,</span>\n    coverWidth <span class=\"token operator\">=</span> imageWidth<span class=\"token punctuation\">,</span>\n    coverHeight <span class=\"token operator\">=</span> imageHeight<span class=\"token punctuation\">,</span>\n    coverColor <span class=\"token operator\">=</span> <span class=\"token string\">'#000'</span><span class=\"token punctuation\">,</span>\n    coverSlitWidth <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n    startAt <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n    endAt <span class=\"token operator\">=</span> coverWidth<span class=\"token punctuation\">,</span>\n    duration <span class=\"token operator\">=</span> <span class=\"token number\">50</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> props<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>images <span class=\"token operator\">||</span> images<span class=\"token punctuation\">.</span>length <span class=\"token operator\">===</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">throw</span> <span class=\"token string\">'You need to set images.'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">const</span> frameCount <span class=\"token operator\">=</span> images<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> cover <span class=\"token operator\">=</span> <span class=\"token operator\">&lt;</span>SlitAnimationCover <span class=\"token punctuation\">{</span><span class=\"token operator\">...</span><span class=\"token punctuation\">{</span>\n    frameCount<span class=\"token punctuation\">,</span>\n    coverWidth<span class=\"token punctuation\">,</span>\n    coverHeight<span class=\"token punctuation\">,</span>\n    coverColor<span class=\"token punctuation\">,</span>\n    coverSlitWidth<span class=\"token punctuation\">,</span>\n    startAt<span class=\"token punctuation\">,</span>\n    endAt<span class=\"token punctuation\">,</span>\n    duration\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token operator\">/</span><span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> frame <span class=\"token operator\">=</span> <span class=\"token function\">range</span><span class=\"token punctuation\">(</span>frameCount<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">frameIndex</span> <span class=\"token operator\">=></span>\n    <span class=\"token operator\">&lt;</span>SlitAnimationFrame <span class=\"token punctuation\">{</span><span class=\"token operator\">...</span><span class=\"token punctuation\">{</span>\n      coverSlitWidth<span class=\"token punctuation\">,</span>\n      imageWidth<span class=\"token punctuation\">,</span>\n      imageHeight<span class=\"token punctuation\">,</span>\n      frameCount<span class=\"token punctuation\">,</span>\n      frameIndex<span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">image</span><span class=\"token operator\">:</span> images<span class=\"token punctuation\">[</span>frameIndex<span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> Container <span class=\"token operator\">=</span> styled<span class=\"token punctuation\">.</span>div<span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\n    position: relative;\n    width: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>coverWidth<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px;\n    height: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>coverHeight<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px;\n    overflow: hidden;\n  </span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>Container<span class=\"token operator\">></span><span class=\"token punctuation\">{</span>frame<span class=\"token punctuation\">}</span><span class=\"token punctuation\">{</span>cover<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Container<span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>これで完成です。</p>\n<h3 id=\"使い方\" style=\"position:relative;\"><a href=\"#%E4%BD%BF%E3%81%84%E6%96%B9\" aria-label=\"使い方 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>使い方</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">npm i @takumon/react-slit-animation</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>でインストールして下記のように使えます。</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> SlitAnimation <span class=\"token keyword\">from</span> <span class=\"token string\">'@takumon/react-slit-animation'</span>\n\n<span class=\"token keyword\">import</span> parrot1 <span class=\"token keyword\">from</span> <span class=\"token string\">'./images/parrot/1.png'</span>\n<span class=\"token keyword\">import</span> parrot2 <span class=\"token keyword\">from</span> <span class=\"token string\">'./images/parrot/2.png'</span>\n<span class=\"token keyword\">import</span> parrot3 <span class=\"token keyword\">from</span> <span class=\"token string\">'./images/parrot/3.png'</span>\n<span class=\"token keyword\">import</span> parrot4 <span class=\"token keyword\">from</span> <span class=\"token string\">'./images/parrot/4.png'</span>\n<span class=\"token keyword\">import</span> parrot5 <span class=\"token keyword\">from</span> <span class=\"token string\">'./images/parrot/5.png'</span>\n<span class=\"token keyword\">import</span> parrot6 <span class=\"token keyword\">from</span> <span class=\"token string\">'./images/parrot/6.png'</span>\n<span class=\"token keyword\">import</span> parrot7 <span class=\"token keyword\">from</span> <span class=\"token string\">'./images/parrot/7.png'</span>\n<span class=\"token keyword\">import</span> parrot8 <span class=\"token keyword\">from</span> <span class=\"token string\">'./images/parrot/8.png'</span>\n<span class=\"token keyword\">import</span> parrot9 <span class=\"token keyword\">from</span> <span class=\"token string\">'./images/parrot/9.png'</span>\n<span class=\"token keyword\">import</span> parrot10 <span class=\"token keyword\">from</span> <span class=\"token string\">'./images/parrot/10.png'</span>\n\n<span class=\"token operator\">&lt;</span>SlitAnimation <span class=\"token punctuation\">{</span><span class=\"token operator\">...</span><span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">imageWidth</span><span class=\"token operator\">:</span> <span class=\"token number\">800</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">imageHeight</span><span class=\"token operator\">:</span> <span class=\"token number\">800</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">images</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n      parrot1<span class=\"token punctuation\">,</span>\n      parrot2<span class=\"token punctuation\">,</span>\n      parrot3<span class=\"token punctuation\">,</span>\n      parrot4<span class=\"token punctuation\">,</span>\n      parrot5<span class=\"token punctuation\">,</span>\n      parrot6<span class=\"token punctuation\">,</span>\n      parrot7<span class=\"token punctuation\">,</span>\n      parrot8<span class=\"token punctuation\">,</span>\n      parrot9<span class=\"token punctuation\">,</span>\n      parrot10<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">duration</span><span class=\"token operator\">:</span> <span class=\"token number\">40</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">coverColor</span><span class=\"token operator\">:</span> <span class=\"token string\">'#444'</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id=\"いけてないところ\" style=\"position:relative;\"><a href=\"#%E3%81%84%E3%81%91%E3%81%A6%E3%81%AA%E3%81%84%E3%81%A8%E3%81%93%E3%82%8D\" aria-label=\"いけてないところ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>いけてないところ</h3>\n<p>スリット幅、カバーの色、カバーのスライド速度など調整できるようにはしていますが色々と難点があります。</p>\n<ul>\n<li>使う画像ごとに、うまく調整しないとなかなか動いているように見えない</li>\n<li>ピクセル幅にシビアなのでサイズをレスポンシブにできない</li>\n<li>モバイルで見ると固まる（レンダリングがかなり高負荷）</li>\n</ul>\n<p>などなど実用的なコンポーネントとは程遠いです<img alt=\"emoji-cold_sweat\" data-icon=\"emoji-cold_sweat\" style=\"display: inline; margin: 0; margin-top: 1px; position: relative; top: 5px; width: 25px\" src=\"data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAWv0lEQVR4Ae2bBXAcx9a2n9MDi1pJlmzJdmSmMCcXQ5eZmZmZmZmZmZkpzHTtsG9MchyzbOFK2t2hPv9K6iqpFNvXf5x8fKre6llpt6ef95weHuF/eZj/M+B/d/yfAT73erzf5E555bLQ1+NVvWNFWGHxu1VMmyBFAEVronbYkO5VZYtItj5O41ujG76zFbDciyHw/nsDWiqn7jhDvcJjEf+h1guP8XxTFGMQz8MIiAEEAFBQC1ZBswy1liy1NZPF/0LT8yWr/7G6rud6QO95A+7JOHV3scX4T1UTvBA/f38v8IwXehjfIIAKAIhMiWl+VKfxxLVZqmRxSpZklrRxldjku6M2/SVQu8cMaA6aI451G/2W0499tvUKbzJheJwf+vihQQxYIBdCWxm65sDcNujqgHIBQh8A4hTG67B3APqHm+0gDI9BHIMAaiGNbVMpNo5uM1njM6P/XP9jID1yA7iEI4nKaYvPwG//qAbFBwX5gCAnIOAHcNRcOH4FnLQSlnZDRwXyAXgeAOisMswyiBIYqMLWvXDTZrh1C+zcD2kCKCSRkjQSJKldRDr0TuD6IzKgctpW7k5U1y6TljP73ihB5QN+PlfKFQTxIAzgmKVw3mlw0nJobwGA1IJOSEEPMR/FbR98AwBDo3BTL1y8Fv51hxIngmYQNZSsHo/bZOR9o9d1fRbQ/6htgLSfuraiucVfNmHl2bmSkMsJeLBsgfDoBwinr5JJI5IU7N1ckbrWAIEPUQJrNyl/ulLZtlunTIiUaNxi49EfS3Tnq4fWnVYF9N40QDpPvmG+Fnt+4heL5xRKQhBCmBPOPdXjEfcxtBYhykD00GuSuwIf9A/qKiP0YKQGf7vWcsm6jDhS0hhq40paq10qtR3P6r/xlD2A3hvHAdJ5/yvne6b790ExOL3YkuIH0F4RHnd2yGlrhCxTxhsgcgQuH8KUJJky4YlnCYvmCX+4LGGoqgQ+1ExwTtIcW3OMj++/6gHOhHvOADnq2F+2W3/hz3Il7/RSS4wfCp3thiedV2DFQqEWZQgg3LuRAprCySuFSsnn1xfV6R+yhJ4y7nmnR+MLf9Yc6xN2rn/qEKD3hAECmGDu0V/0S+asciUmlzO0thoef06JxV0TWU8xs7N+Dzuhs1DGU1g8D550bsDvLx1nZMQSGMuYmLNSOfqLwPMAC+jdN8DBLz/78jf6peBZldaYYtEjnzc8+IwSCzuhHk3Bz17TPcx/l74VqEU0xyDNsfhceM04Dd/iS0aV4FnNMd/ce9lZn/13Jvj/Dn7VA39yalAsva9SSSiVlSDMOGlNkRULPBpRgjGQHWnGj6AiopTJsQyuMdy8oUFgFF9Tqlnpfc2xX7bpimetO5QJcij4rq6H5rtOfPNfy22tZ1XaQnJ5YV5njrNPayMMBAUEOWBPxhjUWpQjCwHEGKy1By4JtxAnymVrh9nXHxE1lOpwzNjIyOV9N336kX195zcOZoJ/KAMWnPjcpxXK3lltlYRyUcnlDWuWFAn8FJspgqAzwRXECEEYMFodxvdDPM9wJJFmljSNaalUSOIEtQqz1qkogS8cvcSjUYuJjMXYFFLvLK/J0Hf++T8C9PAMcPAL1zyhUsqFb21tSaiUDIVCRsecPPPaBU0jAHRW5gN3cP+XX/2Vi/58Pm/64JvoXjCfNE25O+H7Pvv37uEz7/0MD3r0Q3nEEx8KHiRxCswywcLcdqG7QxkcjPDUIkmCScK3Nln+sGvD70amTTi0AQbwViw960nFsl3dWk5oKQr5gmH+3AKhl2CtMjM8z5ArBOzevptffv9vXHLxlRy/ejk9C9uoRTVQ5e5EYmOOavZRzrfx7a/8jN7bd/DU5z+CBYvmEdUTsswyM0JPmmMU4nqMj0XSBBvb1RMsTQN+4OCzQxkggMyZsyJXynkvqpQzKsWEUkEpFgPaSgq2gSgg4HuGMBdQHaly/h/W8ZdfXseewRotuR7e/O7nEgRArY7czS2kWiUMipN9vfrF324au4ENN23nUU89k3MediqV1jJxlExOExSw0F5ShoopPgmSptg4Q+rei5pMPx8c3JI5Rj2UAd4ppzz6lHJJT2stJpRLhnLeUi4K5VxG4IPvG1Qt+/tGuP7qjVz819u4c9soliIt4Vw+8aknsPq4LrZt34dnzBFtAavDtYm+mn0+h7e9+XfsH4z54dev5LK/38x5jzyOM+63mrldrYgY0tQi+YzWYopnY4xN0DjBNlkmmC688PPXAPZQBhjAay15j20pJKZSimgtQD5nJ7cDNqmyY8cw27bu59Ybd3HbTXsYGEwRSqS0sayngw9//JGsOamNzVu2E4iAckThCezYvp37PegovvW95/Dut/+VrTsG2L4t5XtfvZY//nwtx500n+NPXsiSZXOZ191GpZSgSYSvCcQR6XhisiYTcD2QAfZABghg2tvbg3IxPbe1GDfhY8o5KBaVrB7xvg/8nC1bpzKtFPAoAmU6Wyo8/inH87JXnYqaYbZu3jQJf6AQhNmhgOCWD+CYB5N9rjymm1/+/tl84yvr+P2vbqV/NGDfYMIFF+/kwos3Y6ixYlkLb3jrw2ktCjWNocmQFWPSJtME29DQUAoIoAc04D7H32dZa86ubismVPIRpRyEfkrb3A6e9JQH84+/9DJWNRQKJXoWdXDfByzh3Acvonu+NqfBJqojY4SeQZBpGFV0dqs66zqAQFMGJltxLe5/KsqubVsn5/3b330Cz3/RiVxy4XauuXJbs0IGqNfHKVcsD3vUchZ2FxkeGsDLWUwSYYsJaZNpgu1vl//t9kMZ4M2rhMe35NNCJZ804SMKoRJ4PqRDPO+5J/DSl55FrWYJAiFfyIjqw+zfdzu33zICqvgikFmszdBJ0IllBRRVAAU9UKbF8U63xggiZsoY42HEUBsZb65rH21zWnnq07p5zvMfSKPukSRKsWiIGwNsvP0W8l6MF6aQi7H5hKjJNMEGbALkoFNgTp5j2nIJLfkGLaGQCxU/SDEas23jdYS5PEEQkGUZSRyT2QzU4qEOWKEpM6NTzGEef+pBDnkVxLrKcBrtH2Z0YAee8Qhy4WTblyTEUQNfE4qhJZUMP4mgyRLnEmpNNuB3BzPAAKYcpMtbwpRSGFMIDDkfgsAHI6ARktRIEwHAV8XDztqJ3vtnQy6cMQZtCCkgKCEWPMAoiaaYIMKGMUmYMtpkw3HONkCcvEqQzCvlYorBhITQB9/LQByR6mzYA9AqIkIQ+hgR0jSb1OG7ovi+NymrShKnqOqB1nNXc4zM6CPFCyI0iElyMeUmG+AB4qSzp0BQNlFbeQLea1DwIDCK5/mAHhaAoBjPYK3yr1u3MTw8zupVRzF/fgdxnBzWHAjDgD17+ti4aSdtbSWOOXoJxgg2syhymOUi+FmKZ2LUa5AFMZUmGxAcchtQ9LN8wUTkPZ+cEQLfTs6vwyB3CRAyq/zy55dw87oNeAKXFAs881kP4YQTFhPH6SHHHeZ8brmll5/+5AKSWp1M4cRT1/CMZ5xL6AtWp7N+aHzI/AzjJVivQWoiJtgAcyADxLWmJBG5SXmEIgSSYcRjpC58+o95nn7/mON6MgCQu+Yyl/O57IqNbLp5Ayu7AwJfGKg2mrvPK1i9opVCPsBa5UBhjFCvjU1+t9Vr0LEwJEl1sq+bVs/j7AesJorSaX49yNmxaz0yRBKsNEglYoINMAeaAupaE2rSyNMgL4ZQlECCSQN+dEUXv7hxBbure/nhS3sxMjXPQae7AzwJ6N20ja5Ww7yKwTdCIQjYPlBl967dnHhcF9FBqiAX+vT29hGPVlnUEVDOGVKrJImhd+M2zntgD6GXgE6nWRF3XCF3mV1WpgxAIlIaTLABBtfDAc8FfI2qoTYILIRk+BIwUsvxy/UnQlcPV++fz23b7+S0JSMgM+DN1LLxAtK4QUveUAwE3wNVIWeULB0jF5bQ7AAGCORDf+o7RimFQjGENJPJvib69PwxRBOwgAooqDoTxCEhqIKIYsVOfl9txATTBNuhrgcogMmi/lB9fJSAFE8D/nzrUextWY3f00Ha38YP167gPksvRQwOHsSZEeZDuheU2L6/HzHTCcnnA7rm+/iMEPqWA4WHmfjO5HfBeWvAZnayz2I4TpzFqABWQHGaMlnFmQKIglWLkGBJJgyYZDvY2aA6UYujO73Uw8sUz6ZkieX7609n4cnd/PpFi3jHP/r582/P5K39V7J83ogzwWVfwKfBfc6ey5abdjJes+RzwuBQwqJjulix2mDHq3i+cJewYDNlxaoyi9bMYd+/+gg6AxqREqs32acvVTKToQquxh2JOCpBVZwBgLUYm2LSBC+NJtlm886ugHTfSKP3mNjDpCA24/wNi9ngHcvbzpnLfeYHvPqBc7j82gXNKjiaDz/mElz5I0JTStpQTjimhUe+aCVX/OZOqtWU7uM7ecqLe8jpEIlJDnwF1QCqBJrwtJf28KvvZPRtHCEoBc2+Fjf7VBr7RvFEUAQMgMt4JiAAghoDFtz5hjOgqThigg3IDnY6bIH0n7vqW89Z7TdMonnJfL63/r60rurgkcuKrB9Sju0IOe7kDn550QN4Y+0SOltquCnguJR0sM6Dz2rh5PuupFazzOs0+NVBkvEY48khj/SyqE5XucHL37GAfQPdFIuGjiClsXsfxpue41hngk5lnQnhpgECMgHfVJZikhTiuDHBBiSAPZgByc/X13a+5oxcbzmWY/+5vYerkjN51AntdJc89jegMy88+vhWPnr9Cn5+wzG87pyrABAAZwKiRHsbtBc9OkJDsj8lzayD//d3Q9NaA9MYo6fgY+uWaCBDjGBUwALIjJ/IjIoyKAYUFDDWYlKLxCmNsbh3gu1QBigQjSck/dXo2rkNPfbbvQ9Aejp53JoWxlMhsTAUKQ9eXODbq9r57s0P5WX3v4pSLkZEYVKA2y5kMWQJYMC4vx3ObVpxQEktAgXjzdjowcyMu6wzveyqQDJtCkgyJIrpr8bXTrABEaAHMyAB6pdtj65kTtcL/p6cZ045dg4nzA0ZbCgqQjURuvIeDzmunZ9sOI4/3rqaZ5+xbgrOcIB2lgDQf++CAuLaGVkHZ4QIOgMacaaocc8aKZI0Vc/Q8chetj2+EqgDycEMALBA7Qv/zDasbXv0SLZmfvtDV5exCA0reAJWYSSBhywr8pdlnXzuxsfzlFPXkQ9TMCB3NWLG2OXwTod1RiXpNLgyywgctJOIoNYgGWiqSGShnjI6kt42wQTUHCOHMqBenfeYRf8oPryyaHEbazpyVBOwbkwWGEtgbsln5aIy6+44lV/ccAIvuN91YHAHRLMqAAUPyAHejMxmTIMCWPe3GFAcGFMy4vwTcC3qKsCKmyIGtRlkgqYWogwZTbl5d/r7akIdJnVIAxSo0/2AhxQWdHlHdRRQMSTWrdwNPFOwKnS35Wlb2Mb3bj6PFzzgOvAcPDOyHwB5iEdh8y3Kxo3KnXfC4BDEEYhAoQCdnbBsmbB6dbNdLJAD6goZYFzpIeDpFCx3vc2hmTYlaJxh6xY7mjEylG1715VcBlSB+uHcGElpXXBy27wi7eWQ0UToLDo2poQRBhvQkguaAy+wfvMa8GUaGplqi8LoEPz6R5aLLlB2bYcsBl/AN2AcR2Yh1Qkp+RIsXwWPfYzwiIcKkgMiwBOAKXgRZ8qUhOllTcA2IBtTsmHLNTv0h70jjMKk0sO5NaYUCu2VckBr3mMoFnoUcgYAcMnY34BCKLQWfXaaCngyo+SBPGzcoHzwA5adW2FuWVjeAbkAAgcvAqibDQpJBrUY9myGj31EueRS5d3v8mitAMmshwxVnNEOfEIpaGTJ6pZ0JKOv397wiou4DBgGxg775qhgCY1S9BWA/XXoKkDOg9RCfwSRhZLvLpgYO20AgAdjVfj4xzOqfXDSMmjJQc4Hbwb8zFALmU71Pz+F4TrccB185WuWd7zTQ6yAMgPamZAJqqAZ2IYlGdcmvKUxmDW+cZN+ZaRB1RkQARyWAdqo9iVRtMymKb5YUjUMxxA6A+op+GqxWUaaJJTsgKNiSiHcsV4Z3A+rFsPcFigEYAzIQXaCM/+eZlCKQD3YsAHqo0KxJJAB6gxgSmpBE9CGxY4rdsSSDWRcd4d85/NrtRcYcPNfD9sARndeMdx3zH2rSxtE7QU052FVSDLIFFAlyTJG6xHD/WMc13ITWAEPUCCFuQsMXd0Q+EKuqBgD1jLVRwrWKlYBpozxjOB54E8ogLwPXhWWLBVyLQYSnYKfOd9T0BhsHeyokgxb4v0pvTvs+Y//nf4B6AcGgRjg8A3Yfdlv929Z88I7F7V1zmkJCT3B5n0CT0itMh5n9I3U2bl3mL2b9/Cu0y+CdMY+Pla6Fxie+Lwcf/lJzL5RKJaFfEkotgqFCoR5aQrUQtyAqK7URpR6FRpjyti4UpgrPP3FIZ4BLKAzyj4GYkFriq1akqGm9mXs22Vves6f9ZvAkIMf+/9/RGbnJbuSjhM/tnFd62dyPiRxSmclT873SKxleDyid/cI62/cyZMq3+e+XVvRhoEAxBcwCqPKwx/uc/TJPiPDSqVV6egQikXwzMynonFgkGTC6BgM9EN9HOYvEOYWFYYsYMBlnUTQCLer0yn4vgn47PYX/10/uWGQvcA+N/ezu/Og5Bygk1Pf9vTy8jPfvOiYhS3zuisU8j5xnDEwUGP7pj4ekf2At5z8B9o7YeEiD8mBhIoETB8UlQVCIFWIdaqd/djXzAMcXyB087yhUMOVvJvrqaB10JolHVWyEUuyN2X3Dnvjy/6un75yJzuB3UAfMApwdwzwgcWAx8onr6Lr1Gfm2xbcz8/nK1lUT9L+rTtf0fb78DlL1x/nzzH0LPWodAhSEkxeICeID+IpeC7T4loAc5DLuBYAHLArd9DMZT5WbEPRMSV1+/lkf8aW7faCZ/5Jv71lMvOT2g8MHemjsi3A/FnfrYCrDih/9Gxz9mOP0yce1ePl/A4PryJ4ZYPkQSZMCHFGAGaGZNbaFdc6pUyBW3AbOjRStA7ZuCWrKulgRn0ga1zdK9970m/t34Bhl/X9blk5jPA4eMRuKMUZQ01m3F+Xi+7UXt9y5aqCdhWtzlf3n8k2E7C4bwuaCaiTBRS3PCEctEAqaDwh0IaiNbBjkI3aqXIfsKR92UTJ3/D5q/VTb7pYrwcGHHw/MALoPfmwdA5odUZ4gAK+UxFoL3i0fOXh3O+cpfLEtk6z1Gs1eC0GUxSkIHghEAoSAB6IAYzAzAqwijrDNAEiJYtB64qtKdnYlAHD/faOS+/Q377q71xdzxh1pT7gNArof9QrM2VnTDvQBlQWlil/+BxOu2+PPKyjXY73y0YmTPCKZnpKBAIekzIGAKwDR12pu5LPanYSPh2zOjCot16zU//x7ktZu2uMMcAd4THksj72n/HOUA5oASrOhBZnjP/601j6qJXmtKXtelq5hSVhweRMTiAQxAfjz6wAsKm6XZxiIyWu22hslG13DMnav2y2az+/ljuA1IGOOviqW47+M1+aMkDBwTtRBEpAzgPzmFXMO6uHhas7TE9nURcUA+bkfMqBRw4gyYiilLFawmB/TXZvHLA7Lt/Brj9tYl8G1gGOAzUH7EQdsP9V3hrznRElp6L7nAdCJ8/J4toZJma41il2agB1Bz/uVAfS/3qvzU0bkQPyTgUgnGWCce3MyAA7Cz52sA2naCb4f1UDZvYdzJLvWmcAAgDoDAMSB5nMkt47g/yPCweNcTrQ4x7WyZlx78f/A5XVFJimBjmKAAAAAElFTkSuQmCC\" title=\"emoji-cold_sweat\"></p>\n<h2 id=\"まとめ\" style=\"position:relative;\"><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\" aria-label=\"まとめ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>まとめ</h2>\n<p>思い付きで作ってみて一応Reactコンポーネント化できたのはとてもうれしかったです。\n最近のCSS周りは、なんでもできるようになってて楽しいですね🍅</p>","excerpt":"なにこれ Slit Animationを実現するReactコンポーネントをCSSのclip-pathを使って作りました。\nSlit Animation…","frontmatter":{"slug":"/2018/12/02/","title":"CSSのclip-pathでSlit Animationを実現する","date":"2018-12-02T16:00:00.000+09:00","tags":["CSS","clip-path","React"],"keywords":["React"],"thumbnail":"thumbnail/2018/react-slit-animation.png","category":null}},{"html":"<h2 id=\"なにこれ\" style=\"position:relative;\"><a href=\"#%E3%81%AA%E3%81%AB%E3%81%93%E3%82%8C\" aria-label=\"なにこれ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>なにこれ</h2>\n<p>自分のブログの目次をQiitaっぽくしたい...現在表示中の章をハイライトする目次を作りたい...ということで作りました。\nマークダウンをHTMLに変換するのに<a href=\"https://unified.js.org/\">unified</a>という構文解析ライブラリを使っています。<br>\nメモ用にReactサンプルアプリも作りました ⇒ <a href=\"https://github.com/Takumon/react-markdown-sync-toc\">ソース</a>と<a href=\"https://takumon.github.io/react-markdown-sync-toc/\">デモ</a></p>\n<p><img src=\"/1ab28e49a6d92fa569ec65b06994040c/scroll-sync-toc.gif\" alt=\"scroll\"></p>\n<h2 id=\"ポイント\" style=\"position:relative;\"><a href=\"#%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88\" aria-label=\"ポイント permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ポイント</h2>\n<ul>\n<li>マークダウンのHTML化と目次抽出には<a href=\"https://unified.js.org/\">unified</a>を使いました。</li>\n<li>スクロールの度に現在表示中の章をチェックして目次ハイライトを更新します。\n<ul>\n<li>スクロール処理は高負荷なので負荷軽減のために<a href=\"https://lodash.com/docs/4.17.10#throttle\">Lodashのthrottle</a>を使いました。</li>\n<li>表示中の章が切り替わるごとに再描画するためにReactのstateを使いました。</li>\n</ul>\n</li>\n</ul>\n<p>以下で詳細を説明していきます。</p>\n<h2 id=\"unified\" style=\"position:relative;\"><a href=\"#unified\" aria-label=\"unified permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>unified</h2>\n<p>アプリの実装を説明する前にマークダウンの構文解析に使っているunifiedについて説明します。<br>\nunified自体はただのインターフェースです。構文解析ロジックはもっておらず、構文木を使ってテキストを処理するフローを提供します。</p>\n<ol>\n<li><code class=\"language-text\">parse</code>: 文字列をパーサーで構文木に変換</li>\n<li><code class=\"language-text\">run</code>: 必要に応じて構文木をトランスフォーマーで変換</li>\n<li><code class=\"language-text\">stringfy</code>: 構文木をコンパイラーで文字列に出力</li>\n</ol>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/cb7e5397d2a762f5ae7cdebf49be0f81/33a7b/unified-process.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABEklEQVR42m2RUW/CMAyE+///2zQI6wNIY6VilCegTZqmxM5N54HUoVn65Oh8smynmuf5U0RmEQkiMqrqyLwkpWS86vQ+/D7nXHLOb9UwDCdVBYWUErz3uN/vEBFM02QMw4AQgunjONJrUCMiogBYqyvv/Td+Q1W1EADG873URORPnYMAEDaIMX5Ufd+fmqaBc64457BarXA4HECtrmtsNhtst1vsdjt6LO/3e/M86845pd8mZMPr9Yqu68r5fMblckHf95Zvt5utuF6vrRHfrNHPGj1d1xGlbg15w8fKBS9RSrFbchJOwLtR+yf0sXJdhRC+cs6iqpOqpiU559S2bWqaxjgej0lE0quvlBL5sTHG9x8YMxez4DZmFwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/cb7e5397d2a762f5ae7cdebf49be0f81/ba381/unified-process.webp 200w,\n/static/cb7e5397d2a762f5ae7cdebf49be0f81/7f61c/unified-process.webp 400w,\n/static/cb7e5397d2a762f5ae7cdebf49be0f81/d00b9/unified-process.webp 800w,\n/static/cb7e5397d2a762f5ae7cdebf49be0f81/03b0b/unified-process.webp 1119w\"\n              sizes=\"(max-width: 800px) 100vw, 800px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/cb7e5397d2a762f5ae7cdebf49be0f81/772e8/unified-process.png 200w,\n/static/cb7e5397d2a762f5ae7cdebf49be0f81/e17e5/unified-process.png 400w,\n/static/cb7e5397d2a762f5ae7cdebf49be0f81/5a190/unified-process.png 800w,\n/static/cb7e5397d2a762f5ae7cdebf49be0f81/33a7b/unified-process.png 1119w\"\n            sizes=\"(max-width: 800px) 100vw, 800px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/cb7e5397d2a762f5ae7cdebf49be0f81/5a190/unified-process.png\"\n            alt=\"unifiedの処理の流れ\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h3 id=\"ライブラリ群\" style=\"position:relative;\"><a href=\"#%E3%83%A9%E3%82%A4%E3%83%96%E3%83%A9%E3%83%AA%E7%BE%A4\" aria-label=\"ライブラリ群 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ライブラリ群</h3>\n<p>unifiedが提供するインターフェースの実装（プロセッサー）は、マークダウン用、HTML用、テキスト用の3種類があります。\nプロセッサーごとに、構文定義、パーサー、コンパイラーが用意されています。\n構文定義の方法は3種類の間で統一されており、マークダウンからHTMLなど相互変換が可能です。</p>\n<table>\n<thead>\n<tr>\n<th>解析対象</th>\n<th>プロセッサー</th>\n<th>構文定義</th>\n<th>パーサー</th>\n<th>コンパイラー</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>マークダウン</td>\n<td><a href=\"https://github.com/remarkjs/remark\">remark</a></td>\n<td><a href=\"https://github.com/syntax-tree/mdast\">mdast</a></td>\n<td><a href=\"https://github.com/remarkjs/remark/tree/master/packages/remark-parse\">remark-parse</a></td>\n<td><a href=\"https://github.com/remarkjs/remark/tree/master/packages/remark-stringify\">remark-stringify</a></td>\n</tr>\n<tr>\n<td>HTML</td>\n<td><a href=\"https://github.com/rehypejs/rehype\">rehype</a></td>\n<td><a href=\"https://github.com/syntax-tree/hast\">hast</a></td>\n<td><a href=\"https://github.com/rehypejs/rehype/tree/master/packages/rehype-parse\">rehype-parse</a></td>\n<td><a href=\"https://github.com/rehypejs/rehype/tree/master/packages/rehype-stringify\">rehype-stringify</a></td>\n</tr>\n<tr>\n<td>テキスト</td>\n<td><a href=\"https://github.com/retextjs/retext\">retext</a></td>\n<td><a href=\"https://github.com/syntax-tree/nlcst\">nlcst</a></td>\n<td><a href=\"https://github.com/retextjs/retext/tree/master/packages/retext-latin\">retext-latin</a></td>\n<td><a href=\"https://github.com/retextjs/retext/tree/master/packages/retext-stringify\">retext-stringfy</a></td>\n</tr>\n</tbody>\n</table>\n<p>ライブラリごとにプラグインが山ほどあって、例えばHMTLをミニファイしたり、マークダウンをリントしたり、文章中の<code class=\"language-text\">a</code>と<code class=\"language-text\">an</code>を識別したり、いろんなことができます。\n汎用的なAPIで独自ロジック実装できる! といった拡張性の高さもポイントです。</p>\n<h3 id=\"使い方\" style=\"position:relative;\"><a href=\"#%E4%BD%BF%E3%81%84%E6%96%B9\" aria-label=\"使い方 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>使い方</h3>\n<p>unifiedがパイプラインになっていて必要なライブラリをメソッドチェーンで順番に設定していきます。\nパーサーとコンパイラーは1個つずつ、トランスフォーマーは任意の個数を指定してください。\nパーサーとコンパイラー未指定だと実行時エラーになるので気をつけましょう。</p>\n<div class=\"gatsby-code-title\">実装例</div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> unified <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'unified'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">var</span> markdown <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'remark-parse'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">var</span> remark2rehype <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'remark-rehype'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">var</span> doc <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'rehype-document'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">var</span> format <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'rehype-format'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">var</span> html <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'rehype-stringify'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">var</span> report <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'vfile-reporter'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token function\">unified</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>markdown<span class=\"token punctuation\">)</span>      <span class=\"token comment\">// パーサー（マークダウン文字列を構文木に変換）</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>remark2rehype<span class=\"token punctuation\">)</span> <span class=\"token comment\">// トランスフォーマー（マークダウンからHTMLに変換）</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>doc<span class=\"token punctuation\">)</span>           <span class=\"token comment\">// トランスフォーマー（HTMLタグなどでラップ）</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>format<span class=\"token punctuation\">)</span>        <span class=\"token comment\">// トランスフォーマー（HTMLをフォーマット）</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>html<span class=\"token punctuation\">)</span>          <span class=\"token comment\">// コンパイラー（rehypeの構文木を文字列に変換）</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">process</span><span class=\"token punctuation\">(</span><span class=\"token string\">'# Hello world!'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">err<span class=\"token punctuation\">,</span> file</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token function\">report</span><span class=\"token punctuation\">(</span>err <span class=\"token operator\">||</span> file<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token function\">String</span><span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<div class=\"gatsby-code-title\">実行結果</div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">no issues found\n&lt;!DOCTYPE html>\n&lt;html lang=\"en\">\n  &lt;head>\n    &lt;meta charset=\"utf-8\">\n    &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n  &lt;/head>\n  &lt;body>\n    &lt;h1>Hello world!&lt;/h1>\n  &lt;/body>\n&lt;/html></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id=\"unified採用の経緯\" style=\"position:relative;\"><a href=\"#unified%E6%8E%A1%E7%94%A8%E3%81%AE%E7%B5%8C%E7%B7%AF\" aria-label=\"unified採用の経緯 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>unified採用の経緯</h3>\n<p>このブログ(Gatsby製)は<a href=\"https://github.com/gatsbyjs/gatsby/tree/master/packages/gatsby-transformer-remark\">gatsby-trasform-remark</a>というプラグインでマークダウン情報を取得しています。ただ目次情報についてはHTML化した目次しか取得できません。\nQiitaっぽい目次作成には少々難ありです。<br>\nそんなこんなで悩んでいたところ<a href=\"https://github.com/gatsbyjs/gatsby/blob/master/packages/gatsby-transformer-remark/src/extend-node-type.js#L20\">プラグインのソース</a>を見てみたらマークダウン文字列解析にunifiedを使っていることに気づきました。\n幸いプラグインで生のマークダウン文字列を取得できたので、unidiedで目次情報を抽出して実現できそうだと考え、採用に至りました。</p>\n<h2 id=\"実装\" style=\"position:relative;\"><a href=\"#%E5%AE%9F%E8%A3%85\" aria-label=\"実装 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>実装</h2>\n<p>ポイントを載せていきます。詳細は<a href=\"https://github.com/Takumon/react-markdown-sync-toc\">ソースコード</a>を見てください。</p>\n<h3 id=\"マークダウンをhmtl化する\" style=\"position:relative;\"><a href=\"#%E3%83%9E%E3%83%BC%E3%82%AF%E3%83%80%E3%82%A6%E3%83%B3%E3%82%92hmtl%E5%8C%96%E3%81%99%E3%82%8B\" aria-label=\"マークダウンをhmtl化する permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>マークダウンをHMTL化する</h3>\n<p>マークダウン文字列を読み込んでHTML文字列に変換します。\n現在画面に表示中の章を判定するために<a href=\"https://github.com/remarkjs/remark-slug\">remark-slug</a>を使って章にidを付与しています。\nちなみにこの<a href=\"https://github.com/remarkjs/remark-slug\">remark-slug</a>は<a href=\"https://github.com/syntax-tree/mdast-util-to-string\">mdast-util-to-string</a>と<a href=\"https://github.com/Flet/github-slugger\">github-slugger</a>を使ってidを付与しています。<br></p>\n<p><em>※実際はReactコンポーネントですが簡単のためソースコードを一部省略しています。</em></p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> unified <span class=\"token keyword\">from</span> <span class=\"token string\">'unified'</span>\n<span class=\"token keyword\">import</span> markdown <span class=\"token keyword\">from</span> <span class=\"token string\">'remark-parse'</span>       <span class=\"token comment\">// パーサー(文字列をremarkの構文木に変換)</span>\n<span class=\"token keyword\">import</span> slug <span class=\"token keyword\">from</span> <span class=\"token string\">'remark-slug'</span>            <span class=\"token comment\">// トランスフォーマー(章にidをつける)</span>\n<span class=\"token keyword\">import</span> remark2rehype <span class=\"token keyword\">from</span> <span class=\"token string\">'remark-rehype'</span> <span class=\"token comment\">// トランスフォーマー(マークダウンからHTMLに変換)</span>\n<span class=\"token keyword\">import</span> html <span class=\"token keyword\">from</span> <span class=\"token string\">'rehype-stringify'</span>       <span class=\"token comment\">// コンパイラー(HTML構文木を文字列に変換)</span>\n\n<span class=\"token keyword\">const</span> rawMarkdownBody <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">## なにこれ\nReactでMarkdownファイルを読み込んで表示するアプリ。\\n\n目次も表示します。特徴としては目次においてスクロールに応じて現在表示中のセクションがハイライトされます。\n\n## 大セクション その1</span><span class=\"token template-punctuation string\">`</span></span>\n･\n･\n･\n`<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> contents <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span>\n  <span class=\"token function\">unified</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>markdown<span class=\"token punctuation\">)</span>        <span class=\"token comment\">// パーサー(文字列をremarkの構文木に変換)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>slug<span class=\"token punctuation\">)</span>            <span class=\"token comment\">// トランスフォーマー(章にidをつける)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>remark2rehype<span class=\"token punctuation\">)</span>   <span class=\"token comment\">// トランスフォーマー(マークダウンからHTMLに変換)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>html<span class=\"token punctuation\">)</span>            <span class=\"token comment\">// コンパイラー(HTML構文木を文字列に変換)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">processSync</span><span class=\"token punctuation\">(</span>rawMarkdownBody<span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<br>\n<div class=\"gatsby-code-title\">変換の流れ</div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">マークダウン文字列\n│\n│ ←　remark-parse(パーサー)\n↓\nmdast構文木\n│\n│ ←　remark-slug(トランスフォーマー)\n↓\n章にidをつけたmdast構文木\n│\n│ ← remark-rehype(トランスフォーマー)\n↓\nhast構文木\n│\n│ ← rehype-stringify(コンパイラー)\n↓\nHTML文字列</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id=\"マークダウンから目次情報を抽出する\" style=\"position:relative;\"><a href=\"#%E3%83%9E%E3%83%BC%E3%82%AF%E3%83%80%E3%82%A6%E3%83%B3%E3%81%8B%E3%82%89%E7%9B%AE%E6%AC%A1%E6%83%85%E5%A0%B1%E3%82%92%E6%8A%BD%E5%87%BA%E3%81%99%E3%82%8B\" aria-label=\"マークダウンから目次情報を抽出する permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>マークダウンから目次情報を抽出する</h3>\n<p>remarkのparseメソッドを使うと簡単にマークダウン構文木を取得できます。\nそして取得した構文木から独自ロジックで目次情報を抽出します。\n具体的には構文木を再帰的に捜査できるプラグイン<a href=\"https://github.com/syntax-tree/unist-util-visit\">unist-util-visit</a>を使って目次情報を抽出しました。<br>\nid付与のロジックはマークダウン生成時のロジック(remark-slugのロジック）とあわせています。<br></p>\n<p><em>※実際はReactコンポーネントですが簡単のためソースコードを一部省略しています。</em></p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> remark <span class=\"token keyword\">from</span> <span class=\"token string\">'remark'</span>\n<span class=\"token keyword\">import</span> visit <span class=\"token keyword\">from</span> <span class=\"token string\">'unist-util-visit'</span>\n<span class=\"token keyword\">import</span> mdastToString <span class=\"token keyword\">from</span> <span class=\"token string\">'mdast-util-to-string'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> GithubSlugger <span class=\"token keyword\">from</span> <span class=\"token string\">'github-slugger'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> githubSlugger <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">GithubSlugger</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// マークダウン文字列から目次情報を抽出する</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">_extractToc</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">rawMarkdownBody</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  githubSlugger<span class=\"token punctuation\">.</span><span class=\"token function\">reset</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> result <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token keyword\">const</span> ast <span class=\"token operator\">=</span> <span class=\"token function\">remark</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span>rawMarkdownBody<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">visit</span><span class=\"token punctuation\">(</span>ast<span class=\"token punctuation\">,</span> <span class=\"token string\">'heading'</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">child</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">const</span> value <span class=\"token operator\">=</span> child<span class=\"token punctuation\">.</span>children<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>value</span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">const</span> id <span class=\"token operator\">=</span> githubSlugger<span class=\"token punctuation\">.</span><span class=\"token function\">slug</span><span class=\"token punctuation\">(</span>value <span class=\"token operator\">||</span> <span class=\"token function\">mdastToString</span><span class=\"token punctuation\">(</span>child<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">const</span> depth <span class=\"token operator\">=</span> child<span class=\"token punctuation\">.</span>depth</span><span class=\"gatsby-highlight-code-line\">    result<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">      value<span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\">      id<span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\">      depth</span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></span>\n  <span class=\"token keyword\">return</span> result\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>この後さらに目次情報を加工していきますが説明が長くなるので省略します。詳細は<a href=\"https://github.com/Takumon/react-markdown-sync-toc/blob/master/src/scroll-sync-toc.js#L87-L169\">ソースコード</a>をご覧ください。</p>\n<h3 id=\"スクロール毎に表示中の章を判定する\" style=\"position:relative;\"><a href=\"#%E3%82%B9%E3%82%AF%E3%83%AD%E3%83%BC%E3%83%AB%E6%AF%8E%E3%81%AB%E8%A1%A8%E7%A4%BA%E4%B8%AD%E3%81%AE%E7%AB%A0%E3%82%92%E5%88%A4%E5%AE%9A%E3%81%99%E3%82%8B\" aria-label=\"スクロール毎に表示中の章を判定する permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>スクロール毎に表示中の章を判定する</h3>\n<p>Reactのコンポーネントで実装します。\nスクロールイベントは<code class=\"language-text\">componentDidMount</code>で購読を開始し<code class=\"language-text\">componentWillUnmount</code>で破棄します。<br>\n<strong>スクロール処理は高負荷なので<a href=\"https://lodash.com/docs/4.17.10#throttle\">Lodashのthrottle</a>で100ミリ秒ごとに間引いています。</strong>\n現在表示中の章の情報はsetStateでstateに格納しています。これにより表示中の章が切り替わった時にReactが再描画してくれます。</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> throttle <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'lodash'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> Toc <span class=\"token keyword\">from</span> <span class=\"token string\">'./toc'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> githubSlugger <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">GithubSlugger</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">ScrollSyncToc</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props<span class=\"token punctuation\">,</span> context</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">,</span> context<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>toc <span class=\"token operator\">=</span> <span class=\"token function\">_getToc</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>rawMarkdownBody<span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">activeItemIds</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">itemTopOffsets</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>calculateItemTopOffsets <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">calculateItemTopOffsets</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleScroll <span class=\"token operator\">=</span> <span class=\"token function\">throttle</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleScroll</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// 負荷軽減のため間引く</span></span>  <span class=\"token punctuation\">}</span>\n\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">componentDidMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">calculateItemTopOffsets</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">    window<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">scroll</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleScroll<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span></span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">componentWillUnmount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    window<span class=\"token punctuation\">.</span><span class=\"token function\">removeEventListener</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">scroll</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleScroll<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span></span>\n  <span class=\"token function\">calculateItemTopOffsets</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">itemTopOffsets</span><span class=\"token operator\">:</span> <span class=\"token function\">_getElementTopOffsetsById</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>toc<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token function\">handleScroll</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> itemTopOffsets <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\"></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">const</span> item <span class=\"token operator\">=</span> itemTopOffsets<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">current<span class=\"token punctuation\">,</span> i</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token keyword\">const</span> next <span class=\"token operator\">=</span> itemTopOffsets<span class=\"token punctuation\">[</span>i <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span></span><span class=\"gatsby-highlight-code-line\"></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token comment\">// 自章よりもスクロールしている</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token comment\">// かつ 次章まではスクロールしていない 場合は</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token comment\">// 自章が表示されているとみなす</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token keyword\">return</span> next</span><span class=\"gatsby-highlight-code-line\">        <span class=\"token operator\">?</span> window<span class=\"token punctuation\">.</span>scrollY <span class=\"token operator\">>=</span> current<span class=\"token punctuation\">.</span>offsetTop <span class=\"token operator\">&amp;&amp;</span></span><span class=\"gatsby-highlight-code-line\">            window<span class=\"token punctuation\">.</span>scrollY <span class=\"token operator\">&lt;</span> next<span class=\"token punctuation\">.</span>offsetTop</span><span class=\"gatsby-highlight-code-line\">        <span class=\"token operator\">:</span> window<span class=\"token punctuation\">.</span>scrollY <span class=\"token operator\">>=</span> current<span class=\"token punctuation\">.</span>offsetTop<span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></span><span class=\"gatsby-highlight-code-line\"></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token comment\">// Qiitaっぽく自章とあわせて親章をハイライトさせたいので</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token comment\">// itemTopOffsetsでは親章の参照も持たせておき</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token comment\">// ここでactiveItemIdsに格納しています。</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">const</span> activeItemIds <span class=\"token operator\">=</span></span><span class=\"gatsby-highlight-code-line\">      item</span><span class=\"gatsby-highlight-code-line\">        <span class=\"token operator\">?</span> item<span class=\"token punctuation\">.</span>parents</span><span class=\"gatsby-highlight-code-line\">          <span class=\"token operator\">?</span> <span class=\"token punctuation\">[</span>item<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span>item<span class=\"token punctuation\">.</span>parents<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">i</span> <span class=\"token operator\">=></span> i<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span></span><span class=\"gatsby-highlight-code-line\">          <span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>item<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">]</span></span><span class=\"gatsby-highlight-code-line\">        <span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\"></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token comment\">// setStateを介してstateを変更することで</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token comment\">// 表示中の章に変更があった場合にのみ再描画が走ります。</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>activeItemIds<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">  <span class=\"token punctuation\">}</span></span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> activeItemIds <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>Toc activeItemIds<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>activeItemIds<span class=\"token punctuation\">}</span> toc<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>toc<span class=\"token punctuation\">}</span> <span class=\"token punctuation\">{</span><span class=\"token operator\">...</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<br>\n<p>実際の目次コンポーネントでは、\n<code class=\"language-text\">toc</code>(目次情報)と<code class=\"language-text\">activeItemIds</code>(現在表示中の章)をインプットに目次を描画します。\nこのとき表示中の章には<code class=\"language-text\">active</code>クラスをつけて描画しています。</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> HashLink <span class=\"token keyword\">as</span> Link <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react-router-hash-link'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Toc</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> toc<span class=\"token punctuation\">,</span> activeItemIds <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> items <span class=\"token operator\">=</span> toc<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">item</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n        <span class=\"token operator\">&lt;</span>li style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>\n          <span class=\"token literal-property property\">textAlign</span><span class=\"token operator\">:</span> <span class=\"token string\">'left'</span><span class=\"token punctuation\">,</span>\n          <span class=\"token literal-property property\">marginLeft</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">.</span>depth <span class=\"token operator\">-</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">24</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n          <span class=\"token literal-property property\">listStyle</span><span class=\"token operator\">:</span> <span class=\"token string\">'none'</span>\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span>Link\n            key<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>item<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">}</span>\n            to<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">#</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>item<span class=\"token punctuation\">.</span>id<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">}</span>\n<span class=\"gatsby-highlight-code-line\">            className<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>activeItemIds<span class=\"token punctuation\">.</span><span class=\"token function\">includes</span><span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> <span class=\"token string\">'active'</span> <span class=\"token operator\">:</span> <span class=\"token string\">''</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span><span class=\"token punctuation\">{</span>item<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Link<span class=\"token operator\">></span></span>        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>li<span class=\"token operator\">></span>\n      <span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token operator\">&lt;</span>ul style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">padding</span><span class=\"token operator\">:</span> <span class=\"token string\">'12px'</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">background</span><span class=\"token operator\">:</span> <span class=\"token string\">'#eee'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n        <span class=\"token punctuation\">{</span>items<span class=\"token punctuation\">}</span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>ul<span class=\"token operator\">></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> Toc<span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id=\"まとめ\" style=\"position:relative;\"><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\" aria-label=\"まとめ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>まとめ</h2>\n<p>Qiitaっぽい目次を作れたことよりも<a href=\"https://unified.js.org/\">unified</a>の便利さに驚きました。\nこれを使えば解析ツールなども簡単に実装できそうなので踏み込んで調べてみたいです🍅</p>","excerpt":"なにこれ 自分のブログの目次をQiitaっぽくしたい...現在表示中の章をハイライトする目次を作りたい...ということで作りました。\nマークダウンをHTMLに変換するのにunifiedという構文解析ライブラリを使っています。\nメモ用にReact…","frontmatter":{"slug":"/2018/10/28/","title":"unifiedでMarkdownをHTMLに変換 & ReactでQiitaっぽい目次を作る","date":"2018-10-28T21:00:00.000Z","tags":["React","unified","remark","rehype"],"keywords":["React"],"thumbnail":"thumbnail/2018/qiita-like-top-of-content-with-unified.png","category":null}},{"html":"<h2 id=\"なにこれ\" style=\"position:relative;\"><a href=\"#%E3%81%AA%E3%81%AB%E3%81%93%E3%82%8C\" aria-label=\"なにこれ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>なにこれ</h2>\n<p>Gatsby製ブログ(Reactアプリ)でSNS対応した時のメモです。<br>\n<strong>(1) SNSシェアボタン</strong>と**(2) 自分のSNSへのリンク<strong>を設置して、ブログの記事をSNSでシェアできるように、、、<br>\nまた、</strong>(3) OGPタグを設定し**、SNSでシェアするときにイメージ画像や、タイトル、記事概要を表示できるようにしました。</p>\n<ul>\n<li>ブログのフッター\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 688px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/40ebf4eb5a183b28914eaaaa44244573/ebf47/blog-footer.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 59.00000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAAB6UlEQVR42o1RwW7TQBDN7/AZ3PgJLnwTXHqpECBU1AMCCQ6hSuGAKkgkgpK0SdvESRrHjeM4sb32endmHrKT0pamoiM9zc7uzNv3NBUnNJ1OIGFnTrN2QH5nTn5rTv7Zgv1RSP5gyf7pgnww+W5Mfj9cny2RT9eYEdHSWtutfGwuvL1aH+bws9Tqx3h5ssA7l3F4meP5cYI9J8OPmWB/DDz7Cjw9QBkiuBllxcx+pefr6dFIo93z+Nv5SqrDVGoTK5+GWna7qbw9y6QTsISa5NeM5Pe8HBbmdd6AN4SzCjN5BGAUGbmIDNyVwWSZYxrlSDSXCDOCFxlcxgbMt6XdUUhEHtaVbO6v3nE1K4U/kTIXbSK3wZtf1oRGe0O3hThaSKIyRFGMVaSg4gggjWWSwZj8Dsm9hOmF4315/Aj7O6/lRa2DN60Ir5rf8aEXYqdt8eS9QdWxpVLa6vYfy9YYD+4YAzeUhqvQXgI/Zx6GMaEbAbsngBNt3ex2QmOMlxEhTVPRWQqbKoDpxgIfFNeEcRxPBv0+xuOxOXccOzntWZPEhccSOjeWmf/W98BsCKcVa63HzFBKCRHBGAOtdVEjz3MEQVA0PlxhkiTVJEmaSqm6UqpRIE3TMmdZ1sh01tBa/w91rXVTa33wB1DtkvmfpVpGAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/40ebf4eb5a183b28914eaaaa44244573/ba381/blog-footer.webp 200w,\n/static/40ebf4eb5a183b28914eaaaa44244573/7f61c/blog-footer.webp 400w,\n/static/40ebf4eb5a183b28914eaaaa44244573/01c7f/blog-footer.webp 688w\"\n              sizes=\"(max-width: 688px) 100vw, 688px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/40ebf4eb5a183b28914eaaaa44244573/772e8/blog-footer.png 200w,\n/static/40ebf4eb5a183b28914eaaaa44244573/e17e5/blog-footer.png 400w,\n/static/40ebf4eb5a183b28914eaaaa44244573/ebf47/blog-footer.png 688w\"\n            sizes=\"(max-width: 688px) 100vw, 688px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/40ebf4eb5a183b28914eaaaa44244573/ebf47/blog-footer.png\"\n            alt=\"ブログフッタ\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></li>\n<li>Twitterの呟き\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 593px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/02284f3b19c4276293b4613fc734338c/0b5b1/tweet-sample-with-number.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAACBklEQVR42n2RTW7TUBSFvRm2gAQzRgg2wA4QggnqrBOYIbEAGFaIBSAGCJS6La3b9Cdp49ixXcc/iRPnxU7c1rHdpon93j0oRSBGfNKne84d3iu1Tr8lMWOhadrMtGxmW13me30WDBkbsfjOLCsYG0/YoixZWVVsfrtgt4sFW5YlqzhfGZZVlc4XS1nauX8PE0sTTthDEPiIkwiDaIjewIc/9BGOh5hdp5gmMYrZFdKLKbI0xSxJcJMXWCGEEKvJOdckwSK0JznfCmJqsIzqoyvaGcRUnxa0lxS0G6Ukjy5JiXM66F3RcT+j8xnu7FxwMi9BVkq8vwSMhLelZ3XgzE3EvHOC5v5X9JrbuPXO4fVD1BsaGi0Dph3gTLdx2NSw31BxrJqwe6O7nR/GONUtkc5L/BwJTXp1BFhBIqqN95BfPoLx4imqzS9gcQTfcWAZOnS1Defcgu+50NUWWs0zeF0HHbUN2zShq6q4KQocMK5Jr1XACBJ+vf6c8scPKH/ykE7erVOS58SGIZ02m9S1uxRHEY3CkHqeR+FgSNPJhHStQ4ZukOO4fHXDOuNtKQFgR7nAiQz77RqO36zh+8ZHXN/MsagE5ssKXBD+x5+nHIy5Ji3nxdGONdmrdcbK50NX+VBrKZ82W0rNThXZLRTZKxTZzX7nf9x0M2Xb+9t3t9y88cOebfwCvrwzdiIdAwQAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/02284f3b19c4276293b4613fc734338c/ba381/tweet-sample-with-number.webp 200w,\n/static/02284f3b19c4276293b4613fc734338c/7f61c/tweet-sample-with-number.webp 400w,\n/static/02284f3b19c4276293b4613fc734338c/ee627/tweet-sample-with-number.webp 593w\"\n              sizes=\"(max-width: 593px) 100vw, 593px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/02284f3b19c4276293b4613fc734338c/772e8/tweet-sample-with-number.png 200w,\n/static/02284f3b19c4276293b4613fc734338c/e17e5/tweet-sample-with-number.png 400w,\n/static/02284f3b19c4276293b4613fc734338c/0b5b1/tweet-sample-with-number.png 593w\"\n            sizes=\"(max-width: 593px) 100vw, 593px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/02284f3b19c4276293b4613fc734338c/0b5b1/tweet-sample-with-number.png\"\n            alt=\"つぶやきサンプル\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></li>\n</ul>\n<h2 id=\"1-snsシェアボタンを設置\" style=\"position:relative;\"><a href=\"#1-sns%E3%82%B7%E3%82%A7%E3%82%A2%E3%83%9C%E3%82%BF%E3%83%B3%E3%82%92%E8%A8%AD%E7%BD%AE\" aria-label=\"1 snsシェアボタンを設置 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. SNSシェアボタンを設置</h2>\n<h3 id=\"facebookgooglelinkedintwitterシェアボタン\" style=\"position:relative;\"><a href=\"#facebookgooglelinkedintwitter%E3%82%B7%E3%82%A7%E3%82%A2%E3%83%9C%E3%82%BF%E3%83%B3\" aria-label=\"facebookgooglelinkedintwitterシェアボタン permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Facebook、Google、Linkedin、Twitterシェアボタン</h3>\n<p><a href=\"https://github.com/nygardk/react-share\">react-share</a>でめっちゃ簡単にできます。<br>\nそれぞれ専用タグが用意されているので<br>\n<code class=\"language-text\">url</code>属性に記事のURL、<code class=\"language-text\">icon</code>属性にアイコンサイズを指定するだけです。<br>\nLinkedinアイコンはそれに加えて<code class=\"language-text\">title</code>属性に記事タイトルを<br>\nTwitterアイコンは<code class=\"language-text\">via</code>属性に自分のTwitterアカウント名、<code class=\"language-text\">title</code>属性に記事タイトルを指定します。<br>\n※下記コード中の<code class=\"language-text\">articleUrl</code>は記事URL、<code class=\"language-text\">articleTitle</code>は記事タイトルです。</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"html\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-html line-numbers\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>FacebookShareButton</span> <span class=\"token attr-name\">url</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span>{articleUrl}</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>FacebookIcon</span> <span class=\"token attr-name\">size</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span>{32}</span> <span class=\"token attr-name\">round</span> <span class=\"token punctuation\">/></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>FacebookShareButton</span><span class=\"token punctuation\">></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>GooglePlusShareButton</span> <span class=\"token attr-name\">url</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span>{articleUrl}</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>GooglePlusIcon</span> <span class=\"token attr-name\">size</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span>{32}</span> <span class=\"token attr-name\">round</span> <span class=\"token punctuation\">/></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>GooglePlusShareButton</span><span class=\"token punctuation\">></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>LinkedinShareButton</span> <span class=\"token attr-name\">url</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span>{articleUrl}</span><span class=\"token punctuation\">></span></span>\n<span class=\"gatsby-highlight-code-line\">  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>LinkedinIcon</span> <span class=\"token attr-name\">title</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span>{articleTitle}</span> <span class=\"token attr-name\">size</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span>{32}</span> <span class=\"token attr-name\">round</span> <span class=\"token punctuation\">/></span></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>LinkedinShareButton</span><span class=\"token punctuation\">></span></span>\n\n<span class=\"gatsby-highlight-code-line\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>TwitterShareButton</span> <span class=\"token attr-name\">title</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span>{articleTitle}</span> <span class=\"token attr-name\">via</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>@inouetakumon<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">url</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span>{articleUrl}</span><span class=\"token punctuation\">></span></span></span>  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>TwittearIcon</span> <span class=\"token attr-name\">size</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span>{32}</span> <span class=\"token attr-name\">round</span> <span class=\"token punctuation\">/></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>TwitterShareButton</span><span class=\"token punctuation\">></span></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<br>\nすると下記のように画面にSNSシェアアイコンが表示されます。\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 205px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/2c11587fd21ffd363fffff8a39fc118c/85860/sns-share-icons.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 33.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABq0lEQVR42l3Qv08UQRQH8P1//BPsvRgaIjFijAWnksBIUGNhIiWNdkRiIREbYyykEDIe4rC3u2RhIYCRgggCHiFm4Qh3e4c7c2/3zT0zc1eA07xvPnnz6zlStspKwVyWZVxKxSEDDlJ2KnQzAE+l4qZHAXCpFM+MKeCYgbHZFkBQrVZ7HCIi1G3MkS4vjURtfYlMS/v/to7nJsdxPOKkLaJ7z2egb/Q9hhu/zR6Ue7t4OHQbKwO9mO5sW1v+dYxXX85jz6tFPKql1uYrCq/P1fDZcrNlDkxOT5jz2dunwoO3ODI+S4Njn+yt1akJ+jM2SpWBXjqefGGt+G6Jns5sUP9UQK/9HWt3FxJaOAIa8hr5SpOIVO2hc9bI6daTD1nh/rT+4m2bH+jzrU1dKd7QB/0F3dxctcZ/HOprE9/0zTee/hkn1j7uSn3na10XRQLmyWntlNkZnqcZnjWgM5R2d0qNOlEz6VqnnPzNqa70RaIYiFK8MEMhyo9WwmB4fS1kQgjmui5zhWB+FDE/WrPZmBAuW4+WWBT6NltzXfY99FngucPlIHhcKpWu/APXq9q5ErKu+QAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/2c11587fd21ffd363fffff8a39fc118c/ba381/sns-share-icons.webp 200w,\n/static/2c11587fd21ffd363fffff8a39fc118c/ac387/sns-share-icons.webp 205w\"\n              sizes=\"(max-width: 205px) 100vw, 205px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/2c11587fd21ffd363fffff8a39fc118c/772e8/sns-share-icons.png 200w,\n/static/2c11587fd21ffd363fffff8a39fc118c/85860/sns-share-icons.png 205w\"\n            sizes=\"(max-width: 205px) 100vw, 205px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/2c11587fd21ffd363fffff8a39fc118c/85860/sns-share-icons.png\"\n            alt=\"SNSシェアアイコン\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h3 id=\"はてブ追加ボタン\" style=\"position:relative;\"><a href=\"#%E3%81%AF%E3%81%A6%E3%83%96%E8%BF%BD%E5%8A%A0%E3%83%9C%E3%82%BF%E3%83%B3\" aria-label=\"はてブ追加ボタン permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>はてブ追加ボタン</h3>\n<p><code class=\"language-text\">bookmark_button.js</code>というJavaScriptファイルを読み込んで、リンクタグを設置するだけです。</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-jsx line-numbers\"><code class=\"language-jsx\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Helmet</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text/javascript<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>//b.st-hatena.com/js/bookmark_button.js<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">charset</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>utf-8<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">async</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>async<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Helmet</span></span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span>\n  <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>http://b.hatena.ne.jp/entry/<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>hatena-bookmark-button<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">data-hatena-bookmark-layout</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>vertical-normal<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">data-hatena-bookmark-lang</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>ja<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">title</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>このエントリーをはてなブックマークに追加<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span>\n    <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>//b.st-hatena.com/images/entry-button/button-only@2x.png<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\">alt</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>このエントリーをはてなブックマークに追加<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\">width</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>20<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\">height</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>20<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\">style</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">border</span><span class=\"token operator\">:</span> <span class=\"token string\">'none'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span>\n  <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<br>\nすると下記のように画面にはてブ追加アイコンが表示されます。\n![はてブシェアアイコン](./hatebu1.png)\n<p>クリックするとウィジェットが表示されます。(<code class=\"language-text\">bookmark_button.js</code>がやってくれています。)\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 384px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/6bfedc72173d0e1cef493d7a565ad517/804b2/hatebu2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 132.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAaCAYAAAC3g3x9AAAACXBIWXMAAAsTAAALEwEAmpwYAAAEOUlEQVR42p1Uz28bRRhdIcTfwA0hLgjOHDimitpDkZBAlB4KbUQOOQFF6iFXLggEB0rTVhQ4UQmBAkqVH0Qips0mSEQoeO04JnEcx15711l7Nzv7e707+9A3cWLTRjSw0ts3M9+nN59mvjeS7TizScJ9j3lGGsddQhzH3V6vd2okSbKfpmkcx/FP0rdbXXmqkeGjcsA/3OGYqiVIeAb6Dv+P/7IsS4mjKMpJ7y03ll9aNHDu1lx6/rO72ZXb09nc/Hw2Pz+fLSz8nM3NzQksLi4KzM7OZjMzM8e4d+9etvpgPmmpVQRBtCRN3N+Tz+RMnHvnXX717Tcx+cH7mJiYwJWxMYyNjeHSpUsYHx/H5OQkrl27hosXL2JkZASjo6M4MzKCs6+cx8cvP58++OITOBw5aWHLkH93AWV7l29sbOBPpYBCoQBFUQQ2NzdRKpVQLBYFl8tlwZRD+ZvlMnYUJXVNEzZjOckPQ9mxOiiXSrxQLIqkZrMJTdOwvb2NvKIcC5GIqqowDAOVSgW12h4cx6HjE2doWVZO8sJQVvU2VlZX+fr6OlZWViDLMvbqe6LCfD6PYnEDa2trYrNer4cwDBGGkeAoipDGsRA0haDnyTRxHIfHcQzGGLrdLoIggOd5ooIjtm37X2/ZNM2c1G635SzL4Ps+932fWAi4riv44TEJ06bER7BtWwjatp2TdF2XabFSqfBqtSrOJ01TgSRJBB4eD4NzTkWkxMeCFAiCgFMFdCb/9QvDcCCoaZrMASQAT7IMPQ7EffSyIfTn8VA86KVgfgiLuSkd22GFmi4fmizhQnYIGe/RNkDaZ5pnR/EUceDC3tdgm8agbfyuIU/9xXB2oc7fWFLx+i8DjC9ruHy/hYmVFt6638SVBy1cWFLxWj9+IdfEqzkNV39rpVSUZdk5KTkw5MuyCWmqwp/8ugrpqz7uVPHstIrnflTx4kwTT//QwDPTKp76ZhfSlzuQ7uzgCcq7VcEL3+0O+tDuGPKvTQef/qHym4qGG3lCC1OKjuuKjqlCG9eVNm4Q53URv1nQcXvDEOPP8zrulvRBhXq7LbtmB+1ahbf3qqhvbaK+VYLRqMHrtJE4FlLXhm8aMBq7Yp3ta8gCFx21hgOtgdZuZXCG1DY0caltwgh+GMGLInhhCD+KBdwggOsHhxyEfQ7gBSEcPwBzvYGgZVky2UxVVW5ZlngYGo0GdF1HrVZDvV4XzXuaB1YIMsYOK3RdTmYnvxJoE7Ic2Yw8Ti4hphxiMgBtRP3HOR8I2rYtU9CyLOEUqoosSNWS4MHBgfAwMT0a9Hx1Oh0BEnukQhIUD1pK7jne8dinw2snoe/pRwWTJOFDCcPJ/xAfjp0oyBhb7gumSZJkR0jTNBueD6+dwElfcElyXVdUyB93lae4ZcdxRB9+zxhrM8aqjLHa/4HjODumaXaazebdvwEPPmMMrskVmwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/6bfedc72173d0e1cef493d7a565ad517/ba381/hatebu2.webp 200w,\n/static/6bfedc72173d0e1cef493d7a565ad517/e6f2f/hatebu2.webp 384w\"\n              sizes=\"(max-width: 384px) 100vw, 384px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/6bfedc72173d0e1cef493d7a565ad517/772e8/hatebu2.png 200w,\n/static/6bfedc72173d0e1cef493d7a565ad517/804b2/hatebu2.png 384w\"\n            sizes=\"(max-width: 384px) 100vw, 384px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/6bfedc72173d0e1cef493d7a565ad517/804b2/hatebu2.png\"\n            alt=\"はてブシェアアイコンウィジェット\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h2 id=\"2-自分のsnsへのリンクを設置\" style=\"position:relative;\"><a href=\"#2-%E8%87%AA%E5%88%86%E3%81%AEsns%E3%81%B8%E3%81%AE%E3%83%AA%E3%83%B3%E3%82%AF%E3%82%92%E8%A8%AD%E7%BD%AE\" aria-label=\"2 自分のsnsへのリンクを設置 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. 自分のSNSへのリンクを設置</h2>\n<p>SNSへのリンクアイコンは<a href=\"https://github.com/FortAwesome/react-fontawesome\">react-fontawesome</a>を使いました。<br>\nまずはreact-fontawesomeをインストールします。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> <span class=\"token parameter variable\">--save</span> @fortawesome/react-fontawesome\n<span class=\"token function\">npm</span> <span class=\"token function\">install</span> <span class=\"token parameter variable\">--save</span> @fortawesome/fontawesome-svg-core\n<span class=\"token function\">npm</span> <span class=\"token function\">install</span> <span class=\"token parameter variable\">--save</span> @fortawesome/free-brands-svg-icons\n<span class=\"token function\">npm</span> <span class=\"token function\">install</span> <span class=\"token parameter variable\">--save</span> @fortawesome/free-solid-svg-icons\n<span class=\"token function\">npm</span> <span class=\"token function\">install</span> <span class=\"token parameter variable\">--save</span> @fortawesome/free-regular-svg-icons</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<br>\n実装は下記のようにします。スタイルの細かい部分は省略していますが、ざっくり書きのような感じです。Qiitaだけ小細工してます。\n<table>\n<thead>\n<tr>\n<th align=\"left\"></th>\n<th align=\"left\"></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align=\"left\">GitHub</td>\n<td align=\"left\">Font Awsomeアイコン使用。背景をダークグレイ。</td>\n</tr>\n<tr>\n<td align=\"left\">Twitter</td>\n<td align=\"left\">Font Awsomeアイコン使用。背景を水色。</td>\n</tr>\n<tr>\n<td align=\"left\">Qiita</td>\n<td align=\"left\">Font Awsomeに用意がないので、<strong>代わりに虫眼鏡アイコン使用。背景を黄緑にしてQiitaっぽくする</strong></td>\n</tr>\n</tbody>\n</table>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\">・・・\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> FontAwesomeIcon <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@fortawesome/react-fontawesome'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> faGithubSquare<span class=\"token punctuation\">,</span> faTwitterSquare <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@fortawesome/free-brands-svg-icons'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> faSearch <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@fortawesome/free-solid-svg-icons'</span>\n\n・・・\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Bio</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      ・・・\n<span class=\"gatsby-highlight-code-line\">      <span class=\"token operator\">&lt;</span>a href<span class=\"token operator\">=</span><span class=\"token string\">\"https://github.com/Takumon\"</span><span class=\"token operator\">></span></span><span class=\"gatsby-highlight-code-line\">       <span class=\"token operator\">&lt;</span>FontAwesomeIcon</span><span class=\"gatsby-highlight-code-line\">         color<span class=\"token operator\">=</span><span class=\"token string\">\"#333\"</span></span><span class=\"gatsby-highlight-code-line\">         icon<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>faGithubSquare<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>a<span class=\"token operator\">></span></span>\n<span class=\"gatsby-highlight-code-line\">      <span class=\"token operator\">&lt;</span>a href<span class=\"token operator\">=</span><span class=\"token string\">\"https://twitter.com/inouetakumon\"</span><span class=\"token operator\">></span></span><span class=\"gatsby-highlight-code-line\">        <span class=\"token operator\">&lt;</span>FontAwesomeIcon</span><span class=\"gatsby-highlight-code-line\">          color<span class=\"token operator\">=</span><span class=\"token string\">\"#3eaded\"</span></span><span class=\"gatsby-highlight-code-line\">          icon<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>faTwitterSquare<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>a<span class=\"token operator\">></span></span>\n<span class=\"gatsby-highlight-code-line\">      <span class=\"token operator\">&lt;</span>a href<span class=\"token operator\">=</span><span class=\"token string\">\"https://qiita.com/Takumon\"</span><span class=\"token operator\">></span></span><span class=\"gatsby-highlight-code-line\">        <span class=\"token operator\">&lt;</span>FontAwesomeIcon</span><span class=\"gatsby-highlight-code-line\">          color<span class=\"token operator\">=</span><span class=\"token string\">\"white\"</span></span><span class=\"gatsby-highlight-code-line\">          style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">            <span class=\"token literal-property property\">overflow</span><span class=\"token operator\">:</span> <span class=\"token string\">'hidden'</span><span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\">            <span class=\"token literal-property property\">height</span><span class=\"token operator\">:</span> <span class=\"token string\">'0.9em'</span><span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\">            <span class=\"token literal-property property\">width</span><span class=\"token operator\">:</span> <span class=\"token string\">'0.9em'</span><span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\">            <span class=\"token literal-property property\">backgroundColor</span><span class=\"token operator\">:</span> <span class=\"token string\">'#4cb10d'</span><span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\">            <span class=\"token literal-property property\">borderRadius</span><span class=\"token operator\">:</span> <span class=\"token string\">'2px'</span><span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\">            <span class=\"token literal-property property\">marginTop</span><span class=\"token operator\">:</span> <span class=\"token string\">'2px'</span><span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\">          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span><span class=\"gatsby-highlight-code-line\">          icon<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>faSearch<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>a<span class=\"token operator\">></span></span>\n      ・・・\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<br>\nここまでくると、下記のようなアイコンが画面に追加されています。\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 333px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a51384268a000f2fe0800400769fb044/24c7e/my-sns-icons.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 26.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAABWklEQVR42k2OzUoCURzFZ99j9Azt3LSrJ2jXWwRtCoIwQlGEiBauIiL62BRUIlS3REpMMswoP2pyHHPS7r05M96r/+kEFdSB3+Lwg8MxXK+/AQRv5HafhgGZAEwg+AX/+OsDgjkM/jvUAbwrpdaNge+lW6V9zC1N0MvlNoafALutIF9toWx1cF1pIPdgoVjvIFuqo9m00Ou8YuD14Lku2o4D27YJALTWKYM/l1K56XHER0d0YSpEO0WbZpLHtHv1RCtFnyKXgvbLNiVyKUoWTNor+xS/VXRkDkhpTZ7nke/7+nfw0PC0nw521nAzOUZyPYHNBx/z4Qhqj4846gC7FtDVDWw1wrjjTazWgdDFJ5ZrwBA/CYLg+6FSKmU0228x+cFzdrlwqvqSpSuSzR5UWCzTZuEMZ4vnnEWzFls4u2fRrGDVFmdSCNYTgrlSMM45E0KcSCnzjuNEvgAzS1wIg5CK3wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/a51384268a000f2fe0800400769fb044/ba381/my-sns-icons.webp 200w,\n/static/a51384268a000f2fe0800400769fb044/f885a/my-sns-icons.webp 333w\"\n              sizes=\"(max-width: 333px) 100vw, 333px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/a51384268a000f2fe0800400769fb044/772e8/my-sns-icons.png 200w,\n/static/a51384268a000f2fe0800400769fb044/24c7e/my-sns-icons.png 333w\"\n            sizes=\"(max-width: 333px) 100vw, 333px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/a51384268a000f2fe0800400769fb044/24c7e/my-sns-icons.png\"\n            alt=\"自分のSNSリンク\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h2 id=\"3-ogpタグを設定\" style=\"position:relative;\"><a href=\"#3-ogp%E3%82%BF%E3%82%B0%E3%82%92%E8%A8%AD%E5%AE%9A\" aria-label=\"3 ogpタグを設定 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. OGPタグを設定</h2>\n<p>OGPとは、「Open Graph Protcol」の略でFacebookやTwitterなどのSNSでシェアした際に、\nWEBページのタイトルやイメージ画像、説明文などをわかりやすく伝えるためのHTML要素です。\nOGPをWebページで設定することでユーザーに対してWEBページの内容を詳しく伝えることができます。</p>\n<h3 id=\"ogpタグを定義\" style=\"position:relative;\"><a href=\"#ogp%E3%82%BF%E3%82%B0%E3%82%92%E5%AE%9A%E7%BE%A9\" aria-label=\"ogpタグを定義 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>OGPタグを定義</h3>\n<p>Reactアプリだと、<a href=\"https://github.com/nfl/react-helmet\">ReactHelmet</a>を使います。<br>\n今回はOgpタグを作りました。ただブログのトップと記事詳細で設定する値が違うので、そこはコンポーネントの引数で受け取れるようにしています。<br>\n※<code class=\"language-text\">blog-config.js</code>はブログタイトルなどの設定しているファイルです。</p>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span>\n<span class=\"token keyword\">import</span> Helmet <span class=\"token keyword\">from</span> <span class=\"token string\">'react-helmet'</span>\n\n<span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">  blogTitle<span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\">  blogUrl<span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\">  blogDescription<span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\">  blogImageUrl<span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\">  facebookAppId<span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\">  blogAuthorTwitterUserName<span class=\"token punctuation\">,</span></span><span class=\"gatsby-highlight-code-line\"><span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'../config/blog-config.js'</span><span class=\"token punctuation\">;</span></span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">Ogp</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span>isRoot<span class=\"token punctuation\">,</span> title<span class=\"token punctuation\">,</span> description<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span>  <span class=\"token keyword\">const</span> type <span class=\"token operator\">=</span> isRoot <span class=\"token operator\">?</span> <span class=\"token string\">'website'</span> <span class=\"token operator\">:</span> <span class=\"token string\">'article'</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span><span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>Helmet<span class=\"token operator\">></span>\n<span class=\"gatsby-highlight-code-line\">      <span class=\"token operator\">&lt;</span>meta property<span class=\"token operator\">=</span><span class=\"token string\">\"og:title\"</span> content<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>title <span class=\"token operator\">||</span> blogTitle<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token operator\">&lt;</span>meta property<span class=\"token operator\">=</span><span class=\"token string\">\"og:description\"</span> content<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>description <span class=\"token operator\">||</span> blogDescription<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span></span><span class=\"gatsby-highlight-code-line\"></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token operator\">&lt;</span>meta property<span class=\"token operator\">=</span><span class=\"token string\">\"og:url\"</span> content<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>blogUrl<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token operator\">&lt;</span>meta property<span class=\"token operator\">=</span><span class=\"token string\">\"og:type\"</span> content<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>type<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token operator\">&lt;</span>meta property<span class=\"token operator\">=</span><span class=\"token string\">\"og:site_name\"</span> content<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>blogTitle<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token operator\">&lt;</span>meta property<span class=\"token operator\">=</span><span class=\"token string\">\"og:image\"</span> content<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>blogImageUrl<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token operator\">&lt;</span>meta property<span class=\"token operator\">=</span><span class=\"token string\">\"fb:app_id\"</span> content<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>facebookAppId<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token operator\">&lt;</span>meta name<span class=\"token operator\">=</span><span class=\"token string\">\"twitter:card\"</span> content<span class=\"token operator\">=</span><span class=\"token string\">\"summary\"</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token operator\">&lt;</span>meta name<span class=\"token operator\">=</span><span class=\"token string\">\"twitter:site\"</span> content<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">@</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>blogAuthorTwitterUserName<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span></span>    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Helmet<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<br>\nいろいろあるプロパティは下記の通り\n<br>\n<br>\n<table>\n<thead>\n<tr>\n<th align=\"left\">プロパティ名</th>\n<th align=\"left\">説明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align=\"left\">og:title</td>\n<td align=\"left\">ページのタイトル。SNS共有時は、headのtitleタグよりも優先して使われます。</td>\n</tr>\n<tr>\n<td align=\"left\">og:description</td>\n<td align=\"left\">ページの説明。</td>\n</tr>\n<tr>\n<td align=\"left\">og:url</td>\n<td align=\"left\">ページのURL。</td>\n</tr>\n<tr>\n<td align=\"left\">og:type</td>\n<td align=\"left\">ページの属性、だいたい<code class=\"language-text\">website</code>か<code class=\"language-text\">article</code>を指定します。詳細は<a href=\"http://ogp.me/#types\">ココ</a>参照</td>\n</tr>\n<tr>\n<td align=\"left\">og:site_name</td>\n<td align=\"left\">Webサイト名。</td>\n</tr>\n<tr>\n<td align=\"left\">og:image</td>\n<td align=\"left\">ページのイメージ画像</td>\n</tr>\n<tr>\n<td align=\"left\">fb:app_id</td>\n<td align=\"left\">FacebookのアプリID。FacebookでOGPを表示させる際に必須。アプリIDの取り方は<a href=\"https://design-plus1.com/tcd-w/2018/01/facebook_app_id.html\">FacebookのOGP設定に必要なfb:app IDの取得方法</a>参照。</td>\n</tr>\n<tr>\n<td align=\"left\">twitter:card</td>\n<td align=\"left\">OGPのレイアウトのタイプ。詳細は<a href=\"https://saruwakakun.com/html-css/reference/twitter-card\">【2018年版】Twitterカードとは？使い方と設定方法まとめ</a>参照。</td>\n</tr>\n<tr>\n<td align=\"left\">twitter:site</td>\n<td align=\"left\">Twitterのユーザ名。</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"ogpタグ呼び出し\" style=\"position:relative;\"><a href=\"#ogp%E3%82%BF%E3%82%B0%E5%91%BC%E3%81%B3%E5%87%BA%E3%81%97\" aria-label=\"ogpタグ呼び出し permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>OGPタグ呼び出し</h3>\n<p>こんどは作ったOgpタグを呼び出す側の実装です。\nGatsby製ブログではトップページとブログ議事ページの2カ所で呼び出します。</p>\n<h4 id=\"ブログトップページでの呼び出し\" style=\"position:relative;\"><a href=\"#%E3%83%96%E3%83%AD%E3%82%B0%E3%83%88%E3%83%83%E3%83%97%E3%83%9A%E3%83%BC%E3%82%B8%E3%81%A7%E3%81%AE%E5%91%BC%E3%81%B3%E5%87%BA%E3%81%97\" aria-label=\"ブログトップページでの呼び出し permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ブログトップページでの呼び出し</h4>\n<p><strong>src/layouts/index.js</strong><br>\n全体のテンプレートなのでURLがブログトップページの時のみOGPタグを呼び出します。</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-jsx line-numbers\"><code class=\"language-jsx\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Ogp</span></span> <span class=\"token attr-name\">isRoot</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>isRoot<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<h4 id=\"ブログ記事ページでの呼び出し\" style=\"position:relative;\"><a href=\"#%E3%83%96%E3%83%AD%E3%82%B0%E8%A8%98%E4%BA%8B%E3%83%9A%E3%83%BC%E3%82%B8%E3%81%A7%E3%81%AE%E5%91%BC%E3%81%B3%E5%87%BA%E3%81%97\" aria-label=\"ブログ記事ページでの呼び出し permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ブログ記事ページでの呼び出し</h4>\n<div class=\"gatsby-code-title\">src/templates/blog-post.js</div>\n<div class=\"gatsby-highlight has-highlighted-lines\" data-language=\"html\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-html line-numbers\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Ogp</span> <span class=\"token attr-name\">isRoot</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span>{isRoot}</span> <span class=\"token punctuation\">/></span></span>\n  isRoot={false}\n  title={`${post.frontmatter.title} | ${siteTitle}`}\n<span class=\"gatsby-highlight-code-line\">  description={sumarrize(post.html)}/></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>4行目の<code class=\"language-text\">sumarrize</code>メソッドではブログ記事(HTML形式)から<a href=\"https://github.com/ericnorris/striptags\">striptags</a>というライブラリを使ってテキストを抽出し、冒頭120文字を1行にして返すようにしています。</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-js line-numbers\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">sumarrize</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">html</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> postContent <span class=\"token operator\">=</span> <span class=\"token function\">striptags</span><span class=\"token punctuation\">(</span>html<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">\\r?\\n</span><span class=\"token regex-delimiter\">/</span><span class=\"token regex-flags\">g</span></span><span class=\"token punctuation\">,</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">trim</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> postContent<span class=\"token punctuation\">.</span>length <span class=\"token operator\">&lt;=</span> <span class=\"token number\">120</span>\n    <span class=\"token operator\">?</span> postContent\n    <span class=\"token operator\">:</span> postContent<span class=\"token punctuation\">.</span><span class=\"token function\">slice</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">120</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">'...'</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<br>\n<p>※<a href=\"https://github.com/ericnorris/striptags\">striptags</a>は非常に便利なライブラリですが、1点だけ注意点があって、最新バージョンの3系(2018/9/16現在)はGatsbyビルド時にエラーになるため<strong>2系を使用してください</strong>。Gatsbyではビルド時に<a href=\"https://github.com/mishoo/UglifyJS2\">Uglifyjs</a>を使用しているためES6のコードをコンパイルできません。</p>\n<br>\n<p>これでTwitterなどでシェアするとイメージ画像とタイトル、記事概要を表示してくれるようになります。\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 593px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/42d05ecc4e34468ed7e45e9125a2c432/0b5b1/tweet-sample.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAACBklEQVR42n2Ry27TUBRF/TN8A4IZIwQfgpAQk846KTMkPgCGFeIDEANUqUlbWvdB6zSJHcfOTfzIw76xE6d1bLduYl+fjVpEhyxp6WztwRmcI7Uuf0Yh972uwbhpMs7MPnecIR9NOPd5+GCSZJxPZ3xVFLwoS57frfjdasXXRcFLIe71irKM89W6Lh09fYK5qVaDiYvRyEEQBRgHE7gTB87EgTedYHkTYx4FSONrxIs5kjjGMopwm2a4h4jE/RRCaNLcCdEMU7E/CknhCZ3613QwDulkntHRIqPDIKYavyI5TOnYvabzYUJsCeotQfpCkHEFMmMSwzXQjYQqvTcAZRBVuX6By+MfcJV93Nk92EMPp4oGpaXDYCM0OwxnDQ3HShvnbQM910dTZ3C8EE29J+K8wC+/0qQcgDGMqmL7E/bevUD37WuUte/gYQBnMICp6+i0VQxYD65todNuodVowu73obdVMMOArqriNktxwoUmrQF0h5HINt9Q+vIZpa+e08XHTVqkKU09jy4bDeqzPgVBQL7nk2s75I3HNJ/NSNd06na6ZA3shxuecqE+LOwFaYWLOtiHDZxvbWBn+wtubnOsygr5uoCoCP/j31NOpkKT4jT7fWDOjnb1qfztzJI/77bkr7WWvMtiuW5lct3O5LqV/M2PJnLNSuR9+7E73LNSZYctt/8AcCc0/ZkUthIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/42d05ecc4e34468ed7e45e9125a2c432/ba381/tweet-sample.webp 200w,\n/static/42d05ecc4e34468ed7e45e9125a2c432/7f61c/tweet-sample.webp 400w,\n/static/42d05ecc4e34468ed7e45e9125a2c432/ee627/tweet-sample.webp 593w\"\n              sizes=\"(max-width: 593px) 100vw, 593px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/42d05ecc4e34468ed7e45e9125a2c432/772e8/tweet-sample.png 200w,\n/static/42d05ecc4e34468ed7e45e9125a2c432/e17e5/tweet-sample.png 400w,\n/static/42d05ecc4e34468ed7e45e9125a2c432/0b5b1/tweet-sample.png 593w\"\n            sizes=\"(max-width: 593px) 100vw, 593px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/42d05ecc4e34468ed7e45e9125a2c432/0b5b1/tweet-sample.png\"\n            alt=\"つぶやきサンプル\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>開発中に下記サイトで実際にどんな感じになるかを確認できます。</p>\n<ul>\n<li>Twitter → <a href=\"https://cards-dev.twitter.com/validator\">Card validator</a></li>\n<li>Facebook → <a href=\"https://developers.facebook.com/tools/debug/\">シェアデバッガー</a></li>\n</ul>\n<h2 id=\"まとめ\" style=\"position:relative;\"><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\" aria-label=\"まとめ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>まとめ</h2>\n<p>今回はReactアプリでSNSシェアボタンや自分のSNSへのリンクを設置し、さらにOGPタグを設置して\nTwitterなどでのシェアをより効果的にする方法をメモに残しました。\nReactだと、かなり簡単に実現できるし、グっと今時のWebサイトっぽくなるので是非みなさんも試してみてください🍅</p>\n<h2 id=\"参考\" style=\"position:relative;\"><a href=\"#%E5%8F%82%E8%80%83\" aria-label=\"参考 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>参考</h2>\n<ul>\n<li><a href=\"https://github.com/nygardk/react-share\">react-share</a></li>\n<li><a href=\"https://github.com/FortAwesome/react-fontawesome\">react-fontawesome</a></li>\n<li><a href=\"https://github.com/nfl/react-helmet\">ReactHelmet</a></li>\n<li><a href=\"https://ferret-plus.com/610\">Facebook・TwitterのOGP設定方法まとめ｜ferret フェレット</a></li>\n<li><a href=\"https://akameco.github.io/blog/react-helmet/\">React Helmetを使ってOGP対応した | akameco Blog</a></li>\n<li><a href=\"https://design-plus1.com/tcd-w/2018/01/facebook_app_id.html\">FacebookのOGP設定に必要なfb:app IDの取得方法</a></li>\n<li><a href=\"https://cards-dev.twitter.com/validator\">Card validator</a>\n<ul>\n<li>Twitterシェア時にOGP領域プレビュー確認サイト</li>\n</ul>\n</li>\n<li><a href=\"https://developers.facebook.com/tools/debug/\">シェアデバッガー</a>\n<ul>\n<li>Facebookシェア時にOGP領域プレビュー確認サイト</li>\n</ul>\n</li>\n<li><a href=\"https://github.com/ericnorris/striptags\">striptags</a>\n<ul>\n<li>HTML文字列から単純テキストを抽出してくれるライブラリで</li>\n</ul>\n</li>\n<li><a href=\"https://github.com/gatsbyjs/gatsby/issues/3780\">GatsbyはES6未対応 | GitHub issues</a>\n<ul>\n<li>GatsbyはビルドでJSファイル最初化時にUglifyを使っており、uglifyがES6未対応なのでES6のコードをコンパイルしようとするとエラーになってしまいます。</li>\n</ul>\n</li>\n</ul>","excerpt":"なにこれ Gatsby製ブログ(Reactアプリ)でSNS対応した時のメモです。\n(1) SNSシェアボタンと**(2) 自分のSNSへのリンクを設置して、ブログの記事をSNSでシェアできるように、、、\nまた、(3) OGPタグを設定し**、SNS…","frontmatter":{"slug":"/2018/09/16/","title":"ReactでSNS対応（Gatsby製ブログでSNSシェアボタン、OGPタグ追加）","date":"2018-09-16T22:00:00.000Z","tags":["Gatsby","React","OGP","SNS","SRE"],"keywords":["React"],"thumbnail":"thumbnail/2018/react-sns.png","category":null}}],"latestPosts":[{"html":"<h2 id=\"なにこれ\" style=\"position:relative;\"><a href=\"#%E3%81%AA%E3%81%AB%E3%81%93%E3%82%8C\" aria-label=\"なにこれ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>なにこれ</h2>\n<p>Windowsでキーバインドをお気軽にいじれる<a href=\"https://www.autohotkey.com/\">AutoHotkey</a>の紹介です。３ヶ月使ってみて色々な設定を試した結果、その中でも特に便利だと感じたマウススクロールと修飾キーの組合せについてご紹介します。</p>\n<h2 id=\"autohotkeyとは\" style=\"position:relative;\"><a href=\"#autohotkey%E3%81%A8%E3%81%AF\" aria-label=\"autohotkeyとは permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>AutoHotkeyとは</h2>\n<p>Windows版で提供されているソフトウェアで、専用のプログラミング言語でキーバインドを定義すれば、任意のキー入力に対してスクリプトを実行できます。既存のキーに別のキーの割当てたり、複雑なショートカットコマンドの割当が可能です。</p>\n<h3 id=\"良い部分\" style=\"position:relative;\"><a href=\"#%E8%89%AF%E3%81%84%E9%83%A8%E5%88%86\" aria-label=\"良い部分 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>良い部分</h3>\n<p><strong>サクッと導入して合わなかったらサクッと廃止できます。</strong><br>\n同じようなものでWindowsの<a href=\"https://forest.watch.impress.co.jp/library/software/changekey/\">Change Key</a>やMacの<a href=\"https://karabiner-elements.pqrs.org/\">Karabiner Elements</a>がありますが、AutoHotkeyはアプリレイヤーで制御するので、アプリを終了すれば通常操作に戻れて、レジストリをいじったりしなくて良いという手軽さが魅力です。</p>\n<h3 id=\"イマイチな部分\" style=\"position:relative;\"><a href=\"#%E3%82%A4%E3%83%9E%E3%82%A4%E3%83%81%E3%81%AA%E9%83%A8%E5%88%86\" aria-label=\"イマイチな部分 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>イマイチな部分</h3>\n<p><strong>独自言語で設定します。</strong><br>\n言語仕様はAutoHotkey公式リファレンスを見て学習が必要です。\n少し独特な言語で処理をどこでreturnするか分かりづらい気がします。</p>\n<p><strong>リモート接続PCでは効きません。</strong><br>\nリモート接続先のPCの操作に対してはAutHotkeyの設定は有効になりません。テレワークでリモートPC操作がメインの方だとイマイチかもしれません。これはChange KeyもKarabiner Elementsも同じですが...</p>\n<h2 id=\"実例紹介全体像\" style=\"position:relative;\"><a href=\"#%E5%AE%9F%E4%BE%8B%E7%B4%B9%E4%BB%8B%E5%85%A8%E4%BD%93%E5%83%8F\" aria-label=\"実例紹介全体像 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>実例紹介：全体像</h2>\n<p>Windowsだと<code class=\"language-text\">Ctrl</code>+スクロールは拡大/縮小、<code class=\"language-text\">Shift</code>+スクロールは横スクロールになっています。\nこのノリを<code class=\"language-text\">Win</code>,<code class=\"language-text\">Alt</code>,<code class=\"language-text\">Tab</code>にも拡張する感じでAutoHotkeyで設定します。<br>\n右手でマウススクロールしながら、左手で<code class=\"language-text\">Win</code>,<code class=\"language-text\">Alt</code>,<code class=\"language-text\">Tab</code>を押下することで、目的のデスクトップ・アプリ・タブに素早く直感的に移動できます。</p>\n<p><img src=\"./overview.png\" alt=\"overview\"></p>\n<h2 id=\"実例紹介ソースコード\" style=\"position:relative;\"><a href=\"#%E5%AE%9F%E4%BE%8B%E7%B4%B9%E4%BB%8B%E3%82%BD%E3%83%BC%E3%82%B9%E3%82%B3%E3%83%BC%E3%83%89\" aria-label=\"実例紹介ソースコード permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>実例紹介：ソースコード</h2>\n<p>まずはソースコード全量を示します。</p>\n<div class=\"gatsby-code-title\">AutoHotkey設定ファイルの実例</div>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token punctuation\">;</span> 仮想デスクトップ間移動\n~LWin <span class=\"token operator\">&amp;</span> WheelUp::send,^<span class=\"token comment\">#{Left}</span>\n~LWin <span class=\"token operator\">&amp;</span> WheelDown::send,^<span class=\"token comment\">#{Right}</span>\n\n<span class=\"token punctuation\">;</span> アプリ間移動\n~LAlt <span class=\"token operator\">&amp;</span> WheelDown::AltTab \n~LAlt <span class=\"token operator\">&amp;</span> WheelUp::ShiftAltTab\n\n<span class=\"token punctuation\">;</span> Tabの修飾キー化\n<span class=\"token variable\">$Tab</span>::\n  startTime :<span class=\"token operator\">=</span> A_TickCount\n  KeyWait, Tab\n  keyPressDuration :<span class=\"token operator\">=</span> A_TickCount - startTime\n  If <span class=\"token punctuation\">(</span>A_ThisHotkey <span class=\"token operator\">==</span> <span class=\"token string\">\"<span class=\"token variable\">$Tab</span>\"</span> and keyPressDuration <span class=\"token operator\">&lt;</span> <span class=\"token number\">200</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    Send, <span class=\"token punctuation\">{</span>Blind<span class=\"token punctuation\">}</span><span class=\"token punctuation\">{</span>Tab<span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\nReturn\n\n<span class=\"token punctuation\">;</span> タブ間移動：VSCode\n<span class=\"token comment\">#IfWinActive ahk_exe Code.exe</span>\n  ~Tab <span class=\"token operator\">&amp;</span> WheelUp::send,^<span class=\"token punctuation\">{</span>PgUp<span class=\"token punctuation\">}</span>\n  ~Tab <span class=\"token operator\">&amp;</span> WheelDown::send,^<span class=\"token punctuation\">{</span>PgDn<span class=\"token punctuation\">}</span>\nReturn\n<span class=\"token comment\">#IfWinActiveW</span>\n\n<span class=\"token punctuation\">;</span> タブ間移動：Chrome\n<span class=\"token comment\">#IfWinActive ahk_exe chrome.exe</span>\n  ~Tab <span class=\"token operator\">&amp;</span> WheelUp::send,^+<span class=\"token punctuation\">{</span>tab<span class=\"token punctuation\">}</span>\n  ~Tab <span class=\"token operator\">&amp;</span> WheelDown::send,^<span class=\"token punctuation\">{</span>tab<span class=\"token punctuation\">}</span>\nReturn\n<span class=\"token comment\">#IfWinActiveW</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<br/>\n<p>以下で処理の塊ごとに説明します。</p>\n<h3 id=\"仮想デスクトップ間移動\" style=\"position:relative;\"><a href=\"#%E4%BB%AE%E6%83%B3%E3%83%87%E3%82%B9%E3%82%AF%E3%83%88%E3%83%83%E3%83%97%E9%96%93%E7%A7%BB%E5%8B%95\" aria-label=\"仮想デスクトップ間移動 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>仮想デスクトップ間移動</h3>\n<p><code class=\"language-text\">Win</code> + スクロール実行時に、<code class=\"language-text\">Win</code> + 左右矢印を発動するように設定します。\n<code class=\"language-text\">Left</code>,<code class=\"language-text\">Right</code>の向きは好みによって変えてください。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">~LWin <span class=\"token operator\">&amp;</span> WheelUp::send,^<span class=\"token comment\">#{Left}</span>\n~LWin <span class=\"token operator\">&amp;</span> WheelDown::send,^<span class=\"token comment\">#{Right}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<h3 id=\"アプリ間移動\" style=\"position:relative;\"><a href=\"#%E3%82%A2%E3%83%97%E3%83%AA%E9%96%93%E7%A7%BB%E5%8B%95\" aria-label=\"アプリ間移動 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>アプリ間移動</h3>\n<p>同じように<code class=\"language-text\">Alt</code>+ スクロール実行時に、<code class=\"language-text\">Alt</code>+<code class=\"language-text\">Tab</code>を発動するように設定します。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">~LAlt <span class=\"token operator\">&amp;</span> WheelDown::AltTab \n~LAlt <span class=\"token operator\">&amp;</span> WheelUp::ShiftAltTab</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<br/>\n<p>※ちなみに<code class=\"language-text\">Alt</code>+<code class=\"language-text\">Tab</code>のアプローチは複数選択肢がありますが、<code class=\"language-text\">Alt</code>を押し続ける必要があり、１つのキーで代替するのは難しく皆さん実現に苦労されているようです。</p>\n<h3 id=\"タブ移動\" style=\"position:relative;\"><a href=\"#%E3%82%BF%E3%83%96%E7%A7%BB%E5%8B%95\" aria-label=\"タブ移動 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>タブ移動</h3>\n<p>Tabは修飾キー化が必要です。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token variable\">$Tab</span>::\n  startTime :<span class=\"token operator\">=</span> A_TickCount\n  <span class=\"token punctuation\">;</span> 押し続けている限りリピートせず待機\n  KeyWait, Tab\n  keyPressDuration :<span class=\"token operator\">=</span> A_TickCount - startTime\n  <span class=\"token punctuation\">;</span> 押下中に他のホットキーが発動した場合は入力無し い\n  <span class=\"token punctuation\">;</span> 長押しの場合も入力無し\n  If <span class=\"token punctuation\">(</span>A_ThisHotkey <span class=\"token operator\">==</span> <span class=\"token string\">\"<span class=\"token variable\">$Tab</span>\"</span> and keyPressDuration <span class=\"token operator\">&lt;</span> <span class=\"token number\">200</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    Send, <span class=\"token punctuation\">{</span>Blind<span class=\"token punctuation\">}</span><span class=\"token punctuation\">{</span>Tab<span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\nReturn</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<br/>\n<p>さらにアプリ毎にショートカットキーが異なるのでアプリ別に設定します。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token punctuation\">;</span>マウスホイールでタブ移動（VScode）\n<span class=\"token comment\">#IfWinActive ahk_exe Code.exe</span>\n  ~Tab <span class=\"token operator\">&amp;</span> WheelUp::send,^<span class=\"token punctuation\">{</span>PgUp<span class=\"token punctuation\">}</span>\n  ~Tab <span class=\"token operator\">&amp;</span> WheelDown::send,^<span class=\"token punctuation\">{</span>PgDn<span class=\"token punctuation\">}</span>\nReturn\n<span class=\"token comment\">#IfWinActiveW</span>\n\n<span class=\"token punctuation\">;</span>マウスホイールでタブ移動（クローム）\n<span class=\"token comment\">#IfWinActive ahk_exe chrome.exe</span>\n  ~Tab <span class=\"token operator\">&amp;</span> WheelUp::send,^+<span class=\"token punctuation\">{</span>tab<span class=\"token punctuation\">}</span>\n  ~Tab <span class=\"token operator\">&amp;</span> WheelDown::send,^<span class=\"token punctuation\">{</span>tab<span class=\"token punctuation\">}</span>\nReturn\n<span class=\"token comment\">#IfWinActiveW</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id=\"まとめ\" style=\"position:relative;\"><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\" aria-label=\"まとめ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>まとめ</h2>\n<p>今回紹介したのはスクロールとの組み合わせでしたが、AutoHotkeyは他にもさまざまな設定ができるので便利です。是非使ってみてください🍅</p>","excerpt":"なにこれ Windowsでキーバインドをお気軽にいじれるAutoHotkeyの紹介です。３ヶ月使ってみて色々な設定を試した結果、その中でも特に便利だと感じたマウススクロールと修飾キーの組合せについてご紹介します。 AutoHotkeyとは Windows…","frontmatter":{"slug":"/mahjong-solitaire","title":"上海 (Mahjong Solitaire)","date":"2023-04-07T09:00:00.000+09:00","tags":["キーボード","AutoHotkey","作業効率化"],"keywords":["キーボード"],"thumbnail":"thumbnail/shanghai.png","category":"game"}},{"html":"<p>プログラミングの参考や勉強になるWebサイトを集めた。</p>\n<h2 id=\"github\" style=\"position:relative;\"><a href=\"#github\" aria-label=\"github permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>github</h2>","excerpt":"プログラミングの参考や勉強になるWebサイトを集めた。 github","frontmatter":{"slug":"/bookmarks","title":"リンク集","date":"2023-04-07T09:00:00.000+09:00","tags":["リンク集"],"keywords":["links"],"thumbnail":"thumbnail/2023/04/autohotkey-mouse-scroll-combination.png","category":"note"}},{"html":"<h2 id=\"小説\" style=\"position:relative;\"><a href=\"#%E5%B0%8F%E8%AA%AC\" aria-label=\"小説 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>小説</h2>\n<p>村田沙耶香 『コンビニ人間』\n『地球星人』</p>\n<p>本谷有希子『嵐のピクニック』</p>\n<p>小山田寛子の『工場』</p>\n<p>多和田葉子の『献灯使』</p>\n<p>大江健三郎の『個人的な体験</p>\n<p>桐野夏生   『リアルワールド』\n『グロテスク』</p>\n<p>高野 文子   わたしたちが描いたアニメーション「平家物語」</p>\n<p>吉本ばなな  『キッチン』  『トカゲ』</p>\n<p>湊かなえ『告白』</p>\n<p>乙一は『GOTH』、『ZOO』、『夏と花火と私の死体』</p>\n<p>川口俊和の『コーヒーが冷めないうちに』</p>\n<p>中村文則『銃』と『掏摸』</p>\n<p>遠藤周作の『沈黙』</p>","excerpt":"…","frontmatter":{"slug":"/いつか読む本","title":"いつか読む本","date":"2023-04-07T09:00:00.000+09:00","tags":["リンク集"],"keywords":["links"],"thumbnail":"thumbnail/2023/04/autohotkey-mouse-scroll-combination.png","category":"note"}},{"html":"<h2 id=\"なにこれ\" style=\"position:relative;\"><a href=\"#%E3%81%AA%E3%81%AB%E3%81%93%E3%82%8C\" aria-label=\"なにこれ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>なにこれ</h2>\n<p>Windowsでキーバインドをお気軽にいじれる<a href=\"https://www.autohotkey.com/\">AutoHotkey</a>の紹介です。３ヶ月使ってみて色々な設定を試した結果、その中でも特に便利だと感じたマウススクロールと修飾キーの組合せについてご紹介します。</p>\n<h2 id=\"autohotkeyとは\" style=\"position:relative;\"><a href=\"#autohotkey%E3%81%A8%E3%81%AF\" aria-label=\"autohotkeyとは permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>AutoHotkeyとは</h2>\n<p>Windows版で提供されているソフトウェアで、専用のプログラミング言語でキーバインドを定義すれば、任意のキー入力に対してスクリプトを実行できます。既存のキーに別のキーの割当てたり、複雑なショートカットコマンドの割当が可能です。</p>\n<h3 id=\"良い部分\" style=\"position:relative;\"><a href=\"#%E8%89%AF%E3%81%84%E9%83%A8%E5%88%86\" aria-label=\"良い部分 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>良い部分</h3>\n<p><strong>サクッと導入して合わなかったらサクッと廃止できます。</strong><br>\n同じようなものでWindowsの<a href=\"https://forest.watch.impress.co.jp/library/software/changekey/\">Change Key</a>やMacの<a href=\"https://karabiner-elements.pqrs.org/\">Karabiner Elements</a>がありますが、AutoHotkeyはアプリレイヤーで制御するので、アプリを終了すれば通常操作に戻れて、レジストリをいじったりしなくて良いという手軽さが魅力です。</p>\n<h3 id=\"イマイチな部分\" style=\"position:relative;\"><a href=\"#%E3%82%A4%E3%83%9E%E3%82%A4%E3%83%81%E3%81%AA%E9%83%A8%E5%88%86\" aria-label=\"イマイチな部分 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>イマイチな部分</h3>\n<p><strong>独自言語で設定します。</strong><br>\n言語仕様はAutoHotkey公式リファレンスを見て学習が必要です。\n少し独特な言語で処理をどこでreturnするか分かりづらい気がします。</p>\n<p><strong>リモート接続PCでは効きません。</strong><br>\nリモート接続先のPCの操作に対してはAutHotkeyの設定は有効になりません。テレワークでリモートPC操作がメインの方だとイマイチかもしれません。これはChange KeyもKarabiner Elementsも同じですが...</p>\n<h2 id=\"実例紹介全体像\" style=\"position:relative;\"><a href=\"#%E5%AE%9F%E4%BE%8B%E7%B4%B9%E4%BB%8B%E5%85%A8%E4%BD%93%E5%83%8F\" aria-label=\"実例紹介全体像 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>実例紹介：全体像</h2>\n<p>Windowsだと<code class=\"language-text\">Ctrl</code>+スクロールは拡大/縮小、<code class=\"language-text\">Shift</code>+スクロールは横スクロールになっています。\nこのノリを<code class=\"language-text\">Win</code>,<code class=\"language-text\">Alt</code>,<code class=\"language-text\">Tab</code>にも拡張する感じでAutoHotkeyで設定します。<br>\n右手でマウススクロールしながら、左手で<code class=\"language-text\">Win</code>,<code class=\"language-text\">Alt</code>,<code class=\"language-text\">Tab</code>を押下することで、目的のデスクトップ・アプリ・タブに素早く直感的に移動できます。</p>\n<h2 id=\"tilesheet-b-0---255\" style=\"position:relative;\"><a href=\"#tilesheet-b-0---255\" aria-label=\"tilesheet b 0   255 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Tilesheet B: 0 - 255</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/2edad07529a0c14a7ef89ec91015aaea/212bf/tilesheet-b-numbering-sheet.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAABwaoAAB//xAAUEAEAAAAAAAAAAAAAAAAAAAAw/9oACAEBAAEFAh//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/AR//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAUEAEAAAAAAAAAAAAAAAAAAAAw/9oACAEBAAY/Ah//xAAUEAEAAAAAAAAAAAAAAAAAAAAw/9oACAEBAAE/IR//2gAMAwEAAgADAAAAEMDAPP/EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8QH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8QH//EABoQAAEFAQAAAAAAAAAAAAAAAAABEBEhMUH/2gAIAQEAAT8QhBMaxM6W8H//2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/2edad07529a0c14a7ef89ec91015aaea/ba381/tilesheet-b-numbering-sheet.webp 200w,\n/static/2edad07529a0c14a7ef89ec91015aaea/7f61c/tilesheet-b-numbering-sheet.webp 400w,\n/static/2edad07529a0c14a7ef89ec91015aaea/8b983/tilesheet-b-numbering-sheet.webp 768w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/2edad07529a0c14a7ef89ec91015aaea/e07e9/tilesheet-b-numbering-sheet.jpg 200w,\n/static/2edad07529a0c14a7ef89ec91015aaea/066f9/tilesheet-b-numbering-sheet.jpg 400w,\n/static/2edad07529a0c14a7ef89ec91015aaea/212bf/tilesheet-b-numbering-sheet.jpg 768w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/2edad07529a0c14a7ef89ec91015aaea/212bf/tilesheet-b-numbering-sheet.jpg\"\n            alt=\"overview\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h2 id=\"tilesheet-c-256---511\" style=\"position:relative;\"><a href=\"#tilesheet-c-256---511\" aria-label=\"tilesheet c 256   511 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Tilesheet C: 256 - 511</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d12582187b534f5b767f3fa81481401f/212bf/tilesheet-c-numbering-sheet.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAGGAAAD/8QAFBABAAAAAAAAAAAAAAAAAAAAMP/aAAgBAQABBQIf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPwEf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPwEf/8QAFBABAAAAAAAAAAAAAAAAAAAAMP/aAAgBAQAGPwIf/8QAFBABAAAAAAAAAAAAAAAAAAAAMP/aAAgBAQABPyEf/9oADAMBAAIAAwAAABAgAAD/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/EB//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/EB//xAAZEAADAAMAAAAAAAAAAAAAAAAAEJERMfD/2gAIAQEAAT8QdKVYO0f/2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/d12582187b534f5b767f3fa81481401f/ba381/tilesheet-c-numbering-sheet.webp 200w,\n/static/d12582187b534f5b767f3fa81481401f/7f61c/tilesheet-c-numbering-sheet.webp 400w,\n/static/d12582187b534f5b767f3fa81481401f/8b983/tilesheet-c-numbering-sheet.webp 768w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/d12582187b534f5b767f3fa81481401f/e07e9/tilesheet-c-numbering-sheet.jpg 200w,\n/static/d12582187b534f5b767f3fa81481401f/066f9/tilesheet-c-numbering-sheet.jpg 400w,\n/static/d12582187b534f5b767f3fa81481401f/212bf/tilesheet-c-numbering-sheet.jpg 768w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/d12582187b534f5b767f3fa81481401f/212bf/tilesheet-c-numbering-sheet.jpg\"\n            alt=\"overview\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h2 id=\"tilesheet-d-512---767\" style=\"position:relative;\"><a href=\"#tilesheet-d-512---767\" aria-label=\"tilesheet d 512   767 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Tilesheet D: 512 - 767</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a236da186ca7b390d42a77547ff512aa/212bf/tilesheet-d-numbering-sheet.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAGGAAAD/8QAFBABAAAAAAAAAAAAAAAAAAAAMP/aAAgBAQABBQIf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPwEf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPwEf/8QAFBABAAAAAAAAAAAAAAAAAAAAMP/aAAgBAQAGPwIf/8QAFBABAAAAAAAAAAAAAAAAAAAAMP/aAAgBAQABPyEf/9oADAMBAAIAAwAAABDjCAD/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/EB//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/EB//xAAYEAADAQEAAAAAAAAAAAAAAAAQESEA8P/aAAgBAQABPxA0rllR/9k='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/a236da186ca7b390d42a77547ff512aa/ba381/tilesheet-d-numbering-sheet.webp 200w,\n/static/a236da186ca7b390d42a77547ff512aa/7f61c/tilesheet-d-numbering-sheet.webp 400w,\n/static/a236da186ca7b390d42a77547ff512aa/8b983/tilesheet-d-numbering-sheet.webp 768w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/a236da186ca7b390d42a77547ff512aa/e07e9/tilesheet-d-numbering-sheet.jpg 200w,\n/static/a236da186ca7b390d42a77547ff512aa/066f9/tilesheet-d-numbering-sheet.jpg 400w,\n/static/a236da186ca7b390d42a77547ff512aa/212bf/tilesheet-d-numbering-sheet.jpg 768w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/a236da186ca7b390d42a77547ff512aa/212bf/tilesheet-d-numbering-sheet.jpg\"\n            alt=\"overview\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h2 id=\"tilesheet-e-768---1023\" style=\"position:relative;\"><a href=\"#tilesheet-e-768---1023\" aria-label=\"tilesheet e 768   1023 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Tilesheet E: 768 - 1023</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/146bbedfb0b61dd5edc0b0540f20e1fb/212bf/tilesheet-e-numbering-sheet.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAABwwAKFB//xAAUEAEAAAAAAAAAAAAAAAAAAAAw/9oACAEBAAEFAh//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/AR//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAUEAEAAAAAAAAAAAAAAAAAAAAw/9oACAEBAAY/Ah//xAAUEAEAAAAAAAAAAAAAAAAAAAAw/9oACAEBAAE/IR//2gAMAwEAAgADAAAAEDPIAP/EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8QH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8QH//EABsQAAICAwEAAAAAAAAAAAAAAAARASEgYeHw/9oACAEBAAE/EMb2IiK4LyP/2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/146bbedfb0b61dd5edc0b0540f20e1fb/ba381/tilesheet-e-numbering-sheet.webp 200w,\n/static/146bbedfb0b61dd5edc0b0540f20e1fb/7f61c/tilesheet-e-numbering-sheet.webp 400w,\n/static/146bbedfb0b61dd5edc0b0540f20e1fb/8b983/tilesheet-e-numbering-sheet.webp 768w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/146bbedfb0b61dd5edc0b0540f20e1fb/e07e9/tilesheet-e-numbering-sheet.jpg 200w,\n/static/146bbedfb0b61dd5edc0b0540f20e1fb/066f9/tilesheet-e-numbering-sheet.jpg 400w,\n/static/146bbedfb0b61dd5edc0b0540f20e1fb/212bf/tilesheet-e-numbering-sheet.jpg 768w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/146bbedfb0b61dd5edc0b0540f20e1fb/212bf/tilesheet-e-numbering-sheet.jpg\"\n            alt=\"overview\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h2 id=\"tilesheet-a5-1536---1663\" style=\"position:relative;\"><a href=\"#tilesheet-a5-1536---1663\" aria-label=\"tilesheet a5 1536   1663 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Tilesheet A5: 1536 - 1663</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 384px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e93480e29f1789695e5e23dddb088e2f/4ecad/tilesheet-a5-numbering-sheet.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 200%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAoABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAeMUAXNKggAP/8QAGBAAAwEBAAAAAAAAAAAAAAAAABARISD/2gAIAQEAAQUCdKVab3//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/AV//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AV//xAAYEAADAQEAAAAAAAAAAAAAAAAAMaHxIP/aAAgBAQAGPwLDDB0dHTTTRQUFOP/EACEQAAECBQUBAAAAAAAAAAAAAAEAMREhQXGRUWHR8PGx/9oACAEBAAE/ISZFs6ESJtWqEjbKF3SVkXXdSXTwjGBfwi56/CNyESM2WiIeatXKhuy5ULYGiIdq0ChbAX//2gAMAwEAAgADAAAAEOAKDHPP/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPxBf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPxBf/8QAIRAAAQIHAQADAAAAAAAAAAAAAQCRESExQVFh8HGx0eH/2gAIAQEAAT8QB4Sw13qjNrga504lw6QITaG7DnFBjNPpkIRN9TfkoVZQb4e/EcXzMucEUXo3yKLoCw2jiim4CE47i4UIwMqCy33qDGT7Mb50RxUXTtf/2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/e93480e29f1789695e5e23dddb088e2f/ba381/tilesheet-a5-numbering-sheet.webp 200w,\n/static/e93480e29f1789695e5e23dddb088e2f/e6f2f/tilesheet-a5-numbering-sheet.webp 384w\"\n              sizes=\"(max-width: 384px) 100vw, 384px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/e93480e29f1789695e5e23dddb088e2f/e07e9/tilesheet-a5-numbering-sheet.jpg 200w,\n/static/e93480e29f1789695e5e23dddb088e2f/4ecad/tilesheet-a5-numbering-sheet.jpg 384w\"\n            sizes=\"(max-width: 384px) 100vw, 384px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/e93480e29f1789695e5e23dddb088e2f/4ecad/tilesheet-a5-numbering-sheet.jpg\"\n            alt=\"overview\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h2 id=\"tilesheet-a1-2048---2815\" style=\"position:relative;\"><a href=\"#tilesheet-a1-2048---2815\" aria-label=\"tilesheet a1 2048   2815 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Tilesheet A1: 2048 - 2815</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/4ce07a6c33c0feb6fb6c2a451d41e562/212bf/tilesheet-a1-numbering-sheet.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAECAwX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHHcWWCD//EABgQAAMBAQAAAAAAAAAAAAAAAAAxQQEC/9oACAEBAAEFAjXDpz//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAaEAADAAMBAAAAAAAAAAAAAAAAASExQXGh/9oACAEBAAY/AsbHBT0XRxCiP//EAB0QAAIBBAMAAAAAAAAAAAAAAAABQREhMbFRcYH/2gAIAQEAAT8hSxsuL4OdFIOJCpBDDgEupk//2gAMAwEAAgADAAAAEBDP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAHxABAAICAgIDAAAAAAAAAAAAAREhADFBgWFxkbHR/9oACAEBAAE/ELLvL7K1kIcdeHwtwMi8m0l95V+j2xrADAQyGuqrJVIE2L7rP//Z'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/4ce07a6c33c0feb6fb6c2a451d41e562/ba381/tilesheet-a1-numbering-sheet.webp 200w,\n/static/4ce07a6c33c0feb6fb6c2a451d41e562/7f61c/tilesheet-a1-numbering-sheet.webp 400w,\n/static/4ce07a6c33c0feb6fb6c2a451d41e562/8b983/tilesheet-a1-numbering-sheet.webp 768w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/4ce07a6c33c0feb6fb6c2a451d41e562/e07e9/tilesheet-a1-numbering-sheet.jpg 200w,\n/static/4ce07a6c33c0feb6fb6c2a451d41e562/066f9/tilesheet-a1-numbering-sheet.jpg 400w,\n/static/4ce07a6c33c0feb6fb6c2a451d41e562/212bf/tilesheet-a1-numbering-sheet.jpg 768w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/4ce07a6c33c0feb6fb6c2a451d41e562/212bf/tilesheet-a1-numbering-sheet.jpg\"\n            alt=\"overview\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h2 id=\"tilesheet-a2-2816---4351\" style=\"position:relative;\"><a href=\"#tilesheet-a2-2816---4351\" aria-label=\"tilesheet a2 2816   4351 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Tilesheet A2: 2816 - 4351</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d5be0543f94368630a45f1272a379b78/212bf/tilesheet-a2-numbering-sheet.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAIF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAABzQQD/8QAFxAAAwEAAAAAAAAAAAAAAAAAAAEREP/aAAgBAQABBQKEHrP/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAXEAEBAQEAAAAAAAAAAAAAAAAAMUEB/9oACAEBAAY/ApxOIxjH/8QAHhAAAQMEAwAAAAAAAAAAAAAAAAEhMRFBkfBRYYH/2gAIAQEAAT8h1KalEQyOTzEp1iWtA//aAAwDAQACAAMAAAAQww//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAhEAEAAQIGAwEAAAAAAAAAAAABIQARMWFxgaHwUZHB4f/aAAgBAQABPxCyIO8t6AJFhp47ejGHDBPykD3Ru8b0ASO1uWmfNAGHkPyv/9k='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/d5be0543f94368630a45f1272a379b78/ba381/tilesheet-a2-numbering-sheet.webp 200w,\n/static/d5be0543f94368630a45f1272a379b78/7f61c/tilesheet-a2-numbering-sheet.webp 400w,\n/static/d5be0543f94368630a45f1272a379b78/8b983/tilesheet-a2-numbering-sheet.webp 768w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/d5be0543f94368630a45f1272a379b78/e07e9/tilesheet-a2-numbering-sheet.jpg 200w,\n/static/d5be0543f94368630a45f1272a379b78/066f9/tilesheet-a2-numbering-sheet.jpg 400w,\n/static/d5be0543f94368630a45f1272a379b78/212bf/tilesheet-a2-numbering-sheet.jpg 768w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/d5be0543f94368630a45f1272a379b78/212bf/tilesheet-a2-numbering-sheet.jpg\"\n            alt=\"overview\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h2 id=\"tilesheet-a3-4352---5887\" style=\"position:relative;\"><a href=\"#tilesheet-a3-4352---5887\" aria-label=\"tilesheet a3 4352   5887 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Tilesheet A3: 4352 - 5887</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/1daf3f5b062647c815f0e9327c28ee50/212bf/tilesheet-a3-numbering-sheet.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAKABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAIDBP/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAeBYyUP/xAAWEAEBAQAAAAAAAAAAAAAAAAABEAD/2gAIAQEAAQUCjXf/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAZEAACAwEAAAAAAAAAAAAAAAAAARFRYaH/2gAIAQEAAT8hjOIjOITOIhUQqEVH/9oADAMBAAIAAwAAABDAz//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EAB0QAAICAgMBAAAAAAAAAAAAAAERACEx8EFRYZH/2gAIAQEAAT8QR4aewAxTjRwDFMDRwqNPkuFM9ex4Ux1P/9k='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/1daf3f5b062647c815f0e9327c28ee50/ba381/tilesheet-a3-numbering-sheet.webp 200w,\n/static/1daf3f5b062647c815f0e9327c28ee50/7f61c/tilesheet-a3-numbering-sheet.webp 400w,\n/static/1daf3f5b062647c815f0e9327c28ee50/8b983/tilesheet-a3-numbering-sheet.webp 768w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/1daf3f5b062647c815f0e9327c28ee50/e07e9/tilesheet-a3-numbering-sheet.jpg 200w,\n/static/1daf3f5b062647c815f0e9327c28ee50/066f9/tilesheet-a3-numbering-sheet.jpg 400w,\n/static/1daf3f5b062647c815f0e9327c28ee50/212bf/tilesheet-a3-numbering-sheet.jpg 768w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/1daf3f5b062647c815f0e9327c28ee50/212bf/tilesheet-a3-numbering-sheet.jpg\"\n            alt=\"overview\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h2 id=\"tilesheet-a4-5888---8191\" style=\"position:relative;\"><a href=\"#tilesheet-a4-5888---8191\" aria-label=\"tilesheet a4 5888   8191 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Tilesheet A4: 5888 - 8191</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/2c5f8b9624b4456779e7ef8405e238f9/212bf/tilesheet-a4-numbering-sheet.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 94%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAATABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAIDBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAeaoZKG4JB//xAAZEAACAwEAAAAAAAAAAAAAAAAAAQIRISD/2gAIAQEAAQUCwwzikUhxR//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8BH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8BH//EABYQAQEBAAAAAAAAAAAAAAAAAEEAIP/aAAgBAQAGPwIiJmcf/8QAHBAAAgEFAQAAAAAAAAAAAAAAAAExESFRYfBx/9oACAEBAAE/IfZUblxvEr1lesb6zUajAP/aAAwDAQACAAMAAAAQA88A/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPxAf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPxAf/8QAHhAAAQQDAQEBAAAAAAAAAAAAAQARIWExQVHRcZH/2gAIAQEAAT8QAhTh+lA6j20PwXUCiPzu0CiNdfUZxGI09RG8YTZgU5EcL//Z'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/2c5f8b9624b4456779e7ef8405e238f9/ba381/tilesheet-a4-numbering-sheet.webp 200w,\n/static/2c5f8b9624b4456779e7ef8405e238f9/7f61c/tilesheet-a4-numbering-sheet.webp 400w,\n/static/2c5f8b9624b4456779e7ef8405e238f9/8b983/tilesheet-a4-numbering-sheet.webp 768w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/2c5f8b9624b4456779e7ef8405e238f9/e07e9/tilesheet-a4-numbering-sheet.jpg 200w,\n/static/2c5f8b9624b4456779e7ef8405e238f9/066f9/tilesheet-a4-numbering-sheet.jpg 400w,\n/static/2c5f8b9624b4456779e7ef8405e238f9/212bf/tilesheet-a4-numbering-sheet.jpg 768w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/2c5f8b9624b4456779e7ef8405e238f9/212bf/tilesheet-a4-numbering-sheet.jpg\"\n            alt=\"overview\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h2 id=\"floor-type-autotile-shapes\" style=\"position:relative;\"><a href=\"#floor-type-autotile-shapes\" aria-label=\"floor type autotile shapes permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>floor-type-autotile-shapes</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 552px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b8bbb1763f55cda3d7eceb32e4843344/25044/floor-type-autotile-shapes.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 74%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAEEAv/EABUBAQEAAAAAAAAAAAAAAAAAAAEA/9oADAMBAAIQAxAAAAGHYwZSF//EABgQAQEBAQEAAAAAAAAAAAAAAAIAAQMR/9oACAEBAAEFAvbdyOyKkVDm7//EABURAQEAAAAAAAAAAAAAAAAAAAAR/9oACAEDAQE/AYj/xAAWEQEBAQAAAAAAAAAAAAAAAAAAERL/2gAIAQIBAT8BrT//xAAcEAACAgIDAAAAAAAAAAAAAAAAASFBMVECIlL/2gAIAQEABj8Cc7scqx9r9DzdjjdnLOdn/8QAIBAAAQIFBQAAAAAAAAAAAAAAAAEhMUFh0fERUXGRwf/aAAgBAQABPyHTGnt2PWnBT3S2ED0wyKqx0FjEjy2P/9oADAMBAAIAAwAAABCv/wD/xAAVEQEBAAAAAAAAAAAAAAAAAAAAcf/aAAgBAwEBPxAl/8QAFhEBAQEAAAAAAAAAAAAAAAAAABFR/9oACAECAQE/ECNf/8QAIBABAAICAQQDAAAAAAAAAAAAARExACHhQWFxgaHw8f/aAAgBAQABPxCg2bIl6Bzj7z555fObXCTRBjTMiNlqDR+4GFkyhrb6vtnTiJg95//Z'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/b8bbb1763f55cda3d7eceb32e4843344/ba381/floor-type-autotile-shapes.webp 200w,\n/static/b8bbb1763f55cda3d7eceb32e4843344/7f61c/floor-type-autotile-shapes.webp 400w,\n/static/b8bbb1763f55cda3d7eceb32e4843344/dd35b/floor-type-autotile-shapes.webp 552w\"\n              sizes=\"(max-width: 552px) 100vw, 552px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/b8bbb1763f55cda3d7eceb32e4843344/e07e9/floor-type-autotile-shapes.jpg 200w,\n/static/b8bbb1763f55cda3d7eceb32e4843344/066f9/floor-type-autotile-shapes.jpg 400w,\n/static/b8bbb1763f55cda3d7eceb32e4843344/25044/floor-type-autotile-shapes.jpg 552w\"\n            sizes=\"(max-width: 552px) 100vw, 552px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/b8bbb1763f55cda3d7eceb32e4843344/25044/floor-type-autotile-shapes.jpg\"\n            alt=\"overview\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h2 id=\"wall-type-autotile-shapes\" style=\"position:relative;\"><a href=\"#wall-type-autotile-shapes\" aria-label=\"wall type autotile shapes permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>wall-type-autotile-shapes</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 264px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/877f07bce2129311a6806fa3cd5792cd/c285d/wall-type-autotile-shapes.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAMEAQL/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAv/aAAwDAQACEAMQAAAByx5OK3ID1INAP//EAB0QAAEEAgMAAAAAAAAAAAAAAAECAxETEiEiI0P/2gAIAQEAAQUCJculdYU5Bws44CuCe7ynX//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8BH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8BH//EAB8QAAEDBAMBAAAAAAAAAAAAAAEAAhEhIzFRAyIzkf/aAAgBAQAGPwJvUTG1ydRE1Qtt+oXXRuU+4c0G17PTaDC5KDKFAv/EABwQAAICAwEBAAAAAAAAAAAAAAERACExQVFhcf/aAAgBAQABPyG43iG06cNniA8iCqlQvIJ7FrIJTYuy+2NR/Q6gDw+T/9oADAMBAAIAAwAAABB4GIL/xAAZEQEAAgMAAAAAAAAAAAAAAAABABARQVH/2gAIAQMBAT8QWZex3X//xAAZEQEAAgMAAAAAAAAAAAAAAAABABARQVH/2gAIAQIBAT8QCYOQ1X//xAAcEAEAAgIDAQAAAAAAAAAAAAABABEhMUFRYXH/2gAIAQEAAT8QdUjQYD7Fnt5FvFgQVEK08iXnIIVnANRa/wAQBil9YyvUWDx5qdQ8GjK0ZFb2NanSsz//2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/877f07bce2129311a6806fa3cd5792cd/ba381/wall-type-autotile-shapes.webp 200w,\n/static/877f07bce2129311a6806fa3cd5792cd/9a0f6/wall-type-autotile-shapes.webp 264w\"\n              sizes=\"(max-width: 264px) 100vw, 264px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/877f07bce2129311a6806fa3cd5792cd/e07e9/wall-type-autotile-shapes.jpg 200w,\n/static/877f07bce2129311a6806fa3cd5792cd/c285d/wall-type-autotile-shapes.jpg 264w\"\n            sizes=\"(max-width: 264px) 100vw, 264px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/877f07bce2129311a6806fa3cd5792cd/c285d/wall-type-autotile-shapes.jpg\"\n            alt=\"overview\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h2 id=\"waterfall-type-autotile-shapes\" style=\"position:relative;\"><a href=\"#waterfall-type-autotile-shapes\" aria-label=\"waterfall type autotile shapes permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>waterfall-type-autotile-shapes</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 264px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/5fdf8222a1f22fa6debb361df8659fbd/c285d/waterfall-type-autotile-shapes.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 18%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAEABQDASIAAhEBAxEB/8QAFwABAAMAAAAAAAAAAAAAAAAAAAIDBf/EABUBAQEAAAAAAAAAAAAAAAAAAAAC/9oADAMBAAIQAxAAAAHPiJuB/8QAGBABAQADAAAAAAAAAAAAAAAAAhEBIiP/2gAIAQEAAQUCvU51Kh//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAaEAACAgMAAAAAAAAAAAAAAAAAMQECEWKB/9oACAEBAAY/As6l+kJH/8QAGxAAAgIDAQAAAAAAAAAAAAAAAAERMSFRYYH/2gAIAQEAAT8hTyw8dGR7YenFFo//2gAMAwEAAgADAAAAEI//AP/EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABkQAQADAQEAAAAAAAAAAAAAAAEAETEhgf/aAAgBAQABPxB9SxileJiaIedyBZg6WOE//9k='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/5fdf8222a1f22fa6debb361df8659fbd/ba381/waterfall-type-autotile-shapes.webp 200w,\n/static/5fdf8222a1f22fa6debb361df8659fbd/9a0f6/waterfall-type-autotile-shapes.webp 264w\"\n              sizes=\"(max-width: 264px) 100vw, 264px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/5fdf8222a1f22fa6debb361df8659fbd/e07e9/waterfall-type-autotile-shapes.jpg 200w,\n/static/5fdf8222a1f22fa6debb361df8659fbd/c285d/waterfall-type-autotile-shapes.jpg 264w\"\n            sizes=\"(max-width: 264px) 100vw, 264px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/5fdf8222a1f22fa6debb361df8659fbd/c285d/waterfall-type-autotile-shapes.jpg\"\n            alt=\"overview\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h2 id=\"実例紹介ソースコード\" style=\"position:relative;\"><a href=\"#%E5%AE%9F%E4%BE%8B%E7%B4%B9%E4%BB%8B%E3%82%BD%E3%83%BC%E3%82%B9%E3%82%B3%E3%83%BC%E3%83%89\" aria-label=\"実例紹介ソースコード permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>実例紹介：ソースコード</h2>\n<p>まずはソースコード全量を示します。</p>\n<div class=\"gatsby-code-title\">AutoHotkey設定ファイルの実例</div>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token punctuation\">;</span> 仮想デスクトップ間移動\n~LWin <span class=\"token operator\">&amp;</span> WheelUp::send,^<span class=\"token comment\">#{Left}</span>\n~LWin <span class=\"token operator\">&amp;</span> WheelDown::send,^<span class=\"token comment\">#{Right}</span>\n\n<span class=\"token punctuation\">;</span> アプリ間移動\n~LAlt <span class=\"token operator\">&amp;</span> WheelDown::AltTab \n~LAlt <span class=\"token operator\">&amp;</span> WheelUp::ShiftAltTab\n\n<span class=\"token punctuation\">;</span> Tabの修飾キー化\n<span class=\"token variable\">$Tab</span>::\n  startTime :<span class=\"token operator\">=</span> A_TickCount\n  KeyWait, Tab\n  keyPressDuration :<span class=\"token operator\">=</span> A_TickCount - startTime\n  If <span class=\"token punctuation\">(</span>A_ThisHotkey <span class=\"token operator\">==</span> <span class=\"token string\">\"<span class=\"token variable\">$Tab</span>\"</span> and keyPressDuration <span class=\"token operator\">&lt;</span> <span class=\"token number\">200</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    Send, <span class=\"token punctuation\">{</span>Blind<span class=\"token punctuation\">}</span><span class=\"token punctuation\">{</span>Tab<span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\nReturn\n\n<span class=\"token punctuation\">;</span> タブ間移動：VSCode\n<span class=\"token comment\">#IfWinActive ahk_exe Code.exe</span>\n  ~Tab <span class=\"token operator\">&amp;</span> WheelUp::send,^<span class=\"token punctuation\">{</span>PgUp<span class=\"token punctuation\">}</span>\n  ~Tab <span class=\"token operator\">&amp;</span> WheelDown::send,^<span class=\"token punctuation\">{</span>PgDn<span class=\"token punctuation\">}</span>\nReturn\n<span class=\"token comment\">#IfWinActiveW</span>\n\n<span class=\"token punctuation\">;</span> タブ間移動：Chrome\n<span class=\"token comment\">#IfWinActive ahk_exe chrome.exe</span>\n  ~Tab <span class=\"token operator\">&amp;</span> WheelUp::send,^+<span class=\"token punctuation\">{</span>tab<span class=\"token punctuation\">}</span>\n  ~Tab <span class=\"token operator\">&amp;</span> WheelDown::send,^<span class=\"token punctuation\">{</span>tab<span class=\"token punctuation\">}</span>\nReturn\n<span class=\"token comment\">#IfWinActiveW</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<br/>\n<p>以下で処理の塊ごとに説明します。</p>\n<h3 id=\"仮想デスクトップ間移動\" style=\"position:relative;\"><a href=\"#%E4%BB%AE%E6%83%B3%E3%83%87%E3%82%B9%E3%82%AF%E3%83%88%E3%83%83%E3%83%97%E9%96%93%E7%A7%BB%E5%8B%95\" aria-label=\"仮想デスクトップ間移動 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>仮想デスクトップ間移動</h3>\n<p><code class=\"language-text\">Win</code> + スクロール実行時に、<code class=\"language-text\">Win</code> + 左右矢印を発動するように設定します。\n<code class=\"language-text\">Left</code>,<code class=\"language-text\">Right</code>の向きは好みによって変えてください。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">~LWin <span class=\"token operator\">&amp;</span> WheelUp::send,^<span class=\"token comment\">#{Left}</span>\n~LWin <span class=\"token operator\">&amp;</span> WheelDown::send,^<span class=\"token comment\">#{Right}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<h3 id=\"アプリ間移動\" style=\"position:relative;\"><a href=\"#%E3%82%A2%E3%83%97%E3%83%AA%E9%96%93%E7%A7%BB%E5%8B%95\" aria-label=\"アプリ間移動 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>アプリ間移動</h3>\n<p>同じように<code class=\"language-text\">Alt</code>+ スクロール実行時に、<code class=\"language-text\">Alt</code>+<code class=\"language-text\">Tab</code>を発動するように設定します。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">~LAlt <span class=\"token operator\">&amp;</span> WheelDown::AltTab \n~LAlt <span class=\"token operator\">&amp;</span> WheelUp::ShiftAltTab</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<br/>\n<p>※ちなみに<code class=\"language-text\">Alt</code>+<code class=\"language-text\">Tab</code>のアプローチは複数選択肢がありますが、<code class=\"language-text\">Alt</code>を押し続ける必要があり、１つのキーで代替するのは難しく皆さん実現に苦労されているようです。</p>\n<h3 id=\"タブ移動\" style=\"position:relative;\"><a href=\"#%E3%82%BF%E3%83%96%E7%A7%BB%E5%8B%95\" aria-label=\"タブ移動 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>タブ移動</h3>\n<p>Tabは修飾キー化が必要です。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token variable\">$Tab</span>::\n  startTime :<span class=\"token operator\">=</span> A_TickCount\n  <span class=\"token punctuation\">;</span> 押し続けている限りリピートせず待機\n  KeyWait, Tab\n  keyPressDuration :<span class=\"token operator\">=</span> A_TickCount - startTime\n  <span class=\"token punctuation\">;</span> 押下中に他のホットキーが発動した場合は入力無し い\n  <span class=\"token punctuation\">;</span> 長押しの場合も入力無し\n  If <span class=\"token punctuation\">(</span>A_ThisHotkey <span class=\"token operator\">==</span> <span class=\"token string\">\"<span class=\"token variable\">$Tab</span>\"</span> and keyPressDuration <span class=\"token operator\">&lt;</span> <span class=\"token number\">200</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    Send, <span class=\"token punctuation\">{</span>Blind<span class=\"token punctuation\">}</span><span class=\"token punctuation\">{</span>Tab<span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\nReturn</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<br/>\n<p>さらにアプリ毎にショートカットキーが異なるのでアプリ別に設定します。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token punctuation\">;</span>マウスホイールでタブ移動（VScode）\n<span class=\"token comment\">#IfWinActive ahk_exe Code.exe</span>\n  ~Tab <span class=\"token operator\">&amp;</span> WheelUp::send,^<span class=\"token punctuation\">{</span>PgUp<span class=\"token punctuation\">}</span>\n  ~Tab <span class=\"token operator\">&amp;</span> WheelDown::send,^<span class=\"token punctuation\">{</span>PgDn<span class=\"token punctuation\">}</span>\nReturn\n<span class=\"token comment\">#IfWinActiveW</span>\n\n<span class=\"token punctuation\">;</span>マウスホイールでタブ移動（クローム）\n<span class=\"token comment\">#IfWinActive ahk_exe chrome.exe</span>\n  ~Tab <span class=\"token operator\">&amp;</span> WheelUp::send,^+<span class=\"token punctuation\">{</span>tab<span class=\"token punctuation\">}</span>\n  ~Tab <span class=\"token operator\">&amp;</span> WheelDown::send,^<span class=\"token punctuation\">{</span>tab<span class=\"token punctuation\">}</span>\nReturn\n<span class=\"token comment\">#IfWinActiveW</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id=\"まとめ\" style=\"position:relative;\"><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\" aria-label=\"まとめ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>まとめ</h2>\n<p>今回紹介したのはスクロールとの組み合わせでしたが、AutoHotkeyは他にもさまざまな設定ができるので便利です。是非使ってみてください🍅</p>","excerpt":"なにこれ Windowsでキーバインドをお気軽にいじれるAutoHotkeyの紹介です。３ヶ月使ってみて色々な設定を試した結果、その中でも特に便利だと感じたマウススクロールと修飾キーの組合せについてご紹介します。 AutoHotkeyとは Windows…","frontmatter":{"slug":"/rpg-maker","title":"自作RPGゲームエンジン","date":"2023-04-07T09:00:00.000+09:00","tags":["RPG"],"keywords":["RPG"],"thumbnail":"thumbnail/default.png","category":"game"}},{"html":"<h2 id=\"メルセンヌツイスタmersenne-twister-mt法\" style=\"position:relative;\"><a href=\"#%E3%83%A1%E3%83%AB%E3%82%BB%E3%83%B3%E3%83%8C%E3%83%84%E3%82%A4%E3%82%B9%E3%82%BFmersenne-twister-mt%E6%B3%95\" aria-label=\"メルセンヌツイスタmersenne twister mt法 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>メルセンヌ・ツイスタ（Mersenne Twister, MT）法</h2>\n<p>松本眞・西村拓士両氏によって1996年に発表された擬似乱数生成アルゴリズムである。 他の擬似乱数生成アルゴリズムと比べて以下の特徴がある。 （「Mersenne Twister とは?」より）</p>\n<ul>\n<li>\n<p>従来の様々な生成法の欠点を考慮して設計されています。</p>\n</li>\n<li>\n<p>従来にない長周期, 高次元均等分布を持ちます。（周期が<span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>2</mn><mn>19937</mn></msup><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">2^{19937} -1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8974em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">19937</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span></span>で<sup id=\"fnref-1\"><a href=\"#fn-1\" class=\"footnote-ref\">1</a></sup>、623次元超立方体の中に 均等に分布することが証明されています。）</p>\n</li>\n<li>\n<p>生成速度がかなり速い。（処理系にもよりますが、パイプライン処理やキャッシュメモリ のあるシステムでは、Cの標準ライブラリの rand() より高速なこと もあります。なお、開発当時には cokus 版は rand() より4倍程度高速でしたが、その後 ANSI-C の rand() が LCG 法から lagged-fibonacci に 変更されたこともあり、2002年現在 rand と MT の速度差はあまりありません。）</p>\n</li>\n<li>\n<p>メモリ効率が良い。（32ビット以上のマシン用に設計された mt19937.c は、 624ワードのワーキングメモリを消費するだけです。 1ワードは32ビット長とします。</p>\n</li>\n</ul>\n<p>MT法を利用したJavascsriptライブラリを開発した。</p>\n<hr>\n<div class=\"footnotes\">\n<hr>\n<ol>\n<li id=\"fn-1\"><span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>2</mn><mn>19937</mn></msup><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">2^{19937} -1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8974em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">19937</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span></span>はメルセンヌ素数で Mersenne Twister の名前の由来になっている。 Mersenne Twister では周期サイズごとに複数の実装があるが,<span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>2</mn><mn>19937</mn></msup><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">2^{19937} -1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8974em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">19937</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span></span>がポピュラーな実装として広く使われている。<a href=\"#fnref-1\" class=\"footnote-backref\">↩</a></li>\n</ol>\n</div>","excerpt":"メルセンヌ・ツイスタ（Mersenne Twister, MT）法 松本眞・西村拓士両氏によって1996年に発表された擬似乱数生成アルゴリズムである。 他の擬似乱数生成アルゴリズムと比べて以下の特徴がある。 （「Mersenne Twister…","frontmatter":{"slug":"/mersenne-twister","title":"メルセンヌ・ツイスター法による乱数生成Javascriptライブラリ","date":"2023-04-07T09:00:00.000+09:00","tags":["typescript"],"keywords":["乱数"],"thumbnail":"thumbnail/540px-Npm-logo.png","category":"software"}}],"previous":{"html":"<h2 id=\"なにこれ\" style=\"position:relative;\"><a href=\"#%E3%81%AA%E3%81%AB%E3%81%93%E3%82%8C\" aria-label=\"なにこれ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>なにこれ</h2>\n<p><a href=\"https://takumon.com/gatsby-related-posts-like-hugo\">以前の記事</a>で紹介した<strong>タグとキーワードから関連記事を算出するロジック</strong>と、<a href=\"http://js.cytoscape.org/\"><strong>Cytoscape.js</strong></a>を用いて記事の関連情報を視覚的に確認できるマップを作りました。\n今回はそのマップの紹介とCytoscape.jsを使ってみた感想です。</p>\n<h2 id=\"記事関連マップ\" style=\"position:relative;\"><a href=\"#%E8%A8%98%E4%BA%8B%E9%96%A2%E9%80%A3%E3%83%9E%E3%83%83%E3%83%97\" aria-label=\"記事関連マップ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>記事関連マップ</h2>\n<h3 id=\"使い方\" style=\"position:relative;\"><a href=\"#%E4%BD%BF%E3%81%84%E6%96%B9\" aria-label=\"使い方 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>使い方</h3>\n<p>URL: <a href=\"https://takumon.com/map\">https://takumon.com/map</a> <br/>\n遷移方法: 一覧ページのCytoscapleアイコンから遷移できます。 <br/>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 94%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAABcRAAAXEQHKJvM/AAAFGElEQVR42o1Pa0xTBxi9peUpUMFH5sLYpjiVcmmB9vZdiijqFuOC8zk1LGZK5tSg2YbB13RDMonLfsjmjI44jczJ4rAwFVHLvUEUBbtJ0Upb+qJX6AN8TfDengUWfyz7sX3Jl/Od833fSQ5RmJxxcNHEzMtLxXMaVoklpo3JElOpWGLaJJaYtiVKTBXxpGm/iDRVRWWbqqNJU7WINNWIZKZvRTLTcYHMdIrINp0kpA31RE7z8WhJNbE8haQ3TJJjS2oOtzMlD1XJChxIlqMqWY6aBAWOxVGojaLws4DC2RgKTTFKNItUuBilAiNUo12gxk2RmnMmGsAkUwxRIpaYt6fmYseErNFdSVJ+pziHP5CYyx9OkPMnYim+Nl7BnxAp+DNRFF8fQ/EN0XK+SZjLX42V822JKv52qobvnKwZdbyiQ9urilaiVJxF707JQ3W6kTuYqkRVLImaaCmOCUmcjspCHZGFeiILJoLEJYKEOZ7CjSn5uJWixq14GSyJObBOVnCBmfmwZFAMsV1M0pVxMtQVb+bMZV/BvGEf2jZ+gQuG9bi+rgIdJXvQtaoClqWf4u77O9GZ8TbYI2fg2nIA3q1fwle6C+yyjdyT2Wp0k2qGKE+S0ofi83A0rYC7uq4C9LpdaFtZjo4V5bizfAc6526CtWQvelaXw7ZsG/54ayG8H+2Fd3UZBsr2YehgDYY++5wbyaTwgNIwxO4Ekv4uVoHvBVLuOEHipECCs4IsNAiyxyO2ENkwC0m0x0nRGZcN6yQKtqlyuNIU8KTnIaguQFhr5GDMh6dIyRCV8ST9g1COH2XzudO6RWgWF6AlWQ9abMSNKXNxO60Qv79eCOuMeXCQRXBJF8IzJx/+TC3CSgOe6LV4pNVwKDbCv4RiiK+iSbo+WosmjY67UKBG3WQ96jLW4td3StCmWYCe9PnombUA9swi+HKL4FcuQkBRgJBch6dGPZ4vMGBksY7DBwb0v0cxxGGhlG4gKPwSp+AuJqjQJMrDpaR8tKYZYElXwzZVCcdrKjhnaOGbpYV/jgZDSj2eFRkwulgPboke/BoNhw8N8JfkMkQtIaObCRXOEXKuWahA+wQVuiZSuDdFBds0Nexv6uCZqcXTbAqDinw8KTCAm6cDP2a0VA9+pQ58qYpDhRL+8tkMcUKQQ18VanA5Rsm1TVDhdooa1mla9L6hg2uWDg8lOrDqQtS/W4bKNYdwZH0lPIsL0b5kPh6uNQJlFPhPFByqcsHun8EQdcRsukMgw3UByXXGSnE3KQf3UnLgSstDf4YcjyW5cKuNUG82Q7r1Joo+bsap4mL8lD8dv61QIbhHgp5vMjm2cjrcXyczRE/tOXq0pQNB0zVuuNGMxxfMeHrJjOdXWjF6rRU83Yo/GQZOywM0XOyB+cpd+FrO41rtUfSaGxFxtuBZXzOHQRr9d04xxMDAAA0AkUiEw38UH4kgEvm3/vKXZVmG6LM7aHA8ggOD3FAwiNDgIEKBAMLBIAIDA3gUDiMcCGAwEEQoFEYoFMJQOIShUBD9Xi/6nPYxPm7o93sZwmazmVmWhd1uH7XZbHxvby9vtVp5h8MxPns8Hr6/v5+39/by9+/f5/v6+ni32z2u2+123mKx8CzLjv5t6G8lnE4nPTIyguHhYc7n86G7uxtjGA6H8eLFC/yf+kdkS1dXtdfrbXG73ed9Pl+j2+0eb5fLNY5er7dxTH+5G+MvbxwOxzj3eDznWZZtsVgs1X8B0vHYp0ITHXQAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/36e93537aed54f83c2013f263fd14f34/ba381/map-link.webp 200w,\n/static/36e93537aed54f83c2013f263fd14f34/7f61c/map-link.webp 400w,\n/static/36e93537aed54f83c2013f263fd14f34/d00b9/map-link.webp 800w,\n/static/36e93537aed54f83c2013f263fd14f34/92f8c/map-link.webp 1200w,\n/static/36e93537aed54f83c2013f263fd14f34/972ad/map-link.webp 1243w\"\n              sizes=\"(max-width: 800px) 100vw, 800px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/36e93537aed54f83c2013f263fd14f34/772e8/map-link.png 200w,\n/static/36e93537aed54f83c2013f263fd14f34/e17e5/map-link.png 400w,\n/static/36e93537aed54f83c2013f263fd14f34/5a190/map-link.png 800w,\n/static/36e93537aed54f83c2013f263fd14f34/c1b63/map-link.png 1200w,\n/static/36e93537aed54f83c2013f263fd14f34/d93d9/map-link.png 1243w\"\n            sizes=\"(max-width: 800px) 100vw, 800px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/36e93537aed54f83c2013f263fd14f34/5a190/map-link.png\"\n            alt=\"map link\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span>\n<br/></p>\n<p>記事のサムネイル画像が、タグ・キーワードの関連線でつながっています。\n記事はドラッグ＆ドロップでグリグリ動かせます。\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/2995f4a8b9801cc29498d1ff635a4640/0d6fe/map.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 67%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACyUlEQVR42mWSS2+rRhiG+f9ddNdFF91Uqqoue5N6HDWRzqWnJ8fHThzHjrEHxuZiGxhgLmCYGd6KSdIu+mkQIwYenu/iLRaLn8qyPDPGAs45LcuSZllGV4sN3fkBDYKQ3n+5p4v5gjLGqJSS8ralQggqpKSibWld14GUMvN9/wcvDMMbADDG2PHOK4GmadxVZAxCCJzPHMWpG4/RSIn48QGdNqizE5L5LSxgxrMkSa68fRxft0UGMp9qAHaMOEpsGAZ2OX2yUZzZ8PffrFh+GH9oVVVa+vd7y+rapnFsz1vfWqB/Ab7xaBTdoJFgZGcGAMMwII4TFKxAXmQIggjF7DOGausMVdPizAXC+RSbj+8ge42u65xhmqYT7+HhwaWMF+0ROEZMItx/uMOXd0s0lx4DBvTGYvX2GuvZFEkUgW59HMgO6+s3z8AkmXhX33x90ymJVilzXC/R984e1amCLLjbd10H/xCDNy1UGoNlGR4//YXN/R0ubQt+TP4z3K5XzlDWlUnvpv8CXXpKQUqJXms0vXb2YwJjMeWBoi3y5xeHwQHXs9nE2+52r112D0fgYZviojq8v51in5zcNySk8IPwFYCqaVByjkYp9P1zDVe3HyfezXdfOSDLuImCFFVV4XwoYM0wthxaa8fgQkAqhba9QEqFNM+RHFOcGEOSn57HZkx5t/7sgFUhTH4qwXmNpm2g+x5BEEBJieX6CY9PGwd++2kBn1D03QWNkhBjSYx9ncOJR/f0T2fA677tWlPkzMzv5qYsK/PzL7+aLMtMzpg554V5qYyRUpo4ORp6SA0rjmY/+7YDJNJj9odHD/TZsKqtG5lxWfwvtHYSePT3WG0I4jTDehsBQ4+2XLwYnq68zWbz49jxruu2WmsipCDHY0KUUqTrOtL3PeFCkNXGJ4JzkhcVYRUn1hgCa4nWhmiLrTb2uN/vv/8HGunK7Poy11AAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/2995f4a8b9801cc29498d1ff635a4640/ba381/map.webp 200w,\n/static/2995f4a8b9801cc29498d1ff635a4640/7f61c/map.webp 400w,\n/static/2995f4a8b9801cc29498d1ff635a4640/d00b9/map.webp 800w,\n/static/2995f4a8b9801cc29498d1ff635a4640/177a2/map.webp 1115w\"\n              sizes=\"(max-width: 800px) 100vw, 800px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/2995f4a8b9801cc29498d1ff635a4640/772e8/map.png 200w,\n/static/2995f4a8b9801cc29498d1ff635a4640/e17e5/map.png 400w,\n/static/2995f4a8b9801cc29498d1ff635a4640/5a190/map.png 800w,\n/static/2995f4a8b9801cc29498d1ff635a4640/0d6fe/map.png 1115w\"\n            sizes=\"(max-width: 800px) 100vw, 800px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/2995f4a8b9801cc29498d1ff635a4640/5a190/map.png\"\n            alt=\"map\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>関連線はタグよりもキーワードのほうが太くなっています。\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/c1ba0a4d1bff6ff82cfa78e9e4dc8448/077b7/map-relation.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 64%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACiUlEQVR42nVSTW/TQBD1qaKHCtRLq6IiVdyK+AmtCmrFv+HCgROHHvgjICGEBKeinsFCbSpL0Hw0cT68dmyvnTj+2KwTx7U3g2aVFIroSM8rz86+fW9mFV3XP7muW/N9/4IQohmGofm+r1FKtTAM5drr9bRut6u1Wi0tiiKZcxxHGwwGWhAEWhzHF4yxarvd/qJQSmue74Nt28K2bej3+6DrOpyfVyCKIsCYz+c3a1GUEgBzmE6nEIYhbgn8jEajpqKq6uXh4SHs7+0Vzw4OxPP9ffHi6EicnZ2JKIrEovgGcRxL5HkuwRjDfIGEw+HwSjk5Oamtr63Bg9VVcW9lBfbW78PTh1vQIQSu8xwmk4lUjWpd1wVCCFiWBWVZghACZrPZbYWnp6e1R9vbsLW5KTY2NuDxzg482d2FTqcDnHNpC4kMwwBKKXS7XTBNApVKBarV6vICgXvtdrup4EA8z8Mf0ev1oF6vA66oIE1TyPMcHMeRpOPxGCaTFHS9DS9fvQZi2ZByjnVSoed5TSWKoprUjPoXkWUZFEUh7WAawRiDJEmgKK7B7Dvws9aUedt2Ictm8uxgMGgqo9FIEhZFIVAVRhAEEMexVIlAcrS+vBNzOHFsCSrnnP8h/J9CLB4zhk2WoK4LnkfBNE35pNABAtuBLrIsE4sp3yZcvjd8l2+O30K13gDHscEgBhCTQKNxJfv5byzFyCmHYfhrkbwWQqDnklh2+f7j5zJOWDlmvLz8+qNMg0TuIbBuPp/fAM8uWtW40zL2jfMUyqIEWjdgxqdwVyzPDofDlmJZ1rvpdFrhnH/jnKuIJElU0zRVkxDVo1TtU1t1KFVZkqjLmr/BGPuepmnFMIwPvwEiUah8U8wqCgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/c1ba0a4d1bff6ff82cfa78e9e4dc8448/ba381/map-relation.webp 200w,\n/static/c1ba0a4d1bff6ff82cfa78e9e4dc8448/7f61c/map-relation.webp 400w,\n/static/c1ba0a4d1bff6ff82cfa78e9e4dc8448/d00b9/map-relation.webp 800w,\n/static/c1ba0a4d1bff6ff82cfa78e9e4dc8448/308c4/map-relation.webp 1166w\"\n              sizes=\"(max-width: 800px) 100vw, 800px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/c1ba0a4d1bff6ff82cfa78e9e4dc8448/772e8/map-relation.png 200w,\n/static/c1ba0a4d1bff6ff82cfa78e9e4dc8448/e17e5/map-relation.png 400w,\n/static/c1ba0a4d1bff6ff82cfa78e9e4dc8448/5a190/map-relation.png 800w,\n/static/c1ba0a4d1bff6ff82cfa78e9e4dc8448/077b7/map-relation.png 1166w\"\n            sizes=\"(max-width: 800px) 100vw, 800px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/c1ba0a4d1bff6ff82cfa78e9e4dc8448/5a190/map-relation.png\"\n            alt=\"map relation\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>記事にマウスカーソルを合わせると拡大され、関連線が青にハイライトされたり...\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e4b0732aafdfa3d7775f8a48053c922a/99f37/hover-style.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 68%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACrklEQVR42nWT2Y7TMBSG5+14Fy6QuOIVYC54BSS4YDSIRUiDkAAxQ1hC6WS6t9O007RpO6mbzXHabLZ/5KQFJFRLx1bOsT/9/4l9RCm98n3/u+/7uoowDPUoinTGIj0ttvp2G+tBEOqMMT2OY30ymehG09Brtbp+8uxMP3v5SW80G99Go1HHMIx7RwAghBDYjSRJwOIIEWWwhrdY2gRpmsDzPIRBWO7p6B3cThzMPtmYtlYqxdU0HA6P98BCLSpCn4rFbC58NxA/3nfFsDUTQRiIbrcn7NlcCBTi/NWleP/0pzBOe2JYs9W5XHFM03z4V6GsFG7YFk3tGoNLGzftW3hOVKpbLJbwPBeuW2A5z2DfrDCbEHgk+qPQNM1H/1mWEBg016ifz1D/PCht7ytxDLguICXKNgjBq4qUh4FpKuH5EvtMlqXYblMEgQQhVTLPc1iWhTTNDgPlzvJyWWA0SiG4VBvBOdBqBbi8dEHpttxTFBztdhtBEGB3/rBCy8qwXOa7g4Dvq1yOXs+E65I9AI7jgPMDljmvgGperSTyvIJ5HkDp3noGxmJsNhtENAJZEfihi5B5IGtSAq+vryvgzJ6JxWKBycTCdEqRJAUcJwOlHH9+ltyDE3S7HVw1rvDtwxUu3jZg3UxVgyogXTMYXxpCKVAW1JpmGeK4UqNAeS7BGEeSSBQCGLctTIdTPG8f48mHx5DpP9em9bWL+3ce5IP+mNebHd7tm9zsTTghLve8lLuu5ONxxvv9hM/nOQ9CcHvs8I+ndX7y4iV/8/od39As21l+eLQNEwx/jURAGQYjC4R48JYB8jQv1e57q5Tube+uZTVUTci/T49GtOaF7gUhjub7rrZekzJs29ZULo6ZFse0DEqpFoZUY4xpm02ssSTU4qT8vqCUGoZh3P0NHwYR9lvHM1IAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/e4b0732aafdfa3d7775f8a48053c922a/ba381/hover-style.webp 200w,\n/static/e4b0732aafdfa3d7775f8a48053c922a/7f61c/hover-style.webp 400w,\n/static/e4b0732aafdfa3d7775f8a48053c922a/d00b9/hover-style.webp 800w,\n/static/e4b0732aafdfa3d7775f8a48053c922a/abb12/hover-style.webp 1100w\"\n              sizes=\"(max-width: 800px) 100vw, 800px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/e4b0732aafdfa3d7775f8a48053c922a/772e8/hover-style.png 200w,\n/static/e4b0732aafdfa3d7775f8a48053c922a/e17e5/hover-style.png 400w,\n/static/e4b0732aafdfa3d7775f8a48053c922a/5a190/hover-style.png 800w,\n/static/e4b0732aafdfa3d7775f8a48053c922a/99f37/hover-style.png 1100w\"\n            sizes=\"(max-width: 800px) 100vw, 800px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/e4b0732aafdfa3d7775f8a48053c922a/5a190/hover-style.png\"\n            alt=\"hover style\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span>\n<br/></p>\n<p>記事関連マップをフルスクリーン表示できたり...\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/0af55a5e63de5f54c811557f40cd4c13/29007/fullscreen-button.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 47.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABcRAAAXEQHKJvM/AAACBElEQVR42o2Sz05TQRTG+5I+gg/gzo1o4ku40p2JJsYFG4zEhKjUZgRKuTQFWurtbQsUWnrn/58z85k7gAvjwkm+nDlnMr858820jo/7w8Fg0FssFgXnspBSZSmlCiWb/L/U01oPR6PR2xYAeO8iESHFRgExRoQQ4L1HSimrqf09v9uTY2w4FxcX7db1UqCsLqmaXSbWv0rfuvNUc5mM0Ukpnbz3KRClEEKOTQ4g59bau/UQqAHO5/PdVrc4xdb2Tuz87OHpqy4ePe9gPBfwwYLXAtZYCCGwWi1z1FrjxcYGPn/aahiw1kJwmTucTCbt1vvNbTx+8iwKZSA0QdsApAQpFZRSGTA6L3F2XkFKCWMt9vf2mutlIF8LDA7GGVhOynb2sPGg5hpSGkQizGYzTKczcM7hrIVzHj4QptUEi6ur7F2MhLoW9wfrDJxOp/fAiFh0XqJ/8BqeAGdNvuq6rnE6HILXPHejJc9ruZtfJbrFQbZFShmd8RieDB86jN6YNTknqHm8BxnnaLWuiQJRYzxRbMzPMsrRzWJFWmvSRnu+UhgUJ98zMMYYg7WId4/1z6F9wKJew/sAY1yuSa4guPjzbcqy/NEiop501Dn8+I6dtr8yE4idHB2yWVUxipGNJxWrqord3CzZLb9lO7v77MPmFxYjsdtlnevOhU4I4Wh0NnrzGyCp7W/nefxCAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/0af55a5e63de5f54c811557f40cd4c13/ba381/fullscreen-button.webp 200w,\n/static/0af55a5e63de5f54c811557f40cd4c13/7f61c/fullscreen-button.webp 400w,\n/static/0af55a5e63de5f54c811557f40cd4c13/d00b9/fullscreen-button.webp 800w,\n/static/0af55a5e63de5f54c811557f40cd4c13/92f8c/fullscreen-button.webp 1200w,\n/static/0af55a5e63de5f54c811557f40cd4c13/fad48/fullscreen-button.webp 1600w\"\n              sizes=\"(max-width: 800px) 100vw, 800px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/0af55a5e63de5f54c811557f40cd4c13/772e8/fullscreen-button.png 200w,\n/static/0af55a5e63de5f54c811557f40cd4c13/e17e5/fullscreen-button.png 400w,\n/static/0af55a5e63de5f54c811557f40cd4c13/5a190/fullscreen-button.png 800w,\n/static/0af55a5e63de5f54c811557f40cd4c13/c1b63/fullscreen-button.png 1200w,\n/static/0af55a5e63de5f54c811557f40cd4c13/29007/fullscreen-button.png 1600w\"\n            sizes=\"(max-width: 800px) 100vw, 800px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/0af55a5e63de5f54c811557f40cd4c13/5a190/fullscreen-button.png\"\n            alt=\"fullscreen button\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span>\n<br/></p>\n<p>記事クリックで記事ページに遷移できたりします。</p>\n<h3 id=\"過去記事を視覚的に俯瞰できるのでとても良い\" style=\"position:relative;\"><a href=\"#%E9%81%8E%E5%8E%BB%E8%A8%98%E4%BA%8B%E3%82%92%E8%A6%96%E8%A6%9A%E7%9A%84%E3%81%AB%E4%BF%AF%E7%9E%B0%E3%81%A7%E3%81%8D%E3%82%8B%E3%81%AE%E3%81%A7%E3%81%A8%E3%81%A6%E3%82%82%E8%89%AF%E3%81%84\" aria-label=\"過去記事を視覚的に俯瞰できるのでとても良い permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>過去記事を視覚的に俯瞰できるのでとても良い</h3>\n<p>以前から関連記事機能は実装していましたが、記事関連マップにすると俯瞰できるので、改めて気付いたことがありました。\n記事関連マップを見る限り自分のブログのメインコンテンツとしては以下ですね。フロントエンド多めです。</p>\n<ul>\n<li>Gatsby(ちょっとReact)</li>\n<li>Vue.js + AppSync</li>\n<li>Angular</li>\n</ul>\n<p>また、まったく関連が存在しない記事も幾つかあることがわかります（Git,Vimあたり）。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/50b82ce63ff507ac023bad51eaccd84e/78958/no-relation-posts.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 47.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACGklEQVR42o1Rz2sTQRjNvyhIVUQQD/4BHgRRL9KTUpGCCgoVqaA9eKgXqx7USqEkXTVNk0q3SW12UxM32R+zM7M7OzPfk93UBG8+eHwz88083ryvlue5K6VsCiFaUsophWwxxub7U5Z3ppQtLuS0cl6yKaU8HAwGr2oAEEaRlVIiSRjiOAZjDFprSJkhTTk4F+CcQwoBIQTyTEArAZVzWFPAGGOmOmGjhslbxNvXzLB+ncTxS8rygopCkRCS7i4/oRu3F2n50Qr97PuktSZdKNpqefTwdZNW3uzTdjuiJIl1KTiZTOo1yHXknxbscPM8cPIUhClSznFm4RLOXbyCsxcuo/PDxV+sfXiGm4+v4t6L+1j/vFEeVQ6jKGpUXy60sNZksEbNHmlt4PY8HPWHOOj6iOJ01uu4Drac9YoHR19ngkmSTAWzTNk8L6BUgTRNq5yICP8LIpo7DMMQHde13miEQ9dFt9erRJVS8Pw+hsMT+AMfwXhcDaZEEAQYjn7B8zxEYYTxeDx32Gx3sP/gjvGXbtH7jXdkrC2tkVScdo/qtLqxSq3+DoksrYZS9jrdXdr6/pG+9bZpMDkmo40+FazX/CDAaO25PV5aRH1nZ54hFRjnJ/jS3kSQD2DLmE5T6Add7PYaOIz3EKnf/2aYZXIvMaYRGuuINHUYYzOmjDm20FVlyfw8jmMnSRInDuNqzRhrcM47vu+v/gHJaN03IsrzqwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/50b82ce63ff507ac023bad51eaccd84e/ba381/no-relation-posts.webp 200w,\n/static/50b82ce63ff507ac023bad51eaccd84e/7f61c/no-relation-posts.webp 400w,\n/static/50b82ce63ff507ac023bad51eaccd84e/d00b9/no-relation-posts.webp 800w,\n/static/50b82ce63ff507ac023bad51eaccd84e/92f8c/no-relation-posts.webp 1200w,\n/static/50b82ce63ff507ac023bad51eaccd84e/d33d4/no-relation-posts.webp 1320w\"\n              sizes=\"(max-width: 800px) 100vw, 800px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/50b82ce63ff507ac023bad51eaccd84e/772e8/no-relation-posts.png 200w,\n/static/50b82ce63ff507ac023bad51eaccd84e/e17e5/no-relation-posts.png 400w,\n/static/50b82ce63ff507ac023bad51eaccd84e/5a190/no-relation-posts.png 800w,\n/static/50b82ce63ff507ac023bad51eaccd84e/c1b63/no-relation-posts.png 1200w,\n/static/50b82ce63ff507ac023bad51eaccd84e/78958/no-relation-posts.png 1320w\"\n            sizes=\"(max-width: 800px) 100vw, 800px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/50b82ce63ff507ac023bad51eaccd84e/5a190/no-relation-posts.png\"\n            alt=\"no relation posts\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span>\n<br/></p>\n<p>知識は点よりも線にしたほうが強みになるので、今後記事を書く際は、そこらへんの記事の関連線を増やしていく方向で学習を進めようと思います。</p>\n<h3 id=\"今後の予定\" style=\"position:relative;\"><a href=\"#%E4%BB%8A%E5%BE%8C%E3%81%AE%E4%BA%88%E5%AE%9A\" aria-label=\"今後の予定 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>今後の予定</h3>\n<p>現在、関連度算出はタグとキーワードの重み付けという非常に簡素なロジックです。\n今後は、記事本文を解析して関連度を詳細に出したり、記事の傾向を解析したり、WordCloudを出したりと色々機能追加できそうです。</p>\n<h2 id=\"cytoscapejsを使ってみた感想\" style=\"position:relative;\"><a href=\"#cytoscapejs%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E3%81%BF%E3%81%9F%E6%84%9F%E6%83%B3\" aria-label=\"cytoscapejsを使ってみた感想 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Cytoscape.jsを使ってみた感想</h2>\n<h3 id=\"概要\" style=\"position:relative;\"><a href=\"#%E6%A6%82%E8%A6%81\" aria-label=\"概要 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>概要</h3>\n<p>公式ドキュメントは充実しているので実装方法に悩むことはありません。\nCanvasで描画するので、オブジェクトのスタイル指定でCSSは使えないのが若干もどかしいですが、CSSに似たプロパティ設定することで非常に細かいレイアウト調整ができます。\nまたオブジェクト毎にイベント発火時（hover, click, mouseover, etc...）の処理を指定できます。こちらはjQueryっぽい実装です。</p>\n<h3 id=\"テーマ\" style=\"position:relative;\"><a href=\"#%E3%83%86%E3%83%BC%E3%83%9E\" aria-label=\"テーマ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>テーマ</h3>\n<p>公式サイトでは多くのテーマが紹介されています。\nインストールしてuseするだけで簡単に使えます。</p>\n<div class=\"gatsby-code-title\">テーマの使い方</div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> cytoscape <span class=\"token keyword\">from</span> <span class=\"token string\">'cytoscape'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> coseBilkent <span class=\"token keyword\">from</span> <span class=\"token string\">'cytoscape-cose-bilkent'</span><span class=\"token punctuation\">;</span>\n\ncytoscape<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span> coseBilkent <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<br/>\n<p>テーマごとに豊富なオプションが用意されており、以下のように調査できます。</p>\n<div class=\"gatsby-code-title\">テーマの調整</div>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-jsx line-numbers\"><code class=\"language-jsx\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">CytoscapeComponent</span></span>\n  <span class=\"token attr-name\">layout</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token string\">'cose-bilkent'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// Whether to include labels in node dimensions. Useful for avoiding label overlap</span>\n    <span class=\"token literal-property property\">nodeDimensionsIncludeLabels</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// number of ticks per frame; higher is faster but more jerky</span>\n    <span class=\"token literal-property property\">refresh</span><span class=\"token operator\">:</span> <span class=\"token number\">30</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// Whether to fit the network view after when done</span>\n    <span class=\"token literal-property property\">fit</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// Padding on fit</span>\n    <span class=\"token literal-property property\">padding</span><span class=\"token operator\">:</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// Whether to enable incremental mode</span>\n    <span class=\"token literal-property property\">randomize</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// Node repulsion (non overlapping) multiplier</span>\n    <span class=\"token literal-property property\">nodeRepulsion</span><span class=\"token operator\">:</span> <span class=\"token number\">100000000</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// Ideal (intra-graph) edge length</span>\n    <span class=\"token literal-property property\">idealEdgeLength</span><span class=\"token operator\">:</span> <span class=\"token number\">700</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// Divisor to compute edge forces</span>\n    <span class=\"token literal-property property\">edgeElasticity</span><span class=\"token operator\">:</span> <span class=\"token number\">0.45</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// Nesting factor (multiplier) to compute ideal edge length for inter-graph edges</span>\n    <span class=\"token literal-property property\">nestingFactor</span><span class=\"token operator\">:</span> <span class=\"token number\">0.1</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// Gravity force (constant)</span>\n    <span class=\"token literal-property property\">gravity</span><span class=\"token operator\">:</span> <span class=\"token number\">0.20</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// Maximum number of iterations to perform</span>\n    <span class=\"token literal-property property\">numIter</span><span class=\"token operator\">:</span> <span class=\"token number\">2500</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// Whether to tile disconnected nodes</span>\n    <span class=\"token literal-property property\">tile</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// Type of layout animation. The option set is {'during', 'end', false}</span>\n    <span class=\"token literal-property property\">animate</span><span class=\"token operator\">:</span> <span class=\"token string\">'end'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// Amount of vertical space to put between degree zero nodes during tiling (can also be a function)</span>\n    <span class=\"token literal-property property\">tilingPaddingVertical</span><span class=\"token operator\">:</span> <span class=\"token number\">400</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// Amount of horizontal space to put between degree zero nodes during tiling (can also be a function)</span>\n    <span class=\"token literal-property property\">tilingPaddingHorizontal</span><span class=\"token operator\">:</span> <span class=\"token number\">300</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// Gravity range (constant) for compounds</span>\n    <span class=\"token literal-property property\">gravityRangeCompound</span><span class=\"token operator\">:</span> <span class=\"token number\">1.5</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// Gravity force (constant) for compounds</span>\n    <span class=\"token literal-property property\">gravityCompound</span><span class=\"token operator\">:</span> <span class=\"token number\">1.0</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// Gravity range (constant)</span>\n    <span class=\"token literal-property property\">gravityRange</span><span class=\"token operator\">:</span> <span class=\"token number\">3.8</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// Initial cooling factor for incremental layout</span>\n    <span class=\"token literal-property property\">initialEnergyOnIncremental</span><span class=\"token operator\">:</span> <span class=\"token number\">0.5</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span>\n<span class=\"token punctuation\">/></span></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<br/>\n<h3 id=\"拡張機能\" style=\"position:relative;\"><a href=\"#%E6%8B%A1%E5%BC%B5%E6%A9%9F%E8%83%BD\" aria-label=\"拡張機能 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>拡張機能</h3>\n<p>拡張機能も豊富です。ただ一部jQuery依存の拡張機能もあります。たとえば、ズーム機能を提供する<a href=\"https://github.com/cytoscape/cytoscape.js-panzoom\">cytoscape.js-panzoom</a>などです。今回jQueryは使えないので（GatsbyでReactベースなので）、ズーム機能は自前実装しました。スタイルや細かい挙動など設定項目が非常に多く、結構手間なので自前実装はオススメしません。</p>\n<h3 id=\"react-cytoscapejsハマりポイント\" style=\"position:relative;\"><a href=\"#react-cytoscapejs%E3%83%8F%E3%83%9E%E3%82%8A%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88\" aria-label=\"react cytoscapejsハマりポイント permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>react-cytoscape.jsハマりポイント</h3>\n<p>GatsbyでCytoscape.jsを使えるようにするため<a href=\"https://github.com/plotly/react-cytoscapejs\">react-cytoscape.js</a>を採用しました。\nただ2点ハマりポイントがあったので紹介します。</p>\n<h4 id=\"1-wheelsensitivityが使えない\" style=\"position:relative;\"><a href=\"#1-wheelsensitivity%E3%81%8C%E4%BD%BF%E3%81%88%E3%81%AA%E3%81%84\" aria-label=\"1 wheelsensitivityが使えない permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. wheelsensitivityが使えない</h4>\n<p>Cytoscape.jsは、wheelsensitivityというプロパティを指定すれば、マウスホイールで拡大・縮小する時の拡大率を調整できます。これを設定しないとマウスホイールで拡大したときに、急に拡大されて、自分が今どこにいるのかわからなくなります。wheelsensitivityを使えば拡大率を調整できるので、それを防ぐことができます。\nただコレreact-cytoscapeではサポートしていません。そのため今回は拡大率調整を断念しました。</p>\n<h4 id=\"2-gatsbyビルド時にエラー\" style=\"position:relative;\"><a href=\"#2-gatsby%E3%83%93%E3%83%AB%E3%83%89%E6%99%82%E3%81%AB%E3%82%A8%E3%83%A9%E3%83%BC\" aria-label=\"2 gatsbyビルド時にエラー permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. Gatsbyビルド時にエラー</h4>\n<p><code class=\"language-text\">WebpackError: ReferenceError: window is not defined</code>というエラーが出ます。react-cytoscape.jsではwindowオブジェクトを直参照しており、Gatsbyビルド時に、webpackに怒られます。Gatsbyではwindowオブジェクトを直参照できないようです。</p>\n<p>対策は<a href=\"https://github.com/gatsbyjs/gatsby/issues/309#issuecomment-302043875\">GatsbyのIssue</a>にもあがっており、以下のようにライブラリの中身を直接書き換えました。</p>\n<ul>\n<li><code class=\"language-text\">node_modules\\react-cytoscapejs\\dist\\react-cytoscape.js</code>を書き換えます。</li>\n<li><code class=\"language-text\">window</code>を<code class=\"language-text\">windowGlobal </code>に置換します</li>\n<li>冒頭に<code class=\"language-text\">const windowGlobal = typeof window !== 'undefined' &amp;&amp; window;</code>を追記します</li>\n</ul>\n<p>これでビルドが通ります。ただ手動でやるのは無理やり感があるので、npmのpostinstallのスクリプトで書き換える方法を検討中です。</p>\n<h2 id=\"まとめ\" style=\"position:relative;\"><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\" aria-label=\"まとめ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>まとめ</h2>\n<p>今回は、記事関連マップの紹介と<a href=\"http://js.cytoscape.org/\">Cytoscape.js</a>の使用感をご紹介しました。業務でもWebアプリでデータを可視化したいという要件は割とある気がするので、そんなときはCytoscape.jsの導入を検討しようと思います🍅</p>","excerpt":"なにこれ 以前の記事で紹介したタグとキーワードから関連記事を算出するロジックと、Cytoscape.jsを用いて記事の関連情報を視覚的に確認できるマップを作りました。\n今回はそのマップの紹介とCytoscape.jsを使ってみた感想です。 記事関連マップ 使い方 URL…","frontmatter":{"slug":"/posts-relation-map-with-cytoscape-in-gatsby","title":"GatsbyでCytoscape.jsを使って記事関連マップを作った","date":"2019-05-01T18:00:00.000+09:00","tags":["Gatsby","Cytoscape.js"],"keywords":["Gatsby"],"thumbnail":"thumbnail/2019/05/posts-relation-map-with-cytoscape-in-gatsby.png","category":null}},"next":{"html":"<h2 id=\"なにこれ\" style=\"position:relative;\"><a href=\"#%E3%81%AA%E3%81%AB%E3%81%93%E3%82%8C\" aria-label=\"なにこれ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>なにこれ</h2>\n<p><a href=\"/wordcloud-with-kuromoji-d3cloud-react\">前回記事</a>ではReactでWordCloudを出力しました。しかし実際は、過去大量データから出力するようなツールとして使えたほうが便利です。\nそこで<a href=\"https://github.com/Takumon/playbox2019/blob/master/react-kuromoji-sample/src/App.js\">前回のサンプル</a>をベースにNode.jsでWordCloudのSVGファイルを出力するサンプルを作成しました。\n今回はサンプルの実装方法をポイントと合わせてご紹介します。</p>\n<p>※サンプルは以下に置いております。\n<a href=\"https://github.com/Takumon/playbox2019/blob/master/node-kuromoji-d3cloud-sample/index.js\">https://github.com/Takumon/playbox2019/blob/master/node-kuromoji-d3cloud-sample/index.js</a></p>\n<p>この記事は、<a href=\"https://gw-advent.9wick.com/calendars/9\">challenge-every-month全員でアウトプット芸人 Advent Calendar</a> 9日目の記事です。前日の記事は、<a href=\"https://twitter.com/kojirock5260\">@kojirock5260</a>さんの記事でした。</p>\n<iframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fkojirooooocks.hatenablog.com%2Fentry%2F2019%2F05%2F04%2F163742\" style=\"border: 0; width: 100%; height: 190px;\" allowfullscreen scrolling=\"no\" allow=\"autoplay; encrypted-media\"></iframe>\n<h2 id=\"処理手順\" style=\"position:relative;\"><a href=\"#%E5%87%A6%E7%90%86%E6%89%8B%E9%A0%86\" aria-label=\"処理手順 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>処理手順</h2>\n<p>以下4ステップです。</p>\n<ol>\n<li>kuromoji.jsで文章を解析して単語出現回数をデータ化</li>\n<li>D3-Cloudで上記データに以下情報追加\n<ol>\n<li>フォントの大きさ</li>\n<li>フォントの回転位置</li>\n<li>フォントの種類</li>\n<li>表示位置</li>\n</ol>\n</li>\n<li>d3.jsで配色を決定しSVGを<strong>仮想DOM</strong>に描画</li>\n<li>SVGをファイル出力</li>\n</ol>\n<h2 id=\"実装のポイント\" style=\"position:relative;\"><a href=\"#%E5%AE%9F%E8%A3%85%E3%81%AE%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88\" aria-label=\"実装のポイント permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>実装のポイント</h2>\n<h3 id=\"1-d3-cloud--canvasだけでは不十分なのでd3jsを使う\" style=\"position:relative;\"><a href=\"#1-d3-cloud--canvas%E3%81%A0%E3%81%91%E3%81%A7%E3%81%AF%E4%B8%8D%E5%8D%81%E5%88%86%E3%81%AA%E3%81%AE%E3%81%A7d3js%E3%82%92%E4%BD%BF%E3%81%86\" aria-label=\"1 d3 cloud  canvasだけでは不十分なのでd3jsを使う permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. D3-Cloud + Canvasだけでは不十分なのでd3.jsを使う</h3>\n<p>最初は、D3-CloudでCanvasを使えるので、<a href=\"https://github.com/Automattic/node-canvas\">node-canvas</a>を使えばNode.jsでも画像を生成できるのでは？と考えたのですが、やってみるとうまくいきません。以下のような画像が出力されます。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/4538ff67e1815ab50581a395af5a3b88/5a3c9/wordcloud-by-canvas.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 68.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAABcRAAAXEQHKJvM/AAACWUlEQVR42k1STU/bQBD1//8DVVWp4siNA1GtVM2BA+IAAQJyQrCTTZzYcbJe25sQgnGWV73dumBpvLPz8ebNzHqi3/9enJ721knySw6Hvry48GWS+PLkxJfdri+XS19mmS/nc1/e3fny7MyXk4kvN5v/duYWj49/xkHw09OLRYCrK6AsDfZ7QAigroF+H8gy4HgE8hy4vgYOB2C9BpoGeH9352YDvLwY9HpQURR6VZ4/AoAxpjH7vTHHo7EfTa20H/XDwZi6NqYoXGyWGZMkDZZL5Gk69vTlZYDBgNUNhkNWA7QGlIK9SwnMZsDTEzAew8bSdnPjYpZL+mx3SuvQ01oHZIjj0Vg+/NLUtb5YAFHkgJnI1tsYlwPsdrZB/pRSoaejKLDz0NrYGTGhZUidjDmrsnSAjKWvqoDt1s2buR8fUEURelqIwFbabg3e3lxgkrjhM5ktTqfuTjYuFnh9dWAEl/ILw+EwsM6qMigKx46gPJlIIRgZUufmWZg6R0M7c+saKklCT9/fO4arlcFk4gZPRpzZfP7ZWgsQhq71tm0+td3OAUoZeno0cjOMY2NBCErhUuLYtcmTgO1WuSxunoV5JonBagU1Gv1jyMf5/GxsAFkxyQWSuQMkCKX100edPpIpS6jxOPS2Qgws9TStIWWDNG2wWPChNuCDpWRZY3153qAonE6bUg2qqkFZ1uxAxfHI03HsWuam2BIXQ2ER3lsbh09pZ9fenW5fiJrNQi++vf32IsTvMorOq8mkUwnRqabTT+GddspXW3vO551SiPPdbNYVDw8//gJnIRX3lkjjHwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/4538ff67e1815ab50581a395af5a3b88/ba381/wordcloud-by-canvas.webp 200w,\n/static/4538ff67e1815ab50581a395af5a3b88/7f61c/wordcloud-by-canvas.webp 400w,\n/static/4538ff67e1815ab50581a395af5a3b88/d00b9/wordcloud-by-canvas.webp 800w,\n/static/4538ff67e1815ab50581a395af5a3b88/e28de/wordcloud-by-canvas.webp 1169w\"\n              sizes=\"(max-width: 800px) 100vw, 800px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/4538ff67e1815ab50581a395af5a3b88/772e8/wordcloud-by-canvas.png 200w,\n/static/4538ff67e1815ab50581a395af5a3b88/e17e5/wordcloud-by-canvas.png 400w,\n/static/4538ff67e1815ab50581a395af5a3b88/5a190/wordcloud-by-canvas.png 800w,\n/static/4538ff67e1815ab50581a395af5a3b88/5a3c9/wordcloud-by-canvas.png 1169w\"\n            sizes=\"(max-width: 800px) 100vw, 800px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/4538ff67e1815ab50581a395af5a3b88/5a190/wordcloud-by-canvas.png\"\n            alt=\"wordcloud by canvas\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>そのためD3-Cloud + Canvasだけの組み合わせはあきらめて、\n<a href=\"https://github.com/Yoctol/react-d3-cloud\">react-d3-cloud</a>の内部実装と同じようにd3.jsを使ってSVGを描画して、そこからファイル出力処理するようにしました。</p>\n<h3 id=\"2-domエミュレート用にnode-canvasとjsdomを使う\" style=\"position:relative;\"><a href=\"#2-dom%E3%82%A8%E3%83%9F%E3%83%A5%E3%83%AC%E3%83%BC%E3%83%88%E7%94%A8%E3%81%ABnode-canvas%E3%81%A8jsdom%E3%82%92%E4%BD%BF%E3%81%86\" aria-label=\"2 domエミュレート用にnode canvasとjsdomを使う permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. DOMエミュレート用にnode-canvasとjsdomを使う</h3>\n<p><a href=\"https://github.com/d3/d3\">d3.js</a>は、ブラウザ上での動作を前提としているためDOMが必要です。Node.jsでDOMをエミュレートするために<a href=\"https://github.com/jsdom/jsdom\">jsdom</a>を使いました。<br/>\n<a href=\"https://github.com/jasondavies/d3-cloud\">D3-Cloud</a>も同様にCanvasの指定が必須です。\nそのためCanvasをエミュレートする<a href=\"https://github.com/Automattic/node-canvas\">node-canvas</a>を使いました。</p>\n<h2 id=\"実装\" style=\"position:relative;\"><a href=\"#%E5%AE%9F%E8%A3%85\" aria-label=\"実装 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>実装</h2>\n<p>ポイントを踏まえたうえで4ステップごとに実装方法を説明します。</p>\n<h3 id=\"1-kuromojijsで文章を解析して単語出現回数をデータ化\" style=\"position:relative;\"><a href=\"#1-kuromojijs%E3%81%A7%E6%96%87%E7%AB%A0%E3%82%92%E8%A7%A3%E6%9E%90%E3%81%97%E3%81%A6%E5%8D%98%E8%AA%9E%E5%87%BA%E7%8F%BE%E5%9B%9E%E6%95%B0%E3%82%92%E3%83%87%E3%83%BC%E3%82%BF%E5%8C%96\" aria-label=\"1 kuromojijsで文章を解析して単語出現回数をデータ化 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. kuromoji.jsで文章を解析して単語出現回数をデータ化</h3>\n<p>kuromoji.jsによるデータ加工については<a href=\"/wordcloud-with-kuromoji-d3cloud-react#1-%E6%96%87%E7%AB%A0%E3%82%92%E8%A7%A3%E6%9E%90%E3%81%97%E3%81%A6%E5%8D%98%E8%AA%9E%E5%87%BA%E7%8F%BE%E5%9B%9E%E6%95%B0%E3%82%92%E3%83%87%E3%83%BC%E3%82%BF%E5%8C%96-1\">前回記事のReactアプリ</a>と同様です。\n今回はブラウザではなくNode.jsで動かすのでkuromoji.jsの辞書はnode_modules配下から移動する必要はありません。</p>\n<div class=\"gatsby-code-title\">kuromoji.jsによる解析処理</div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> kuromoji <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'kuromoji'</span><span class=\"token punctuation\">)</span>\n\n\n<span class=\"token comment\">// インプットとなる文章(長文につき一部省略)</span>\n<span class=\"token keyword\">const</span> text <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\nそこも場合もうその病気らに対して旨の時がしんませ。\n単に事実に使用方はどうかその応用たないでもが思いてならないがも発展思いうべきて、\nあいにくにもなるだなですた。\n・・・\n</span><span class=\"token template-punctuation string\">`</span></span>\n\n<span class=\"token comment\">// kuromoji.jsにバンドルされている辞書のフォルダパス</span>\n<span class=\"token comment\">// kuromoji.jsは形態素解析用関数を生成する際に辞書を読み込む</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">DIC_URL</span> <span class=\"token operator\">=</span> <span class=\"token string\">'node_modules/kuromoji/dict'</span>\n\n<span class=\"token comment\">// WordCloudの情報として抽出する品詞（助詞、助動詞などは意味がないので拾わない）</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">TARGET_POS</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'名詞'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'動詞'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'形容詞'</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token comment\">// kuromoji.jsの解析結果の値で特に値がない場合は以下の文字が設定される</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">NO_CONTENT</span> <span class=\"token operator\">=</span> <span class=\"token string\">'*'</span>\n\n\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token comment\">// kuromoji.jsによる解析処理</span>\n  <span class=\"token keyword\">const</span> words <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resolve<span class=\"token punctuation\">,</span> reject</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// 辞書を読み混んでトークナイザー（形態素解析するための関数）を生成</span>\n    kuromoji<span class=\"token punctuation\">.</span><span class=\"token function\">builder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">dicPath</span><span class=\"token operator\">:</span> <span class=\"token constant\">DIC_URL</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">err<span class=\"token punctuation\">,</span> tokenizer</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token function\">reject</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span>\n\n      <span class=\"token comment\">// テキストを引数にして形態素解析</span>\n      <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>tokenizer<span class=\"token punctuation\">.</span><span class=\"token function\">tokenize</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">)</span>\n        <span class=\"token comment\">// pos（品詞）を参照し、'名詞', '動詞', '形容詞'のみを抽出</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">t</span> <span class=\"token operator\">=></span> <span class=\"token constant\">TARGET_POS</span><span class=\"token punctuation\">.</span><span class=\"token function\">includes</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">.</span>pos<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token comment\">// 単語を抽出(basic_formかsurface_formに単語が存在する)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">t</span> <span class=\"token operator\">=></span> t<span class=\"token punctuation\">.</span>basic_form <span class=\"token operator\">===</span> <span class=\"token constant\">NO_CONTENT</span> <span class=\"token operator\">?</span> t<span class=\"token punctuation\">.</span>surface_form <span class=\"token operator\">:</span> t<span class=\"token punctuation\">.</span>basic_form<span class=\"token punctuation\">)</span>\n        <span class=\"token comment\">// [{text: 単語, size: 出現回数}]の形にReduce</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">reduce</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">data<span class=\"token punctuation\">,</span> text</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n          <span class=\"token keyword\">const</span> target <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">c</span> <span class=\"token operator\">=></span> c<span class=\"token punctuation\">.</span>text <span class=\"token operator\">===</span> text<span class=\"token punctuation\">)</span>\n\n          <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>target<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            target<span class=\"token punctuation\">.</span>size <span class=\"token operator\">=</span> target<span class=\"token punctuation\">.</span>size <span class=\"token operator\">+</span> <span class=\"token number\">1</span>\n          <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n            data<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n              text<span class=\"token punctuation\">,</span>\n              <span class=\"token literal-property property\">size</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">}</span>\n          <span class=\"token keyword\">return</span> data\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n\n  <span class=\"token comment\">// D3-Cloudによる解析処理</span>\n  <span class=\"token comment\">// (略)</span>\n\n  <span class=\"token comment\">// d3.jsによる描画処理</span>\n  <span class=\"token comment\">// (略)</span>\n\n  <span class=\"token comment\">// SVGファイル出力処理</span>\n  <span class=\"token comment\">// (略)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<br/>\n<p>これで以下のような情報が得られます。</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token punctuation\">[</span> \n  <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">text</span><span class=\"token operator\">:</span> <span class=\"token string\">'相違'</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 単語</span>\n    <span class=\"token literal-property property\">size</span><span class=\"token operator\">:</span> <span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 出現回数</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<br/>\n<h3 id=\"2-d3-cloudで上記データに以下情報追加\" style=\"position:relative;\"><a href=\"#2-d3-cloud%E3%81%A7%E4%B8%8A%E8%A8%98%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AB%E4%BB%A5%E4%B8%8B%E6%83%85%E5%A0%B1%E8%BF%BD%E5%8A%A0\" aria-label=\"2 d3 cloudで上記データに以下情報追加 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. D3-Cloudで上記データに以下情報追加</h3>\n<p>D3-Cloudでは解析情報に以下を追加するだけです。</p>\n<ul>\n<li>フォントの回転位置 ☚自分で定義</li>\n<li>フォントの重み ☚自分で定義</li>\n<li>フォントの大きさ ☚自分で定義</li>\n<li>フォントの種類 ☚自分で定義</li>\n<li>表示位置 ☚D3-Cloudが定義してくれる</li>\n</ul>\n<p>なおD3-CloudはbodyタグかCanvasが必須なので、今回は<a href=\"https://github.com/Automattic/node-canvas\">node-canvas</a>を使います。</p>\n<div class=\"gatsby-code-title\">D3-Cloudによる解析処理</div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> cloud <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'d3-cloud'</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">// Node.jsでCanvasをエミュレートするためnode-canvasを使う</span>\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> createCanvas <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'canvas'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// Canvasの幅(px)</span>\n<span class=\"token keyword\">const</span> w <span class=\"token operator\">=</span> <span class=\"token number\">1600</span>\n\n<span class=\"token comment\">// Canvasの高さ(px)</span>\n<span class=\"token keyword\">const</span> h <span class=\"token operator\">=</span> <span class=\"token number\">1000</span>\n\n\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token comment\">// kuromoji.jsによる解析処理</span>\n  <span class=\"token comment\">// (略)</span>\n\n  <span class=\"token comment\">// D3-Cloudによる解析処理</span>\n  <span class=\"token comment\">// D3-Cloudの解析によってwordsForCloudには</span>\n  <span class=\"token comment\">// 出現回数の他にフォントの回転位置、大きさ、重み、種類が追加された状態になる</span>\n  <span class=\"token keyword\">const</span> wordsForCloud <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resolve</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">cloud</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>w<span class=\"token punctuation\">,</span> h<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// node-canvasを指定する(エラーを防ぐため)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">canvas</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">createCanvas</span><span class=\"token punctuation\">(</span>w<span class=\"token punctuation\">,</span> h<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// kuromoji.jsの解析結果を指定</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">words</span><span class=\"token punctuation\">(</span>words<span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// フォントの回転位置を指定</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">rotate</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">word</span> <span class=\"token operator\">=></span> word<span class=\"token punctuation\">.</span>size <span class=\"token operator\">%</span> <span class=\"token number\">2</span> <span class=\"token operator\">===</span> <span class=\"token number\">1</span> <span class=\"token operator\">?</span> <span class=\"token number\">0</span> <span class=\"token operator\">:</span> <span class=\"token number\">90</span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// フォントの重みを指定</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">fontWeight</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">word</span> <span class=\"token operator\">=></span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">pow</span><span class=\"token punctuation\">(</span>word<span class=\"token punctuation\">.</span>size<span class=\"token punctuation\">,</span> <span class=\"token number\">1.3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// フォントの大きさを指定</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">fontSize</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">word</span> <span class=\"token operator\">=></span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">pow</span><span class=\"token punctuation\">(</span>word<span class=\"token punctuation\">.</span>size<span class=\"token punctuation\">,</span> <span class=\"token number\">1.3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// フォントの種類を指定</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">font</span><span class=\"token punctuation\">(</span><span class=\"token string\">'meiryo'</span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// 加工終了時のイベント登録、解析結果をd3.jsでの描画に引き継ぐ</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'end'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">words</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>words<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// 解析開始</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token comment\">// d3.jsによる描画処理</span>\n  <span class=\"token comment\">// (略)</span>\n\n  <span class=\"token comment\">// SVGファイル出力処理</span>\n  <span class=\"token comment\">// (略)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<br/>\n<p>これで以下のような情報が得られます。</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">{</span> \n    <span class=\"token literal-property property\">text</span><span class=\"token operator\">:</span> <span class=\"token string\">'相違'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">size</span><span class=\"token operator\">:</span> <span class=\"token number\">19</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// D3-Cloudによって追加された情報</span>\n    <span class=\"token literal-property property\">font</span><span class=\"token operator\">:</span> <span class=\"token string\">'meiryo'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">style</span><span class=\"token operator\">:</span> <span class=\"token string\">'normal'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">weight</span><span class=\"token operator\">:</span> <span class=\"token number\">19.952623149688797</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">rotate</span><span class=\"token operator\">:</span> <span class=\"token number\">90</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">padding</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">width</span><span class=\"token operator\">:</span> <span class=\"token number\">64</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">height</span><span class=\"token operator\">:</span> <span class=\"token number\">59</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">xoff</span><span class=\"token operator\">:</span> <span class=\"token number\">192</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">yoff</span><span class=\"token operator\">:</span> <span class=\"token number\">957</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">x1</span><span class=\"token operator\">:</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">y1</span><span class=\"token operator\">:</span> <span class=\"token number\">28</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">x0</span><span class=\"token operator\">:</span> <span class=\"token operator\">-</span><span class=\"token number\">32</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">y0</span><span class=\"token operator\">:</span> <span class=\"token operator\">-</span><span class=\"token number\">22</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">hasText</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">x</span><span class=\"token operator\">:</span> <span class=\"token operator\">-</span><span class=\"token number\">199</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">y</span><span class=\"token operator\">:</span> <span class=\"token number\">294</span> \n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<br/>\n<h3 id=\"3-d3jsで配色を決定しsvgを仮想domに描画\" style=\"position:relative;\"><a href=\"#3-d3js%E3%81%A7%E9%85%8D%E8%89%B2%E3%82%92%E6%B1%BA%E5%AE%9A%E3%81%97svg%E3%82%92%E4%BB%AE%E6%83%B3dom%E3%81%AB%E6%8F%8F%E7%94%BB\" aria-label=\"3 d3jsで配色を決定しsvgを仮想domに描画 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. d3.jsで配色を決定しSVGを<strong>仮想DOM</strong>に描画</h3>\n<p>D3-Cloudの解析情報に文字色や配置情報を追加してSVGを仮想DOM上に描画します。\n仮想DOMは<a href=\"https://github.com/jsdom/jsdom\">jsdom</a>を使って生成します。<br/>\nフォント色のテーマは<code class=\"language-text\">schemeCategory10</code>を使いました。他にもいろいろテーマがあるようです。<br/>\n参考：<a href=\"https://wizardace.com/d3v5-scale-chromatic/\">D3.js v5 カラーテーマまとめ (d3-scale-chromatic) – データビジュアライゼーション・ラボ</a></p>\n<div class=\"gatsby-code-title\">d3.jsによるSVG描画処理</div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> d3 <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'d3'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> <span class=\"token constant\">JSDOM</span> <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"jsdom\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// 仮想documentオブジェクトを生成</span>\n<span class=\"token keyword\">const</span> document <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">JSDOM</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">&lt;body>&lt;/body></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>window<span class=\"token punctuation\">.</span>document\n\n<span class=\"token comment\">// WordCloud描画領域の幅(px) ※Canvasのやつを使いまわし</span>\n<span class=\"token keyword\">const</span> w <span class=\"token operator\">=</span> <span class=\"token number\">1600</span>\n\n<span class=\"token comment\">// WordCloud描画領域の高さ(px) ※Canvasのやつを使いまわし</span>\n<span class=\"token keyword\">const</span> h <span class=\"token operator\">=</span> <span class=\"token number\">1000</span>\n\n\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token comment\">// kuromoji.jsによる形態素解析</span>\n  <span class=\"token comment\">// (略)</span>\n\n  <span class=\"token comment\">// D3-Cloudによる解析処理</span>\n  <span class=\"token comment\">// (略)</span>\n\n  <span class=\"token comment\">// d3.jsによるSVG描画処理</span>\n  <span class=\"token comment\">// 仮想DOMのbodyタグを指定</span>\n  d3<span class=\"token punctuation\">.</span><span class=\"token function\">select</span><span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">)</span>\n    <span class=\"token comment\">// SVG形式で仮想DOMに描画</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">'svg'</span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// SVGのプロパティもろもろ指定</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'class'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'ui fluid image'</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'viewBox'</span><span class=\"token punctuation\">,</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">0 0 </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>w<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>h<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'width'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'100%'</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'height'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'100%'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token comment\">// SVGのグループ要素追加して</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">'g'</span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// SVGを中央寄せ</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'transform'</span><span class=\"token punctuation\">,</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">translate(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>w<span class=\"token operator\">/</span><span class=\"token number\">2</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">,</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>h<span class=\"token operator\">/</span><span class=\"token number\">2</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">)</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n    <span class=\"token comment\">// テキスト要素にD3-Cloudによる解析結果を追加</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">selectAll</span><span class=\"token punctuation\">(</span><span class=\"token string\">'text'</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">data</span><span class=\"token punctuation\">(</span>wordsForCloud<span class=\"token punctuation\">)</span>\n    <span class=\"token comment\">// 領域を新規作成し、テキスト要素追加</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">enter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">'text'</span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// フォントの大きさは解析結果通りに指定</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">style</span><span class=\"token punctuation\">(</span><span class=\"token string\">'font-size'</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">d</span> <span class=\"token operator\">=></span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>d<span class=\"token punctuation\">.</span>size<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// フォントの種類は解析結果通りに指定</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">style</span><span class=\"token punctuation\">(</span><span class=\"token string\">'font-family'</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">d</span> <span class=\"token operator\">=></span> d<span class=\"token punctuation\">.</span>font<span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// フォントの配色は、schemeCategory10を指定</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">style</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fill'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">d<span class=\"token punctuation\">,</span> i</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> d3<span class=\"token punctuation\">.</span>schemeCategory10<span class=\"token punctuation\">[</span>i <span class=\"token operator\">%</span> <span class=\"token number\">10</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// テキストの真ん中を表示位置のポイントに指定</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'text-anchor'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'middle'</span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// 位置と回転位置は解析結果通りに指定</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">attr</span><span class=\"token punctuation\">(</span><span class=\"token string\">'transform'</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">d</span> <span class=\"token operator\">=></span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">translate(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>d<span class=\"token punctuation\">.</span>x<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">, </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>d<span class=\"token punctuation\">.</span>y<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">)rotate(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>d<span class=\"token punctuation\">.</span>rotate<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">)</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// 単語は解析結果通りに指定</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">text</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">d</span> <span class=\"token operator\">=></span> d<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\">// SVGファイル出力処理</span>\n    <span class=\"token comment\">// (略)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<br/>\n<h3 id=\"4-svgをファイル出力\" style=\"position:relative;\"><a href=\"#4-svg%E3%82%92%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E5%87%BA%E5%8A%9B\" aria-label=\"4 svgをファイル出力 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. SVGをファイル出力</h3>\n<p>仮想DOMに描画したSVGをファイル出力します。</p>\n<div class=\"gatsby-code-title\">d3.jsによるSVG描画処理</div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> fs <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fs'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token comment\">// kuromoji.jsによる形態素解析</span>\n  <span class=\"token comment\">// (略)</span>\n\n  <span class=\"token comment\">// D3-Cloudによる解析処理</span>\n  <span class=\"token comment\">// (略)</span>\n\n  <span class=\"token comment\">// d3.jsによるSVG描画処理</span>\n  <span class=\"token comment\">// (略)</span>\n\n  <span class=\"token comment\">// 仮想DOMに描画されたSVGをファイル出力</span>\n  fs<span class=\"token punctuation\">.</span><span class=\"token function\">writeFileSync</span><span class=\"token punctuation\">(</span><span class=\"token string\">'wordcloud.svg'</span><span class=\"token punctuation\">,</span> document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>innerHTML<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<br/>\n<p>すると以下のようなファイルが出力されます。</p>\n<div class=\"gatsby-highlight\" data-language=\"html:svgファイルの中身\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-html:svgファイルの中身 line-numbers\"><code class=\"language-html:svgファイルの中身\">&lt;svg class=&quot;ui fluid image&quot; viewBox=&quot;0 0 1600 1000&quot; width=&quot;100%&quot; height=&quot;100%&quot;&gt;\n  &lt;g transform=&quot;translate(800,500)&quot;&gt;\n    &lt;text style=&quot;font-size: 466px; font-family: meiryo; fill: #1f77b4;&quot; transform=&quot;translate(48, 35)rotate(0)&quot; text-anchor=&quot;middle&quot;&gt;ある&lt;/text&gt;\n    &lt;text style=&quot;font-size: 269px; font-family: meiryo; fill: #ff7f0e;&quot; transform=&quot;translate(460, 15)rotate(90)&quot; text-anchor=&quot;middle&quot;&gt;よう&lt;/text&gt;&lt;text style=&quot;font-size: 245px; font-family: meiryo; fill: #2ca02c;&quot; transform=&quot;translate(-263, -290)rotate(0)&quot; text-anchor=&quot;middle&quot;&gt;云う&lt;/text&gt;\n    &lt;text style=&quot;font-size: 191px; font-family: meiryo; fill: #d62728;&quot; transform=&quot;translate(-265, 193)rotate(0)&quot; text-anchor=&quot;middle&quot;&gt;それ&lt;/text&gt;\n   ・\n   ・\n   ・\n  &lt;/g&gt;\n&lt;/svg&gt;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<br/>\n<p>描画すると以下のようになります。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/5e4aed803fecc163a2ec605e3c7848a6/29007/wordcloud.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 63%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABcRAAAXEQHKJvM/AAACnUlEQVR42n2T7U/TUBjF/XP9aPxgNP4DJMYYlJj4xSiJYJCIgCyACBkZgW2srN1Kx9q16/qyDugrbVd2e3vMuiEixpucnHuTk999nif3PvB9n3cc59hxHMa2bca2Bsx47/h+7lHgM4HvMVe+xzi2w1xc2rnyzK2qruueVSqVZw8AgKYpHXvKsiB7u0g5Dmn5EBlJMYhSBAlFcJ0hIXns3sqyLB27JElzEyBNydiGmk692hEdNpq0Wdijqzt1+oW1aLXnUd70KddzaIE16KejLo2TvIgbjabA11Mgza/uD87RaTagnrWwfNjGo8UiXn2tQGcFqN4VzlQVbzdqmN2VkICg21NgGiY0TcsrVBTlzR2gG3qQ5DNctHl8r4p4usLkwOVCBT+6BhbqHTxZOMRSqYWNpg7N1GDoOvT7wMkMZb+Pc5tHtX2BuR0BD+dLcAUWG2UOa2UGH4oneLd1gpagYW79FFZXAORdpBluZjgBTmrMcOwFMJMIjGTiRaGBlZqIn5UWXq6XoXbfoy4fYGaFxfPFItYZC9Q4AS3OgNY+pkAISdHutiz0PAiDALFpIDB0BKYLuW1BbndQFArYldfB9DgsNlfRUXhcihwiq4TRxenfFYIOr0aorCno8RYaZQ09/hz8gQy9IUE2eGwK2zjqMSgbB1gU5rFVXoPbrCOOOxh1tlNgCElWboGjhCDwCJKBhkAUYTVsdFt9hO0BWIXHfv0bjtjPUE0Lx1oZQRKDDkRQcROUXUqReZBU/XfL1wBIrtAksC0SNm0Sqy5JRJeYtUuSqApJTZY4/ZggnWbHihyC6zAZc0SxPXtnhv/+BuNnm+F/685PSZKkGkXRfhRFpYnCiYfT8zAqRclw4lFYGg5vcn/mw/04jk84jnv8Cy/EsfT7rCouAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/5e4aed803fecc163a2ec605e3c7848a6/ba381/wordcloud.webp 200w,\n/static/5e4aed803fecc163a2ec605e3c7848a6/7f61c/wordcloud.webp 400w,\n/static/5e4aed803fecc163a2ec605e3c7848a6/d00b9/wordcloud.webp 800w,\n/static/5e4aed803fecc163a2ec605e3c7848a6/92f8c/wordcloud.webp 1200w,\n/static/5e4aed803fecc163a2ec605e3c7848a6/fad48/wordcloud.webp 1600w\"\n              sizes=\"(max-width: 800px) 100vw, 800px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/5e4aed803fecc163a2ec605e3c7848a6/772e8/wordcloud.png 200w,\n/static/5e4aed803fecc163a2ec605e3c7848a6/e17e5/wordcloud.png 400w,\n/static/5e4aed803fecc163a2ec605e3c7848a6/5a190/wordcloud.png 800w,\n/static/5e4aed803fecc163a2ec605e3c7848a6/c1b63/wordcloud.png 1200w,\n/static/5e4aed803fecc163a2ec605e3c7848a6/29007/wordcloud.png 1600w\"\n            sizes=\"(max-width: 800px) 100vw, 800px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/5e4aed803fecc163a2ec605e3c7848a6/5a190/wordcloud.png\"\n            alt=\"wordcloud\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h2 id=\"まとめ\" style=\"position:relative;\"><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\" aria-label=\"まとめ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>まとめ</h2>\n<p>Node.jsでWordCloudのSVGファイルを出力する方法についてご紹介しました。\n今回の実装で、ブラウザ処理はnode-canvasとjsdomを使えばNode.jsでも再現できることがわかったので、いろんな場面で応用できそうです。\n次回は、今回の実装をベースにして自分のブログのWordCloudを生成してみようと思います🍅</p>","excerpt":"なにこれ 前回記事ではReactでWordCloudを出力しました。しかし実際は、過去大量データから出力するようなツールとして使えたほうが便利です。\nそこで前回のサンプルをベースにNode.jsでWordCloudのSVG…","frontmatter":{"slug":"/wordcloud-with-kuromoji-d3cloud-nodejs","title":"Node.js + kuromoji.js + D3-CloudでWordCloudの画像を出力","date":"2019-05-04T18:00:00.000+09:00","tags":["Node.js","kuromoji.js","d3.js","d3Cloud","データ可視化","形態素解析","WordCloud"],"keywords":["WordCloud"],"thumbnail":"thumbnail/2019/05/wordcloud-with-kuromoji-d3cloud-nodejs.png","category":null}}}},"staticQueryHashes":["3868140423","4185443638","467257065","558103266"],"slicesMap":{}}